{"symbol_id": "356e758f799e77bde76083323dc6c8cff0b791ad", "symbol_name": "get_args", "query_text_overlap": "parser get_args add_argument argumentparser parse_args required str type options pretrained dir", "query_text_semantic": "================================================\n                  Options\n================================================", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.7986764989503379, "overlap_score": 0.8089487593598591, "semantic_score": 0.7832681083360559}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.6918037704605294, "overlap_score": 1.0, "semantic_score": 0.22950942615132353}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.7986764989503379, "overlap": 0.8089487593598591, "semantic": 0.7832681083360559}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6918037704605294, "overlap": 1.0, "semantic": 0.22950942615132353}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.3014044575435084, "overlap": 0.0, "semantic": 0.753511143858771}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.25939971376691545, "overlap": 0.0, "semantic": 0.6484992844172887}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1820184761679677, "overlap": 0.0, "semantic": 0.4550461904199192}, {"chunk_id": "p-edce760829b6", "combined": 0.17971920426275673, "overlap": 0.0, "semantic": 0.4492980106568918}, {"chunk_id": "p-5c1af97004f2", "combined": 0.17603954125471424, "overlap": 0.0, "semantic": 0.4400988531367856}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.12669244772538923, "overlap": 0.0, "semantic": 0.3167311193134731}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.11253175712049208, "overlap": 0.0, "semantic": 0.2813293928012302}]}
{"symbol_id": "0204740afea3cb482e638431f2653a81d29e9ab1", "symbol_name": "render_interface", "query_text_overlap": "i18n label audio update value interactive placeholder type choices column lines scale textbox voice_model_choice1 blocks button editable format global_lang group", "query_text_semantic": "UI rendering", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.7734798510810743, "overlap_score": 1.0, "semantic_score": 0.43369962770268566}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.6374754140717221, "overlap_score": 0.7096134833510739, "semantic_score": 0.5292683101526946}, {"chunk_id": "p-edce760829b6", "score": 0.5165068847180421, "overlap_score": 0.33771804374252173, "semantic_score": 0.7846901461813224}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.7734798510810743, "overlap": 1.0, "semantic": 0.43369962770268566}, {"chunk_id": "p-88308230dda7", "combined": 0.6374754140717221, "overlap": 0.7096134833510739, "semantic": 0.5292683101526946}, {"chunk_id": "p-edce760829b6", "combined": 0.5165068847180421, "overlap": 0.33771804374252173, "semantic": 0.7846901461813224}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4097453422721241, "overlap": 0.2649209613344032, "semantic": 0.6269819136787055}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.40032474637540977, "overlap": 0.19876661094716602, "semantic": 0.7026619495177753}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.23073990916886902, "overlap": 0.0, "semantic": 0.5768497729221725}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2102697055583395, "overlap": 0.0, "semantic": 0.5256742638958487}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.17264309140255804, "overlap": 0.0, "semantic": 0.43160772850639506}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.15796298868150305, "overlap": 0.0, "semantic": 0.3949074717037576}]}
{"symbol_id": "8530ee02ad417a439d36bb077c799100f20c6c78", "symbol_name": "_change_prompt_input_visibility", "query_text_overlap": "enable _change_prompt_input_visibility update visible voice_mode voice clone mode action", "query_text_semantic": "Voice clone mode action", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.5432021194514921, "overlap_score": 0.2386701990858201, "semantic_score": 1.0}, {"chunk_id": "p-3c728ae39fa1", "score": 0.5333976353399184, "overlap_score": 0.24547914696015646, "semantic_score": 0.965275367909561}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5432021194514921, "overlap": 0.2386701990858201, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.5333976353399184, "overlap": 0.24547914696015646, "semantic": 0.965275367909561}, {"chunk_id": "p-9158b9f667b9", "combined": 0.5017610736610413, "overlap": 0.25062063231156373, "semantic": 0.8784717356852576}, {"chunk_id": "p-88308230dda7", "combined": 0.42959766032894364, "overlap": 0.13284603541113127, "semantic": 0.8747250977056622}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.41887600345185944, "overlap": 0.6981266724197658, "semantic": 0.0}, {"chunk_id": "p-edce760829b6", "combined": 0.38030491565144026, "overlap": 0.20186621003427685, "semantic": 0.6479629740771854}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3133637264087505, "overlap": 0.0, "semantic": 0.7834093160218761}, {"chunk_id": "p-0d66effb9582", "combined": 0.2761560384255221, "overlap": 0.0, "semantic": 0.6903900960638053}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2756527984883026, "overlap": 0.0, "semantic": 0.6891319962207565}]}
{"symbol_id": "660bc858056f6c46a14b9121a31d2e4a16d21459", "symbol_name": "_change_component_language", "query_text_overlap": "i18n update label placeholder value _change_component_language global_lang lang choices format action voice_model_choice1 audio text language global title_desc title_md_desc voice_mode_choice voice_model_choice2", "query_text_semantic": "======================== Action ========================\nLanguage action", "best": {"chunk_id": "p-88308230dda7", "score": 0.9576950951824809, "overlap_score": 1.0, "semantic_score": 0.8942377379562022}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.8853795666006212, "overlap_score": 0.8220935376339028, "semantic_score": 0.9803086100506987}, {"chunk_id": "p-edce760829b6", "score": 0.5192958015845213, "overlap_score": 0.19882633597420213, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9576950951824809, "overlap": 1.0, "semantic": 0.8942377379562022}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.8853795666006212, "overlap": 0.8220935376339028, "semantic": 0.9803086100506987}, {"chunk_id": "p-edce760829b6", "combined": 0.5192958015845213, "overlap": 0.19882633597420213, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.47076585281928834, "overlap": 0.15877403464636175, "semantic": 0.9387535800786782}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.3607571510226932, "overlap": 0.16515654175701602, "semantic": 0.6541580649212089}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3586555166339017, "overlap": 0.14853108061401282, "semantic": 0.6738421706637351}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.35832228406327005, "overlap": 0.0, "semantic": 0.895805710158175}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3092677709897687, "overlap": 0.0, "semantic": 0.7731694274744217}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.29946650154640886, "overlap": 0.09724936620803208, "semantic": 0.602792204553974}, {"chunk_id": "p-0d66effb9582", "combined": 0.29044142106282556, "overlap": 0.0, "semantic": 0.7261035526570638}]}
{"symbol_id": "a64ae1cf32e3bfb85f556069a44a164ff5c499a2", "symbol_name": "dialogue_synthesis_function", "query_text_overlap": "str target_text_list not i18n message spk1_prompt_text spk2_prompt_text voice_mode warning prompt_text_list prompt_wav_list spk1_prompt_audio spk2_prompt_audio text check_monologue_text dialogue_synthesis_function prompt_has_value target_audio target_text all", "query_text_semantic": "def dialogue_synthesis_function( target_text: str, voice_mode: Literal[0, 1] = 0, # 0 means voice clone spk1_prompt_text: str | None = \"\", spk1_prompt_audio: str | None = None, spk2_prompt_text: str | None = \"\", spk2_prompt_audio: str | None = None, ): # Voice clone mode, check prompt info if voice_mode == 0: prompt_has_value = [ spk1_prompt_text != \"\", spk1_prompt_audio is not None, spk2_prompt_text != \"\", spk2_prompt_audio is not None, ] if not all(prompt_has_value): gr.Warning(message=i18n(\"warn_incomplete_prompt\")) return None if not check_monologue_text(spk1_prompt_text, \"[S1]\"): gr.Warning(message=i18n(\"warn_invalid_spk1_prompt_text\")) return None if not check_monologue_text(spk2_prompt_text, \"[S2]\"): gr.Warning(message=i18n(\"warn_invalid_spk2_prompt_text\")) return None # Check dialogue text target_text_list: List[str] = re.findall(r\"(\\[S[0-9]\\][^\\[\\]]*)\", target_text) target_text_list = [text.strip() for text in target_text_list] if not check_dialogue_text(target_text_list): gr.Warning(message=i18n(\"warn_invalid_dialogue_text\")) return None # Go synthesis progress_bar = gr.Progress(track_tqdm=True) prompt_wav_list = ( None", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.9042813749743204, "overlap_score": 1.0, "semantic_score": 0.7607034374358008}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.5741671273880908, "overlap_score": 0.299912342980735, "semantic_score": 0.9855493039991244}, {"chunk_id": "p-62dccf79cb8d", "score": 0.5237675864194703, "overlap_score": 0.2062793106991171, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.9042813749743204, "overlap": 1.0, "semantic": 0.7607034374358008}, {"chunk_id": "p-88308230dda7", "combined": 0.5741671273880908, "overlap": 0.299912342980735, "semantic": 0.9855493039991244}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5237675864194703, "overlap": 0.2062793106991171, "semantic": 1.0}, {"chunk_id": "p-edce760829b6", "combined": 0.4957646503160027, "overlap": 0.27612913986784887, "semantic": 0.8252179159882334}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.46963795478140136, "overlap": 0.281771625484561, "semantic": 0.7514374487266618}, {"chunk_id": "p-9158b9f667b9", "combined": 0.46523747707958985, "overlap": 0.21660790278059358, "semantic": 0.8381818385280841}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.37673831821683584, "overlap": 0.1350594915514693, "semantic": 0.7392565582148857}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3597902252110222, "overlap": 0.0, "semantic": 0.8994755630275555}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3078868529790195, "overlap": 0.0, "semantic": 0.7697171324475487}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2943332477792799, "overlap": 0.0, "semantic": 0.7358331194481997}]}
{"symbol_id": "5ebdb5ee170204cc5c43d922600a3bfcf6203348", "symbol_name": "check_dialogue_text", "query_text_overlap": "text check_monologue_text text_list check_dialogue_text bool len list str not", "query_text_semantic": "def check_dialogue_text(text_list: List[str]) -> bool: if len(text_list) == 0: return False for text in text_list: if not ( check_monologue_text(text, \"[S1]\") or check_monologue_text(text, \"[S2]\") or check_monologue_text(text, \"[S3]\") or check_monologue_text(text, \"[S4]\") ): return False return True", "best": {"chunk_id": "p-88308230dda7", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-edce760829b6", "score": 0.9106865663606449, "overlap_score": 0.9206994854679461, "semantic_score": 0.8956671876996931}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.9095988526709907, "overlap_score": 0.9395132680573294, "semantic_score": 0.8647272295914828}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-edce760829b6", "combined": 0.9106865663606449, "overlap": 0.9206994854679461, "semantic": 0.8956671876996931}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.9095988526709907, "overlap": 0.9395132680573294, "semantic": 0.8647272295914828}, {"chunk_id": "p-9158b9f667b9", "combined": 0.7825700345591322, "overlap": 0.7222373731864297, "semantic": 0.873069026618186}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.7536785136000796, "overlap": 0.7647857225366755, "semantic": 0.7370177001951859}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7449845669489923, "overlap": 0.6877986702680241, "semantic": 0.8307634119704445}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5503481385638753, "overlap": 0.4503298870901919, "semantic": 0.7003755157744006}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.4411382565241533, "overlap": 0.7352304275402555, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.35031163394823533, "overlap": 0.0, "semantic": 0.8757790848705883}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3188785344850502, "overlap": 0.0, "semantic": 0.7971963362126255}]}
{"symbol_id": "691e823218f0736191e1998cc1dd9513094abf03", "symbol_name": "check_monologue_text", "query_text_overlap": "text prefix check_monologue_text str strip not bool len removeprefix startswith check speaker tags remove empty", "query_text_semantic": "def check_monologue_text(text: str, prefix: str = None) -> bool: text = text.strip() # Check speaker tags if prefix is not None and (not text.startswith(prefix)): return False # Remove prefix if prefix is not None: text = text.removeprefix(prefix) text = text.strip() # If empty? if len(text) == 0: return False return True", "best": {"chunk_id": "p-88308230dda7", "score": 0.9774879788752924, "overlap_score": 1.0, "semantic_score": 0.943719947188231}, "alternatives": [{"chunk_id": "p-edce760829b6", "score": 0.7802784310515574, "overlap_score": 0.7973395369699837, "semantic_score": 0.7546867721739179}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.7759736799579912, "overlap_score": 0.8355817286646899, "semantic_score": 0.686561606897943}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9774879788752924, "overlap": 1.0, "semantic": 0.943719947188231}, {"chunk_id": "p-edce760829b6", "combined": 0.7802784310515574, "overlap": 0.7973395369699837, "semantic": 0.7546867721739179}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.7759736799579912, "overlap": 0.8355817286646899, "semantic": 0.686561606897943}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7573863667370342, "overlap": 0.5956439445617238, "semantic": 1.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.7208512251722277, "overlap": 0.6254683768246049, "semantic": 0.8639254976936619}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6841015209646087, "overlap": 0.6367205563965745, "semantic": 0.75517296781666}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6044707834939759, "overlap": 0.4920168021391798, "semantic": 0.7731517555261699}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4881795325969479, "overlap": 0.8136325543282465, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.4105789623934093, "overlap": 0.1807020347196418, "semantic": 0.7553943539040605}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3419755896814948, "overlap": 0.0, "semantic": 0.8549389742037369}]}
{"symbol_id": "f6ff30f88e745ad969bc19cf2565fb758093bb86", "symbol_name": "i18n", "query_text_overlap": "global_lang i18n key _i18n_key2lang_dict global", "query_text_semantic": "def i18n(key): global global_lang return _i18n_key2lang_dict[key][global_lang]", "best": {"chunk_id": "p-ebeeda9fc683", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.39200950778447363, "overlap_score": 0.0, "semantic_score": 0.980023769461184}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.3855478880768849, "overlap_score": 0.0, "semantic_score": 0.9638697201922122}], "topk_raw": [{"chunk_id": "p-ebeeda9fc683", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.39200950778447363, "overlap": 0.0, "semantic": 0.980023769461184}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.3855478880768849, "overlap": 0.0, "semantic": 0.9638697201922122}, {"chunk_id": "p-88308230dda7", "combined": 0.38377315488434477, "overlap": 0.0, "semantic": 0.9594328872108618}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.36708282025006356, "overlap": 0.0, "semantic": 0.9177070506251588}, {"chunk_id": "p-edce760829b6", "combined": 0.36139152675112596, "overlap": 0.0, "semantic": 0.9034788168778148}, {"chunk_id": "p-0d66effb9582", "combined": 0.3533880966012466, "overlap": 0.0, "semantic": 0.8834702415031165}, {"chunk_id": "p-ae67c9c86886", "combined": 0.33494255547164314, "overlap": 0.0, "semantic": 0.8373563886791078}, {"chunk_id": "p-5c1af97004f2", "combined": 0.32323652011494397, "overlap": 0.0, "semantic": 0.8080913002873599}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.30769630395360714, "overlap": 0.0, "semantic": 0.7692407598840179}]}
{"symbol_id": "193523d54027e649adb70aed70acbd2c1b9aaec3", "symbol_name": "initiate_model", "query_text_overlap": "device model pretrained_dir initiate_model fireredtts2 gen_type str cuda global dialogue", "query_text_semantic": "def initiate_model(pretrained_dir: str, device=\"cuda\"): global model if model is None: model = FireRedTTS2( pretrained_dir=pretrained_dir, gen_type=\"dialogue\", device=device, )", "best": {"chunk_id": "p-88308230dda7", "score": 0.8382720146205423, "overlap_score": 1.0, "semantic_score": 0.5956800365513559}, "alternatives": [{"chunk_id": "p-5c1af97004f2", "score": 0.8248478680251918, "overlap_score": 0.9059410771538553, "semantic_score": 0.7032080543321968}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.7595410618129705, "overlap_score": 0.8734851415955325, "semantic_score": 0.5886249421391275}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.8382720146205423, "overlap": 1.0, "semantic": 0.5956800365513559}, {"chunk_id": "p-5c1af97004f2", "combined": 0.8248478680251918, "overlap": 0.9059410771538553, "semantic": 0.7032080543321968}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.7595410618129705, "overlap": 0.8734851415955325, "semantic": 0.5886249421391275}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.7077054486240792, "overlap": 0.8358098676282634, "semantic": 0.5155488201178031}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6596200455668364, "overlap": 0.5451234720756654, "semantic": 0.8313649058035928}, {"chunk_id": "p-9158b9f667b9", "combined": 0.6574994304173505, "overlap": 0.5389319273462074, "semantic": 0.8353506850240651}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5948034381036157, "overlap": 0.3992720797703592, "semantic": 0.8881004756035005}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5724731073775204, "overlap": 0.9541218456292008, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.43475445083343395, "overlap": 0.7245907513890566, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}]}
{"symbol_id": "092279f71202e374121d7ca1014d35d951f8343e", "symbol_name": "FireRedTTS2_Stream", "query_text_overlap": "torch unsqueeze prev_sample sample codec_cache device append audio_chunk cat curr_pos curr_tokens dim long max_generation_len segment tokens tokens_mask bool context curr_tokens_mask", "query_text_semantic": "class FireRedTTS2_Stream(FireRedTTS2): def generate( self, text: str, speaker: str, context: List[Segment], max_audio_length_ms: float = 90_000, temperature: float = 0.9, topk: int = 20, ): self._model.reset_caches() max_generation_len = int(max_audio_length_ms / 80) tokens, tokens_mask = [], [] for segment in context: segment_tokens, segment_tokens_mask = self._tokenize_segment(segment) tokens.append(segment_tokens) tokens_mask.append(segment_tokens_mask) gen_segment_tokens, gen_segment_tokens_mask = self._tokenize_text_segment( text, speaker ) tokens.append(gen_segment_tokens) tokens_mask.append(gen_segment_tokens_mask) prompt_tokens = torch.cat(tokens, dim=0).long().to(self.device) prompt_tokens_mask = torch.cat(tokens_mask, dim=0).bool().to(self.device) curr_tokens = prompt_tokens.unsqueeze(0) curr_tokens_mask = prompt_tokens_mask.unsqueeze(0) curr_pos = ( torch.arange(0, prompt_tokens.size(0)).unsqueeze(0).long().to(self.device) ) max_seq_len = 3100 max_context_len = max_seq_len - max_generation_len if curr_tokens.size(1) >= max_context_len: raise ValueError( f\"Inputs too long, must be below max_seq_len - max_generation_len: {max_context_len}\" ) # for streaming token2audio codec_cache = {} prev_sample = None for _ in range(max_generation_len): sample = self._model.generate_frame( curr_tokens, curr_tokens_mask, curr_pos, temperature,", "best": {"chunk_id": "p-edce760829b6", "score": 0.6392295627379376, "overlap_score": 0.5892176290706347, "semantic_score": 0.7142474632388919}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.6177883432047322, "overlap_score": 0.3669056501629628, "semantic_score": 0.9941123827673864}, {"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-edce760829b6", "combined": 0.6392295627379376, "overlap": 0.5892176290706347, "semantic": 0.7142474632388919}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.6177883432047322, "overlap": 0.3669056501629628, "semantic": 0.9941123827673864}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.5786286867252923, "overlap": 0.42053793962561076, "semantic": 0.8157648073748147}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5311601238543486, "overlap": 0.31197787811592576, "semantic": 0.8599334924619829}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.520204582995389, "overlap": 0.3254751133826909, "semantic": 0.8122987874144361}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4887929723053277, "overlap": 0.2865058984299371, "semantic": 0.7922235831184135}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.36628970192916055, "overlap": 0.0, "semantic": 0.9157242548229013}, {"chunk_id": "p-9158b9f667b9", "combined": 0.3413863764169718, "overlap": 0.0, "semantic": 0.8534659410424295}]}
{"symbol_id": "e8bb76c73766edac30d09f8e852f3d7ae154f9fc", "symbol_name": "generate_monologue", "query_text_overlap": "text audio_chunk codec_cache context prompt_text temperature token tokens topk clean_text prompt_wav text_list cpu speaker unsqueeze _audio_tokenizer audio_generator decode_one_token generate generate_monologue", "query_text_semantic": "def generate_monologue( self, text, prompt_wav=None, prompt_text=None, temperature=0.75, topk=20 ): # step1. construct context if prompt_wav is not None: assert os.path.exists(prompt_wav) assert prompt_text is not None prompt_text = clean_text(text=prompt_text) text = clean_text(text=text) text_list = split_text(text=text, length=400) print('[INFO] text_list: {}'.format(text_list)) tokens: List[torch.Tensor] = [] codec_cache = {} for text in text_list: text = clean_text(text=text) input_text = prompt_text[:-1] + \",\" + text prompt_a = self.prepare_prompt( text=input_text, speaker=\"[S1]\", audio_path=prompt_wav ) context = [prompt_a] token_generator = self.generate_single( context=context, temperature=temperature, topk=topk ) for token in token_generator: # token: (1, nq) if len(tokens) > 2: # generate previous token audio_chunk, codec_cache = self._audio_tokenizer.decode_one_token( tokens[-1].unsqueeze(-1), codec_cache, last_token=False, ) yield audio_chunk.cpu() tokens.append(token) # process last token audio_chunk, codec_cache = self._audio_tokenizer.decode_one_token( tokens[-1].unsqueeze(-1), codec_cache, last_token=True, ) yield audio_chunk.cpu() else: # random", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9288276642708753, "overlap_score": 1.0, "semantic_score": 0.822069160677188}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.785434129085336, "overlap_score": 0.6423902151422267, "semantic_score": 1.0}, {"chunk_id": "p-88308230dda7", "score": 0.6868580839709456, "overlap_score": 0.5872518259130199, "semantic_score": 0.836267471057834}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9288276642708753, "overlap": 1.0, "semantic": 0.822069160677188}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.785434129085336, "overlap": 0.6423902151422267, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.6868580839709456, "overlap": 0.5872518259130199, "semantic": 0.836267471057834}, {"chunk_id": "p-edce760829b6", "combined": 0.6755000901642672, "overlap": 0.6344147380747883, "semantic": 0.7371281182984855}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5622425940100354, "overlap": 0.41659681597839304, "semantic": 0.780711261057499}, {"chunk_id": "p-5c1af97004f2", "combined": 0.5074208301762778, "overlap": 0.3670869810950741, "semantic": 0.7179216037980833}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.36268544960526405, "overlap": 0.12427375103423917, "semantic": 0.7203029974618014}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3266197246515212, "overlap": 0.0, "semantic": 0.8165493116288031}, {"chunk_id": "p-ae67c9c86886", "combined": 0.31562876960193004, "overlap": 0.0, "semantic": 0.7890719240048251}, {"chunk_id": "p-0d66effb9582", "combined": 0.30518579425512665, "overlap": 0.0, "semantic": 0.7629644856378166}]}
{"symbol_id": "0f82f1fb3fdcd053544d4383e0907ecfed8a26ef", "symbol_name": "generate_dialogue", "query_text_overlap": "speaker text audio_tensor prompt_wav_list text_list all_generated_segments append audio_chunk len prompt_segments prompt_text prompt_text_list temperature topk audio audio_16k audio_generator generate_dialogue prompt_wav unsqueeze", "query_text_semantic": "def generate_dialogue( self, text_list, prompt_wav_list=None, prompt_text_list=None, temperature=0.9, topk=20, ): all_generated_segments = [] prompt_segments = [] text_list = process_text_list(text_list=text_list) if prompt_wav_list is not None: assert len(prompt_wav_list) == len(prompt_text_list) # Prepare prompts for i in range(len(prompt_wav_list)): prompt_wav = prompt_wav_list[i] prompt_text = prompt_text_list[i] speaker = prompt_text[:4] assert speaker in [\"[S1]\", \"[S2]\", \"[S3]\", \"[S4]\"] prompt_segments.append( self.prepare_prompt( text=prompt_text, speaker=speaker, audio_path=prompt_wav ) ) for text in tqdm(text_list): speaker = text[:4] text = text[4:] # print(\"---speaker:\", speaker) # print(\"---text:\", text) assert speaker in [\"[S1]\", \"[S2]\", \"[S3]\", \"[S4]\"] audio_generator = self.generate( text=text, speaker=speaker, context=prompt_segments + all_generated_segments, max_audio_length_ms=30_000, temperature=temperature, topk=topk, ) audio_tensor = [] for audio_chunk in audio_generator: audio_tensor.append(audio_chunk) yield audio_chunk.unsqueeze(0).cpu() audio_tensor = torch.cat(audio_tensor, dim=0) # 做上下文管理的时候需要将audio 转到16k audio_16k = torchaudio.functional.resample( audio_tensor.unsqueeze(0), 24000, 16000 ) all_generated_segments.append( Segment(text=text, speaker=speaker, audio=audio_16k)", "best": {"chunk_id": "p-88308230dda7", "score": 0.9804586261732058, "overlap_score": 1.0, "semantic_score": 0.9511465654330146}, "alternatives": [{"chunk_id": "p-7b0c753f4b1a", "score": 0.8228658664053533, "overlap_score": 0.8355817286646899, "semantic_score": 0.8037920730163484}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.8037767635085281, "overlap_score": 0.8136325543282465, "semantic_score": 0.7889930772789504}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9804586261732058, "overlap": 1.0, "semantic": 0.9511465654330146}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8228658664053533, "overlap": 0.8355817286646899, "semantic": 0.8037920730163484}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.8037767635085281, "overlap": 0.8136325543282465, "semantic": 0.7889930772789504}, {"chunk_id": "p-edce760829b6", "combined": 0.7784299244254095, "overlap": 0.7973395369699837, "semantic": 0.7500655056085481}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7573863667370342, "overlap": 0.5956439445617238, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6241272846164789, "overlap": 0.4920168021391798, "semantic": 0.8222930083324274}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.41828994887458293, "overlap": 0.1807020347196418, "semantic": 0.7746718201069946}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3820323338379447, "overlap": 0.6367205563965745, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.37784789106135896, "overlap": 0.0, "semantic": 0.9446197276533974}, {"chunk_id": "p-9158b9f667b9", "combined": 0.37528102609476294, "overlap": 0.6254683768246049, "semantic": 0.0}]}
{"symbol_id": "b57a8f541fc33a62b0bb0ef78ee3cb68690ee6ba", "symbol_name": "generate_single", "query_text_overlap": "torch sample device prompt_tokens unsqueeze cat curr_pos dim prompt_tokens_mask bool curr_tokens curr_tokens_mask long segment tokens tokens_mask _model append context generate_single", "query_text_semantic": "def generate_single( self, context: List[Segment], temperature: float = 0.9, topk: int = 20 ): self._model.reset_caches() max_generation_len = 400 tokens, tokens_mask = [], [] for segment in context: segment_tokens, segment_tokens_mask = self._tokenize_segment(segment) tokens.append(segment_tokens) tokens_mask.append(segment_tokens_mask) prompt_tokens = torch.cat(tokens, dim=0).long().to(self.device) prompt_tokens_mask = torch.cat(tokens_mask, dim=0).bool().to(self.device) prompt_tokens = prompt_tokens[:-3, :] prompt_tokens_mask = prompt_tokens_mask[:-3, :] curr_tokens = prompt_tokens.unsqueeze(0) curr_tokens_mask = prompt_tokens_mask.unsqueeze(0) curr_pos = ( torch.arange(0, prompt_tokens.size(0)).unsqueeze(0).long().to(self.device) ) for _ in range(max_generation_len): # sample: (1, nq) sample = self._model.generate_frame( curr_tokens, curr_tokens_mask, curr_pos, temperature, topk ) # eos if torch.all(sample == 0): break yield sample # next AR curr_tokens = torch.cat( [sample, torch.zeros(1, 1).long().to(self.device)], dim=1 ).unsqueeze(1) curr_tokens_mask = torch.cat( [ torch.ones_like(sample).bool(), torch.zeros(1, 1).bool().to(self.device), ], dim=1, ).unsqueeze(1) curr_pos = curr_pos[:, -1:] + 1", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.6201433900977777, "overlap_score": 0.3669056501629628, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-5c1af97004f2", "score": 0.5519432254738253, "overlap_score": 0.42053793962561076, "semantic_score": 0.7490511542461472}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.6201433900977777, "overlap": 0.3669056501629628, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.5519432254738253, "overlap": 0.42053793962561076, "semantic": 0.7490511542461472}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.538244654261173, "overlap": 0.3254751133826909, "semantic": 0.8573989655788958}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4909814760641633, "overlap": 0.2865058984299371, "semantic": 0.7976948425155025}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.48993350226043975, "overlap": 0.31197787811592576, "semantic": 0.7568669384772106}, {"chunk_id": "p-88308230dda7", "combined": 0.4214568392217426, "overlap": 0.24124988752564258, "semantic": 0.6917672667658926}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3582443996375377, "overlap": 0.0, "semantic": 0.8956109990938441}, {"chunk_id": "p-edce760829b6", "combined": 0.3535305774423808, "overlap": 0.5892176290706347, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.30639473156518165, "overlap": 0.0, "semantic": 0.7659868289129541}]}
{"symbol_id": "e2b88def42260e5aa3ff4eb6a2b7be7ec4ab8570", "symbol_name": "generate", "query_text_overlap": "torch unsqueeze prev_sample sample codec_cache device append audio_chunk cat curr_pos curr_tokens dim long max_generation_len tokens tokens_mask bool curr_tokens_mask max_context_len max_seq_len", "query_text_semantic": "def generate( self, text: str, speaker: str, context: List[Segment], max_audio_length_ms: float = 90_000, temperature: float = 0.9, topk: int = 20, ): self._model.reset_caches() max_generation_len = int(max_audio_length_ms / 80) tokens, tokens_mask = [], [] for segment in context: segment_tokens, segment_tokens_mask = self._tokenize_segment(segment) tokens.append(segment_tokens) tokens_mask.append(segment_tokens_mask) gen_segment_tokens, gen_segment_tokens_mask = self._tokenize_text_segment( text, speaker ) tokens.append(gen_segment_tokens) tokens_mask.append(gen_segment_tokens_mask) prompt_tokens = torch.cat(tokens, dim=0).long().to(self.device) prompt_tokens_mask = torch.cat(tokens_mask, dim=0).bool().to(self.device) curr_tokens = prompt_tokens.unsqueeze(0) curr_tokens_mask = prompt_tokens_mask.unsqueeze(0) curr_pos = ( torch.arange(0, prompt_tokens.size(0)).unsqueeze(0).long().to(self.device) ) max_seq_len = 3100 max_context_len = max_seq_len - max_generation_len if curr_tokens.size(1) >= max_context_len: raise ValueError( f\"Inputs too long, must be below max_seq_len - max_generation_len: {max_context_len}\" ) # for streaming token2audio codec_cache = {} prev_sample = None for _ in range(max_generation_len): sample = self._model.generate_frame( curr_tokens, curr_tokens_mask, curr_pos, temperature, topk )", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.7464203227509674, "overlap_score": 0.5773672045849457, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.6557530037130472, "overlap_score": 0.5121716067666648, "semantic_score": 0.8711250991326207}, {"chunk_id": "p-ae67c9c86886", "score": 0.6317022458828427, "overlap_score": 0.45084917498577504, "semantic_score": 0.9029818522284443}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.7464203227509674, "overlap": 0.5773672045849457, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6557530037130472, "overlap": 0.5121716067666648, "semantic": 0.8711250991326207}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6317022458828427, "overlap": 0.45084917498577504, "semantic": 0.9029818522284443}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.6201955636168984, "overlap": 0.4909321927861598, "semantic": 0.8140906198630063}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-88308230dda7", "combined": 0.5649073875980242, "overlap": 0.379633764443929, "semantic": 0.8428178223291671}, {"chunk_id": "p-0d66effb9582", "combined": 0.33539153911543423, "overlap": 0.0, "semantic": 0.8384788477885855}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.31799086946701033, "overlap": 0.0, "semantic": 0.7949771736675257}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3097732947704767, "overlap": 0.0, "semantic": 0.7744332369261917}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3029894526929277, "overlap": 0.0, "semantic": 0.7574736317323192}]}
{"symbol_id": "6586eed7a4cdcaa41f799724a57dd724abe93c48", "symbol_name": "FireRedTTS2", "query_text_overlap": "path audio pretrained_dir text torch device exists join assert load print speaker use_bf16 _model audio_path llm_ckpt_path codec_ckpt_path codec_config_path gen_type json", "query_text_semantic": "class FireRedTTS2: def __init__(self, pretrained_dir, gen_type, device, use_bf16=False): self.use_bf16 = use_bf16 self.device = device self.sample_rate = 16000 self.max_seq_len = 3100 assert os.path.exists(pretrained_dir) assert gen_type in [\"monologue\", \"dialogue\"] llm_config_path = os.path.join(pretrained_dir, \"config_llm.json\") if gen_type == \"monologue\": llm_ckpt_path = os.path.join(pretrained_dir, \"llm_pretrain.pt\") else: llm_ckpt_path = os.path.join(pretrained_dir, \"llm_posttrain.pt\") codec_config_path = os.path.join(pretrained_dir, \"config_codec.json\") codec_ckpt_path = os.path.join(pretrained_dir, \"codec.pt\") pretrained_qwen_path = os.path.join(pretrained_dir, \"Qwen2.5-1.5B\") # check assert os.path.exists(llm_config_path) assert os.path.exists(llm_ckpt_path) assert os.path.exists(codec_config_path) assert os.path.exists(codec_ckpt_path) assert os.path.exists(pretrained_qwen_path) # ==== Load Torch LLM ==== llm_config = json.load(open(llm_config_path)) self._model = load_llm_model( configs=llm_config, checkpoint_path=llm_ckpt_path, device=device ) if use_bf16: if torch.cuda.is_bf16_supported(): print(\"bf16 supported\") self._model.to(dtype=torch.bfloat16) else: self.use_bf16 = False print(\"bf16 not supported\") self._model.eval() self._model.setup_caches(1) print(\"[INFO] LLM Loaded...\") # ==== Load Qwen2.5 Text Tokenizer ==== self._text_tokenizer = load_custom_tokenizer(pretrained_qwen_path) print(\"[INFO] Text Tokenizer Loaded...\") # ==== Load", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.7406144711295292, "overlap_score": 0.8355817286646899, "semantic_score": 0.5981635848267879}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.7364792466065307, "overlap_score": 0.8136325543282465, "semantic_score": 0.6207492850239571}, {"chunk_id": "p-9158b9f667b9", "score": 0.7230174017213583, "overlap_score": 0.6254683768246049, "semantic_score": 0.8693409390664883}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.7406144711295292, "overlap": 0.8355817286646899, "semantic": 0.5981635848267879}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.7364792466065307, "overlap": 0.8136325543282465, "semantic": 0.6207492850239571}, {"chunk_id": "p-9158b9f667b9", "combined": 0.7230174017213583, "overlap": 0.6254683768246049, "semantic": 0.8693409390664883}, {"chunk_id": "p-edce760829b6", "combined": 0.7077700387565342, "overlap": 0.7973395369699837, "semantic": 0.5734157914363599}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.687242990865828, "overlap": 0.5956439445617238, "semantic": 0.8246415603219842}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6861070734188917, "overlap": 0.6367205563965745, "semantic": 0.7601868489523671}, {"chunk_id": "p-88308230dda7", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3619098739134957, "overlap": 0.1807020347196418, "semantic": 0.6337216327042766}, {"chunk_id": "p-0d66effb9582", "combined": 0.3429589026450149, "overlap": 0.18559297385536583, "semantic": 0.5790077958294885}]}
{"symbol_id": "152583faf5e2a6246dc01de8e5d4ca6cb41868f3", "symbol_name": "generate_monologue", "query_text_overlap": "text context gen_tokens prompt_text temperature topk clean_text prompt_wav audio_list speaker all_audio audio audio_tensor generate_monologue input_text prompt_a squeeze text_list unsqueeze _audio_tokenizer", "query_text_semantic": "def generate_monologue( self, text, prompt_wav=None, prompt_text=None, temperature=0.75, topk=20 ): # step1. construct context if prompt_wav is not None: assert os.path.exists(prompt_wav) assert prompt_text is not None all_generated_segments = [] all_storage_segments = [] prompt_segments = [] prompt_text = clean_text(text=prompt_text) text = clean_text(text=text) text_list = split_text(text=text, length=400) audio_list = [] for text in text_list: text = clean_text(text=text) input_text = prompt_text[:-1] + \",\" + text prompt_a = self.prepare_prompt( text=input_text, speaker=\"[S1]\", audio_path=prompt_wav ) context = [prompt_a] while True: gen_tokens = self.generate_single( context=context, temperature=temperature, topk=topk ) if gen_tokens.shape[2] > 18: break # else: # print(\"生成结果小于1s,重新跑\") gen_tokens = gen_tokens[:, :, 2:] # cut leading silence audio = self._audio_tokenizer.decode(gen_tokens).squeeze(0).squeeze(0) audio_list.append(audio.unsqueeze(0)) all_audio = torch.cat(tensors=audio_list, dim=1) return all_audio else: # random speaker text = clean_text(text=text.strip()) audio_tensor = self.generate( text=text, speaker=\"[S1]\",", "best": {"chunk_id": "p-edce760829b6", "score": 0.8654824847124432, "overlap_score": 1.0, "semantic_score": 0.663706211781108}, "alternatives": [{"chunk_id": "p-5c1af97004f2", "score": 0.6461557034781147, "overlap_score": 0.5786230348447546, "semantic_score": 0.7474547064281547}, {"chunk_id": "p-88308230dda7", "score": 0.529369047668158, "overlap_score": 0.30765025005127505, "semantic_score": 0.8619472440934822}], "topk_raw": [{"chunk_id": "p-edce760829b6", "combined": 0.8654824847124432, "overlap": 1.0, "semantic": 0.663706211781108}, {"chunk_id": "p-5c1af97004f2", "combined": 0.6461557034781147, "overlap": 0.5786230348447546, "semantic": 0.7474547064281547}, {"chunk_id": "p-88308230dda7", "combined": 0.529369047668158, "overlap": 0.30765025005127505, "semantic": 0.8619472440934822}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5099500050915653, "overlap": 0.1832500084859421, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.44512471825438316, "overlap": 0.25706692776196854, "semantic": 0.727211403993005}, {"chunk_id": "p-9158b9f667b9", "combined": 0.3961315346932846, "overlap": 0.19242550252925483, "semantic": 0.7016905829393293}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3914876607503147, "overlap": 0.15136909220754738, "semantic": 0.7516655135644655}, {"chunk_id": "p-0d66effb9582", "combined": 0.3217688365620698, "overlap": 0.05709772481436305, "semantic": 0.7187755041836298}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3123274310063743, "overlap": 0.0, "semantic": 0.7808185775159356}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2982548300503118, "overlap": 0.0, "semantic": 0.7456370751257795}]}
{"symbol_id": "1fffd9b3356c57a5e2cea3879c296dc6f7467b75", "symbol_name": "generate_dialogue", "query_text_overlap": "speaker text prompt_wav_list text_list all_audio audio all_generated_segments all_storage_segments append audio_tensor len prompt_segments prompt_text prompt_text_list temperature topk audio_16k generate_dialogue prompt_wav seg", "query_text_semantic": "def generate_dialogue( self, text_list, prompt_wav_list=None, prompt_text_list=None, temperature=0.9, topk=20, ): all_generated_segments = [] all_storage_segments = [] prompt_segments = [] text_list = process_text_list(text_list=text_list) if prompt_wav_list is not None: assert len(prompt_wav_list) == len(prompt_text_list) # Prepare prompts for i in range(len(prompt_wav_list)): prompt_wav = prompt_wav_list[i] prompt_text = prompt_text_list[i] speaker = prompt_text[:4] assert speaker in [\"[S1]\", \"[S2]\", \"[S3]\", \"[S4]\"] prompt_segments.append( self.prepare_prompt( text=prompt_text, speaker=speaker, audio_path=prompt_wav ) ) for text in tqdm(text_list): speaker = text[:4] text = text[4:] # print(\"---speaker:\", speaker) # print(\"---text:\", text) assert speaker in [\"[S1]\", \"[S2]\", \"[S3]\", \"[S4]\"] audio_tensor = self.generate( text=text, speaker=speaker, context=prompt_segments + all_generated_segments, max_audio_length_ms=30_000, temperature=temperature, topk=topk, ) # 做上下文管理的时候需要将audio 转到16k audio_16k = torchaudio.functional.resample( audio_tensor.unsqueeze(0), 24000, 16000 ) all_generated_segments.append( Segment(text=text, speaker=speaker, audio=audio_16k) ) all_storage_segments.append( Segment(text=text, speaker=speaker, audio=audio_tensor.unsqueeze(0)) ) # Concatenate all generations all_audio", "best": {"chunk_id": "p-88308230dda7", "score": 0.9725312571502359, "overlap_score": 1.0, "semantic_score": 0.9313281428755898}, "alternatives": [{"chunk_id": "p-7b0c753f4b1a", "score": 0.8244007748902138, "overlap_score": 0.8355817286646899, "semantic_score": 0.8076293442284994}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.8080254443044186, "overlap_score": 0.8136325543282465, "semantic_score": 0.7996147792686767}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9725312571502359, "overlap": 1.0, "semantic": 0.9313281428755898}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8244007748902138, "overlap": 0.8355817286646899, "semantic": 0.8076293442284994}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.8080254443044186, "overlap": 0.8136325543282465, "semantic": 0.7996147792686767}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7573863667370342, "overlap": 0.5956439445617238, "semantic": 1.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.6766089027833513, "overlap": 0.6254683768246049, "semantic": 0.753319691721471}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.619407329249726, "overlap": 0.4920168021391798, "semantic": 0.8104931199155451}, {"chunk_id": "p-edce760829b6", "combined": 0.47840372218199023, "overlap": 0.7973395369699837, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.42717494461802896, "overlap": 0.1807020347196418, "semantic": 0.7968843094656097}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3829844773333273, "overlap": 0.0, "semantic": 0.9574611933333183}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3820323338379447, "overlap": 0.6367205563965745, "semantic": 0.0}]}
{"symbol_id": "baead92c96028d374eb886797dca651bb5404591", "symbol_name": "generate_single", "query_text_overlap": "torch device prompt_tokens sample unsqueeze cat curr_pos dim prompt_tokens_mask time append bool curr_tokens curr_tokens_mask duration long num_token samples segment tokens", "query_text_semantic": "def generate_single( self, context: List[Segment], temperature: float = 0.9, topk: int = 20 ): self._model.reset_caches() max_generation_len = 400 tokens, tokens_mask = [], [] for segment in context: segment_tokens, segment_tokens_mask = self._tokenize_segment(segment) tokens.append(segment_tokens) tokens_mask.append(segment_tokens_mask) prompt_tokens = torch.cat(tokens, dim=0).long().to(self.device) prompt_tokens_mask = torch.cat(tokens_mask, dim=0).bool().to(self.device) prompt_tokens = prompt_tokens[:-3, :] prompt_tokens_mask = prompt_tokens_mask[:-3, :] samples = [] curr_tokens = prompt_tokens.unsqueeze(0) curr_tokens_mask = prompt_tokens_mask.unsqueeze(0) curr_pos = ( torch.arange(0, prompt_tokens.size(0)).unsqueeze(0).long().to(self.device) ) num_token = 0 start_time = time.time() for _ in range(max_generation_len): sample = self._model.generate_frame( curr_tokens, curr_tokens_mask, curr_pos, temperature, topk ) # eos if torch.all(sample == 0): break samples.append(sample) curr_tokens = torch.cat( [sample, torch.zeros(1, 1).long().to(self.device)], dim=1 ).unsqueeze(1) curr_tokens_mask = torch.cat( [ torch.ones_like(sample).bool(), torch.zeros(1, 1).bool().to(self.device), ], dim=1, ).unsqueeze(1) curr_pos = curr_pos[:, -1:] + 1 num_token += 1 if num_token", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.6201433900977777, "overlap_score": 0.3669056501629628, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.5370450378530569, "overlap_score": 0.3254751133826909, "semantic_score": 0.8543999245586057}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.6201433900977777, "overlap": 0.3669056501629628, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5370450378530569, "overlap": 0.3254751133826909, "semantic": 0.8543999245586057}, {"chunk_id": "p-ae67c9c86886", "combined": 0.5031907776553466, "overlap": 0.2865058984299371, "semantic": 0.8282180964934607}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4907457318662274, "overlap": 0.31197787811592576, "semantic": 0.7588975124916798}, {"chunk_id": "p-88308230dda7", "combined": 0.42981349376073635, "overlap": 0.24124988752564258, "semantic": 0.712658903113377}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3620356808305244, "overlap": 0.0, "semantic": 0.9050892020763109}, {"chunk_id": "p-021b4cb4f328", "combined": 0.322627697709326, "overlap": 0.0, "semantic": 0.8065692442733149}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3018972696399335, "overlap": 0.0, "semantic": 0.7547431740998337}, {"chunk_id": "p-0d66effb9582", "combined": 0.2638964181733213, "overlap": 0.0, "semantic": 0.6597410454333033}]}
{"symbol_id": "7acb658a92e9022959f668860d19e98b6c50b19e", "symbol_name": "generate", "query_text_overlap": "torch append device sample unsqueeze cat curr_pos curr_tokens dim long max_generation_len tokens tokens_mask bool curr_tokens_mask max_context_len max_seq_len prompt_tokens samples segment", "query_text_semantic": "def generate( self, text: str, speaker: str, context: List[Segment], max_audio_length_ms: float = 90_000, temperature: float = 0.9, topk: int = 20, ) -> torch.Tensor: self._model.reset_caches() max_generation_len = int(max_audio_length_ms / 80) tokens, tokens_mask = [], [] for segment in context: segment_tokens, segment_tokens_mask = self._tokenize_segment(segment) tokens.append(segment_tokens) tokens_mask.append(segment_tokens_mask) gen_segment_tokens, gen_segment_tokens_mask = self._tokenize_text_segment( text, speaker ) tokens.append(gen_segment_tokens) tokens_mask.append(gen_segment_tokens_mask) prompt_tokens = torch.cat(tokens, dim=0).long().to(self.device) prompt_tokens_mask = torch.cat(tokens_mask, dim=0).bool().to(self.device) samples = [] curr_tokens = prompt_tokens.unsqueeze(0) curr_tokens_mask = prompt_tokens_mask.unsqueeze(0) curr_pos = ( torch.arange(0, prompt_tokens.size(0)).unsqueeze(0).long().to(self.device) ) max_seq_len = 3100 max_context_len = max_seq_len - max_generation_len if curr_tokens.size(1) >= max_context_len: raise ValueError( f\"Inputs too long, must be below max_seq_len - max_generation_len: {max_context_len}\" ) for _ in range(max_generation_len): sample = self._model.generate_frame( curr_tokens, curr_tokens_mask, curr_pos, temperature, topk ) # eos if torch.all(sample ==", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.6201433900977777, "overlap_score": 0.3669056501629628, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.5694688190961015, "overlap_score": 0.3254751133826909, "semantic_score": 0.9354593776662175}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.6201433900977777, "overlap": 0.3669056501629628, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5694688190961015, "overlap": 0.3254751133826909, "semantic": 0.9354593776662175}, {"chunk_id": "p-ae67c9c86886", "combined": 0.5637842244123658, "overlap": 0.2865058984299371, "semantic": 0.9797017133860085}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5316373109128497, "overlap": 0.31197787811592576, "semantic": 0.8611264601082356}, {"chunk_id": "p-88308230dda7", "combined": 0.4931080062853706, "overlap": 0.24124988752564258, "semantic": 0.8708951844249626}, {"chunk_id": "p-0d66effb9582", "combined": 0.35392603732601324, "overlap": 0.0, "semantic": 0.884815093315033}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3346704091600411, "overlap": 0.0, "semantic": 0.8366760229001027}, {"chunk_id": "p-5c1af97004f2", "combined": 0.30458697587575584, "overlap": 0.0, "semantic": 0.7614674396893896}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3007342530881753, "overlap": 0.0, "semantic": 0.7518356327204382}]}
{"symbol_id": "5a48a6e36ef935df0459e495f57543b7562d863b", "symbol_name": "_tokenize_segment", "query_text_overlap": "segment torch seq_len _tokenize_segment audio_masks audio_tokens cat dim tensor text_masks text_tokens _tokenize_audio _tokenize_text_segment audio speaker text tuple returns", "query_text_semantic": "Returns:\n            (seq_len,17), (seq_len, 17)", "best": {"chunk_id": "p-0212d69b9ec4", "score": 0.8235705986169013, "overlap_score": 1.0, "semantic_score": 0.5589264965422532}, "alternatives": [{"chunk_id": "p-7b0c753f4b1a", "score": 0.4704039794241221, "overlap_score": 0.49200633261555615, "semantic_score": 0.43800044963697105}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.42569518246274807, "overlap_score": 0.47908224344659994, "semantic_score": 0.3456145909869703}], "topk_raw": [{"chunk_id": "p-0212d69b9ec4", "combined": 0.8235705986169013, "overlap": 1.0, "semantic": 0.5589264965422532}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4704039794241221, "overlap": 0.49200633261555615, "semantic": 0.43800044963697105}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.42569518246274807, "overlap": 0.47908224344659994, "semantic": 0.3456145909869703}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.37999569933308025, "overlap": 0.2897088029827826, "semantic": 0.5154260438585266}, {"chunk_id": "p-88308230dda7", "combined": 0.3532913531284213, "overlap": 0.5888189218807022, "semantic": 0.0}, {"chunk_id": "p-edce760829b6", "combined": 0.28169316391891447, "overlap": 0.46948860653152413, "semantic": 0.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.27593344303791245, "overlap": 0.0, "semantic": 0.6898336075947811}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.26070210289203377, "overlap": 0.0, "semantic": 0.6517552572300844}, {"chunk_id": "p-5c1af97004f2", "combined": 0.24038255275991682, "overlap": 0.0, "semantic": 0.6009563818997921}]}
{"symbol_id": "ae5febe1b9c6716111a76037feb50d1384f5c539", "symbol_name": "_tokenize_audio", "query_text_overlap": "torch audio_tokens device tensor audio audio_frame audio_frame_mask cat dim frame_masks frame_tokens size zeros _tokenize_audio append audio_length eos_frame long _audio_tokenizer batch_size", "query_text_semantic": "def _tokenize_audio(self, audio: torch.Tensor) -> Tuple[torch.Tensor, torch.Tensor]: frame_tokens = [] frame_masks = [] # (K, T) audio_length = torch.tensor([audio.shape[1]], dtype=torch.long) audio_tokens, token_length = self._audio_tokenizer.encode( audio.to(self.device), audio_length.to(self.device), batch_size=48, ) audio_tokens = audio_tokens.squeeze(0) # add EOS frame eos_frame = torch.zeros(audio_tokens.size(0), 1).to(self.device) audio_tokens = torch.cat([audio_tokens, eos_frame], dim=1) audio_frame = torch.zeros(audio_tokens.size(1), 17).long().to(self.device) audio_frame_mask = torch.zeros(audio_tokens.size(1), 17).bool().to(self.device) audio_frame[:, :-1] = audio_tokens.transpose(0, 1) audio_frame_mask[:, :-1] = True frame_tokens.append(audio_frame) frame_masks.append(audio_frame_mask) return torch.cat(frame_tokens, dim=0), torch.cat(frame_masks, dim=0)", "best": {"chunk_id": "p-0212d69b9ec4", "score": 0.8145608054968277, "overlap_score": 1.0, "semantic_score": 0.5364020137420694}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-0d66effb9582", "score": 0.39066396558352473, "overlap_score": 0.0, "semantic_score": 0.9766599139588118}], "topk_raw": [{"chunk_id": "p-0212d69b9ec4", "combined": 0.8145608054968277, "overlap": 1.0, "semantic": 0.5364020137420694}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.39066396558352473, "overlap": 0.0, "semantic": 0.9766599139588118}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3851994836705015, "overlap": 0.0, "semantic": 0.9629987091762536}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3420988011607118, "overlap": 0.0, "semantic": 0.8552470029017794}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3291082893250983, "overlap": 0.0, "semantic": 0.8227707233127457}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3245218653567396, "overlap": 0.0, "semantic": 0.8113046633918489}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.30584542460878095, "overlap": 0.0, "semantic": 0.7646135615219524}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.25890116351548226, "overlap": 0.0, "semantic": 0.6472529087887056}, {"chunk_id": "p-88308230dda7", "combined": 0.2421905004939789, "overlap": 0.0, "semantic": 0.6054762512349472}]}
{"symbol_id": "9fd1fefb4dd794000e4ab094b662229346cad417", "symbol_name": "_tokenize_text_segment", "query_text_overlap": "torch text text_tokens frame_masks frame_tokens tensor text_frame text_frame_mask _tokenize_text_segment append cat device dim len speaker str zeros _text_tokenizer bool encode", "query_text_semantic": "def _tokenize_text_segment( self, text: str, speaker: str ) -> Tuple[torch.Tensor, torch.Tensor]: frame_tokens = [] frame_masks = [] text = speaker + \"<|text_start|>\" + text + \"<|text_end|>\" text_tokens = self._text_tokenizer.encode(text) text_frame = torch.zeros(len(text_tokens), 17).long() text_frame_mask = torch.zeros(len(text_tokens), 17).bool() text_frame[:, -1] = torch.tensor(text_tokens) text_frame_mask[:, -1] = True frame_tokens.append(text_frame.to(self.device)) frame_masks.append(text_frame_mask.to(self.device)) return torch.cat(frame_tokens, dim=0), torch.cat(frame_masks, dim=0)", "best": {"chunk_id": "p-88308230dda7", "score": 0.9360373995674759, "overlap_score": 1.0, "semantic_score": 0.8400934989186898}, "alternatives": [{"chunk_id": "p-7b0c753f4b1a", "score": 0.8469551745076468, "overlap_score": 0.8355817286646899, "semantic_score": 0.8640153432720821}, {"chunk_id": "p-ebeeda9fc683", "score": 0.7709046336896004, "overlap_score": 0.6367205563965745, "semantic_score": 0.9721807496291391}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9360373995674759, "overlap": 1.0, "semantic": 0.8400934989186898}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8469551745076468, "overlap": 0.8355817286646899, "semantic": 0.8640153432720821}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.7709046336896004, "overlap": 0.6367205563965745, "semantic": 0.9721807496291391}, {"chunk_id": "p-edce760829b6", "combined": 0.7635796348634715, "overlap": 0.7973395369699837, "semantic": 0.7129397817037031}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7232866308203498, "overlap": 0.5956439445617238, "semantic": 0.9147506602082891}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6952100812835079, "overlap": 0.4920168021391798, "semantic": 1.0}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4881795325969479, "overlap": 0.8136325543282465, "semantic": 0.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.4570307142526008, "overlap": 0.18559297385536583, "semantic": 0.8641873248484532}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3943853620437755, "overlap": 0.0, "semantic": 0.9859634051094387}, {"chunk_id": "p-9158b9f667b9", "combined": 0.37528102609476294, "overlap": 0.6254683768246049, "semantic": 0.0}]}
{"symbol_id": "58cbd61cf1310066c1d8ba06980787c9b10098e3", "symbol_name": "prepare_prompt", "query_text_overlap": "speaker text audio_path audio_tensor prepare_prompt segment audio load_prompt_audio", "query_text_semantic": "def prepare_prompt(self, text, speaker, audio_path) -> Segment: audio_tensor = self.load_prompt_audio(audio_path) return Segment(text=text, speaker=speaker, audio=audio_tensor)", "best": {"chunk_id": "p-88308230dda7", "score": 0.6716761402188204, "overlap_score": 0.5888189218807022, "semantic_score": 0.7959619677259977}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.6104358551569617, "overlap_score": 0.3507264252616029, "semantic_score": 1.0}, {"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.6716761402188204, "overlap": 0.5888189218807022, "semantic": 0.7959619677259977}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.6104358551569617, "overlap": 0.3507264252616029, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5441084994756156, "overlap": 0.49200633261555615, "semantic": 0.6222617497657048}, {"chunk_id": "p-edce760829b6", "combined": 0.5243255373793654, "overlap": 0.46948860653152413, "semantic": 0.6065809336511273}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.475636905730647, "overlap": 0.2897088029827826, "semantic": 0.7545290598524436}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4599325826201505, "overlap": 0.36828761531233667, "semantic": 0.5974000335818713}, {"chunk_id": "p-0d66effb9582", "combined": 0.3177306147612648, "overlap": 0.10928065477414986, "semantic": 0.6304055547419373}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.28744934606795997, "overlap": 0.47908224344659994, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.27864123242249217, "overlap": 0.0, "semantic": 0.6966030810562304}]}
{"symbol_id": "40909839fcda08c540f3dc37e24a7b77d92e0e7a", "symbol_name": "load_prompt_audio", "query_text_overlap": "audio audio16k audio_path audio_sr load_prompt_audio torchaudio functional load resample shape tensor torch unsqueeze must single channel 16000", "query_text_semantic": "def load_prompt_audio(self, audio_path) -> torch.Tensor: audio, audio_sr = torchaudio.load(audio_path) # Audio must be single channel if audio.shape[0] > 1: audio = audio[0, :].unsqueeze(0) audio16k = torchaudio.functional.resample(audio, audio_sr, 16000) return audio16k", "best": {"chunk_id": "p-88308230dda7", "score": 0.8642265354378906, "overlap_score": 1.0, "semantic_score": 0.6605663385947266}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.38144831991505135, "overlap_score": 0.0, "semantic_score": 0.9536207997876284}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.8642265354378906, "overlap": 1.0, "semantic": 0.6605663385947266}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.38144831991505135, "overlap": 0.0, "semantic": 0.9536207997876284}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3749372034607871, "overlap": 0.6248953391013119, "semantic": 0.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.34323855407093773, "overlap": 0.0, "semantic": 0.8580963851773443}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.33498567206695357, "overlap": 0.0, "semantic": 0.8374641801673839}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.30397406361284607, "overlap": 0.0, "semantic": 0.7599351590321152}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2977822193188522, "overlap": 0.0, "semantic": 0.7444555482971305}, {"chunk_id": "p-021b4cb4f328", "combined": 0.2651208295571823, "overlap": 0.0, "semantic": 0.6628020738929558}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2610298147887899, "overlap": 0.0, "semantic": 0.6525745369719748}]}
{"symbol_id": "c9fe7af7848cc8995e3b7b3ea5bfd8914805662c", "symbol_name": "__init__", "query_text_overlap": "path pretrained_dir device exists join assert print use_bf16 _model llm_ckpt_path load torch codec_ckpt_path codec_config_path gen_type json llm_config_path pretrained_qwen_path torch_codec __init__", "query_text_semantic": "def __init__(self, pretrained_dir, gen_type, device, use_bf16=False): self.use_bf16 = use_bf16 self.device = device self.sample_rate = 16000 self.max_seq_len = 3100 assert os.path.exists(pretrained_dir) assert gen_type in [\"monologue\", \"dialogue\"] llm_config_path = os.path.join(pretrained_dir, \"config_llm.json\") if gen_type == \"monologue\": llm_ckpt_path = os.path.join(pretrained_dir, \"llm_pretrain.pt\") else: llm_ckpt_path = os.path.join(pretrained_dir, \"llm_posttrain.pt\") codec_config_path = os.path.join(pretrained_dir, \"config_codec.json\") codec_ckpt_path = os.path.join(pretrained_dir, \"codec.pt\") pretrained_qwen_path = os.path.join(pretrained_dir, \"Qwen2.5-1.5B\") # check assert os.path.exists(llm_config_path) assert os.path.exists(llm_ckpt_path) assert os.path.exists(codec_config_path) assert os.path.exists(codec_ckpt_path) assert os.path.exists(pretrained_qwen_path) # ==== Load Torch LLM ==== llm_config = json.load(open(llm_config_path)) self._model = load_llm_model( configs=llm_config, checkpoint_path=llm_ckpt_path, device=device ) if use_bf16: if torch.cuda.is_bf16_supported(): print(\"bf16 supported\") self._model.to(dtype=torch.bfloat16) else: self.use_bf16 = False print(\"bf16 not supported\") self._model.eval() self._model.setup_caches(1) print(\"[INFO] LLM Loaded...\") # ==== Load Qwen2.5 Text Tokenizer ==== self._text_tokenizer = load_custom_tokenizer(pretrained_qwen_path) print(\"[INFO] Text Tokenizer Loaded...\") # ==== Load Torch Audio", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.3514508442238713, "overlap_score": 0.0, "semantic_score": 0.8786271105596782}, {"chunk_id": "p-ae67c9c86886", "score": 0.3362142044269002, "overlap_score": 0.0, "semantic_score": 0.8405355110672504}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3514508442238713, "overlap": 0.0, "semantic": 0.8786271105596782}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3362142044269002, "overlap": 0.0, "semantic": 0.8405355110672504}, {"chunk_id": "p-0d66effb9582", "combined": 0.32885375694178, "overlap": 0.0, "semantic": 0.82213439235445}, {"chunk_id": "p-88308230dda7", "combined": 0.3030651595239757, "overlap": 0.0, "semantic": 0.7576628988099392}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.29926080914295305, "overlap": 0.0, "semantic": 0.7481520228573826}, {"chunk_id": "p-5c1af97004f2", "combined": 0.29496199537051937, "overlap": 0.0, "semantic": 0.7374049884262984}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2772365486683101, "overlap": 0.0, "semantic": 0.6930913716707753}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.23881679559081928, "overlap": 0.0, "semantic": 0.5970419889770482}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.23575986295985168, "overlap": 0.0, "semantic": 0.5893996573996292}]}
{"symbol_id": "2f3fbed619426aa3fe017d9f9908b0b59db989bb", "symbol_name": "process_text_list", "query_text_overlap": "result speaker text new_text_list chunk process_text_list text_list append process_text print assert len", "query_text_semantic": "def process_text_list(text_list): new_text_list = [] for text in text_list: speaker = text[:4] # print(\"---speaker:\", speaker) assert speaker in [\"[S1]\", \"[S2]\", \"[S3]\", \"[S4]\"] result = process_text(text=text) # print(\"---result:\\n\", result, len(result)) for chunk in result: new_text_list.append(speaker + chunk) return new_text_list", "best": {"chunk_id": "p-88308230dda7", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-7b0c753f4b1a", "score": 0.833432658138022, "overlap_score": 0.8355817286646899, "semantic_score": 0.83020905234802}, {"chunk_id": "p-62dccf79cb8d", "score": 0.7283952013112733, "overlap_score": 0.5956439445617238, "semantic_score": 0.9275220864355975}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.833432658138022, "overlap": 0.8355817286646899, "semantic": 0.83020905234802}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.7283952013112733, "overlap": 0.5956439445617238, "semantic": 0.9275220864355975}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6947158376898339, "overlap": 0.6367205563965745, "semantic": 0.7817087596297229}, {"chunk_id": "p-9158b9f667b9", "combined": 0.6628920286032924, "overlap": 0.6254683768246049, "semantic": 0.7190275062713238}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6604413749812321, "overlap": 0.4920168021391798, "semantic": 0.9130782342443104}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4881795325969479, "overlap": 0.8136325543282465, "semantic": 0.0}, {"chunk_id": "p-edce760829b6", "combined": 0.47840372218199023, "overlap": 0.7973395369699837, "semantic": 0.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.4009949747151422, "overlap": 0.18559297385536583, "semantic": 0.7240979760048069}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3164265677847098, "overlap": 0.0, "semantic": 0.7910664194617745}]}
{"symbol_id": "b1d0d148c9b4b9383ff99bf5403809736d776281", "symbol_name": "process_text", "query_text_overlap": "text sentences chinese_max_limit english_max_limit result is_chinese process_text contains_chinese count_characters_chinese count_words_english merge_sentences_chinese merge_sentences_english split_by_punctuation_chinese split_by_punctuation_english strip sub 150 else", "query_text_semantic": "def process_text(text): chinese_max_limit = 150 english_max_limit = 80 # 移除开头的标记如[S2] text = re.sub(r\"^\\[S\\d+\\]\", \"\", text).strip() is_chinese = contains_chinese(text) if is_chinese: if count_characters_chinese(text) <= chinese_max_limit: return [text] sentences = split_by_punctuation_chinese(text) result = merge_sentences_chinese(sentences, chinese_max_limit) else: if count_words_english(text) <= english_max_limit: return [text] sentences = split_by_punctuation_english(text) result = merge_sentences_english(sentences, english_max_limit) return result", "best": {"chunk_id": "p-88308230dda7", "score": 0.9228193018033974, "overlap_score": 1.0, "semantic_score": 0.8070482545084937}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.8276134457830038, "overlap_score": 0.9395132680573294, "semantic_score": 0.6597637123715153}, {"chunk_id": "p-ebeeda9fc683", "score": 0.7746020156633711, "overlap_score": 0.7352304275402555, "semantic_score": 0.8336593978480443}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9228193018033974, "overlap": 1.0, "semantic": 0.8070482545084937}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.8276134457830038, "overlap": 0.9395132680573294, "semantic": 0.6597637123715153}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.7746020156633711, "overlap": 0.7352304275402555, "semantic": 0.8336593978480443}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.6947362876180432, "overlap": 0.6877986702680241, "semantic": 0.7051427136430718}, {"chunk_id": "p-edce760829b6", "combined": 0.5524196912807676, "overlap": 0.9206994854679461, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5242322954422515, "overlap": 0.4503298870901919, "semantic": 0.6350859079703408}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4588714335220053, "overlap": 0.7647857225366755, "semantic": 0.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4333424239118578, "overlap": 0.7222373731864297, "semantic": 0.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3263740680655959, "overlap": 0.0, "semantic": 0.8159351701639896}]}
{"symbol_id": "b10399782510b9f31f6abda56ac9984667eb431a", "symbol_name": "merge_sentences_chinese", "query_text_overlap": "current_chunk result sentence test_chunk append max_chars merge_sentences_chinese sentences count_characters_chinese else 100 not", "query_text_semantic": "合并中文句子", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.6176087875897083, "overlap_score": 1.0, "semantic_score": 0.04402196897427085}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-0212d69b9ec4", "score": 0.3865922411387106, "overlap_score": 0.644320401897851, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.6176087875897083, "overlap": 1.0, "semantic": 0.04402196897427085}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3865922411387106, "overlap": 0.644320401897851, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.08159047993270514, "overlap": 0.0, "semantic": 0.20397619983176285}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.04659963233365347, "overlap": 0.0, "semantic": 0.11649908083413366}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.04223392459021191, "overlap": 0.0, "semantic": 0.10558481147552977}, {"chunk_id": "p-ae67c9c86886", "combined": 0.02822487675754114, "overlap": 0.0, "semantic": 0.07056219189385285}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.027886821434855213, "overlap": 0.0, "semantic": 0.06971705358713803}, {"chunk_id": "p-0d66effb9582", "combined": 0.018017133851321043, "overlap": 0.0, "semantic": 0.0450428346283026}, {"chunk_id": "p-edce760829b6", "combined": 0.015679806223918156, "overlap": 0.0, "semantic": 0.03919951555979539}]}
{"symbol_id": "c900d3db0a7d37e3f3ceb9716ffff4edbd902d16", "symbol_name": "merge_sentences_english", "query_text_overlap": "current_chunk result sentence test_chunk append max_words merge_sentences_english sentences count_words_english else not", "query_text_semantic": "合并英文句子", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.6569072020082033, "overlap_score": 1.0, "semantic_score": 0.1422680050205082}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-021b4cb4f328", "score": 0.1025137228639833, "overlap_score": 0.0, "semantic_score": 0.25628430715995826}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.6569072020082033, "overlap": 1.0, "semantic": 0.1422680050205082}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.1025137228639833, "overlap": 0.0, "semantic": 0.25628430715995826}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.08165515366634434, "overlap": 0.0, "semantic": 0.20413788416586082}, {"chunk_id": "p-0d66effb9582", "combined": 0.05585769846652216, "overlap": 0.0, "semantic": 0.13964424616630539}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.05219325487786404, "overlap": 0.0, "semantic": 0.1304831371946601}, {"chunk_id": "p-ae67c9c86886", "combined": 0.04822529424340546, "overlap": 0.0, "semantic": 0.12056323560851363}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.04569233388503235, "overlap": 0.0, "semantic": 0.11423083471258086}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.04510460099985417, "overlap": 0.0, "semantic": 0.11276150249963543}, {"chunk_id": "p-88308230dda7", "combined": 0.04287565676487287, "overlap": 0.0, "semantic": 0.10718914191218216}]}
{"symbol_id": "f63ab90f944f64cbec40ce09958c7ed20dee973c", "symbol_name": "split_by_punctuation_chinese", "query_text_overlap": "sentences result sentence len strip append split_by_punctuation_chinese text range split", "query_text_semantic": "按中文标点符号分割", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.6339621181010558, "overlap_score": 1.0, "semantic_score": 0.08490529525263975}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.26739478937629646, "overlap_score": 0.34543725619518706, "semantic_score": 0.1503310891479605}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.6339621181010558, "overlap": 1.0, "semantic": 0.08490529525263975}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.26739478937629646, "overlap": 0.34543725619518706, "semantic": 0.1503310891479605}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23996874044066274, "overlap": 0.27032718982870446, "semantic": 0.1944310663586002}, {"chunk_id": "p-88308230dda7", "combined": 0.22060609547928706, "overlap": 0.3676768257988118, "semantic": 0.0}, {"chunk_id": "p-edce760829b6", "combined": 0.20311191859887218, "overlap": 0.33851986433145365, "semantic": 0.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.20010514078217317, "overlap": 0.26554994484645833, "semantic": 0.1019379346857455}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.16871639212712142, "overlap": 0.2811939868785357, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1517325791236744, "overlap": 0.2528876318727907, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.09934551806859544, "overlap": 0.16557586344765907, "semantic": 0.0}]}
{"symbol_id": "2a10c32af14d87f28b9e7469fe8f4b27c62baa40", "symbol_name": "split_by_punctuation_english", "query_text_overlap": "sentences result sentence len strip append split_by_punctuation_english text range split", "query_text_semantic": "按英文标点符号分割", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.6945245785582856, "overlap_score": 1.0, "semantic_score": 0.23631144639571422}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ebeeda9fc683", "score": 0.2722446990378193, "overlap_score": 0.27032718982870446, "semantic_score": 0.27512096285149157}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.6945245785582856, "overlap": 1.0, "semantic": 0.23631144639571422}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2722446990378193, "overlap": 0.27032718982870446, "semantic": 0.27512096285149157}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.25079399774302846, "overlap": 0.34543725619518706, "semantic": 0.10882911006479057}, {"chunk_id": "p-88308230dda7", "combined": 0.22060609547928706, "overlap": 0.3676768257988118, "semantic": 0.0}, {"chunk_id": "p-edce760829b6", "combined": 0.20311191859887218, "overlap": 0.33851986433145365, "semantic": 0.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2005855833616184, "overlap": 0.26554994484645833, "semantic": 0.10313904113435855}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.16871639212712142, "overlap": 0.2811939868785357, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.15351122112543786, "overlap": 0.16557586344765907, "semantic": 0.135414257642106}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1517325791236744, "overlap": 0.2528876318727907, "semantic": 0.0}]}
{"symbol_id": "239b754845e21944f82a0b8d8705afb2e08e91ff", "symbol_name": "count_characters_chinese", "query_text_overlap": "count_characters_chinese text len", "query_text_semantic": "统计中文字符数量", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.6066111327963738, "overlap_score": 0.9395132680573294, "semantic_score": 0.10725792990494047}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.6001439397329043, "overlap_score": 1.0, "semantic_score": 0.00035984933226071176}, {"chunk_id": "p-edce760829b6", "score": 0.5525636310136719, "overlap_score": 0.9206994854679461, "semantic_score": 0.00035984933226071176}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.6066111327963738, "overlap": 0.9395132680573294, "semantic": 0.10725792990494047}, {"chunk_id": "p-88308230dda7", "combined": 0.6001439397329043, "overlap": 1.0, "semantic": 0.00035984933226071176}, {"chunk_id": "p-edce760829b6", "combined": 0.5525636310136719, "overlap": 0.9206994854679461, "semantic": 0.00035984933226071176}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5173998830593214, "overlap": 0.7352304275402555, "semantic": 0.19065406633792012}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4590153732549096, "overlap": 0.7647857225366755, "semantic": 0.00035984933226071176}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4584125026695356, "overlap": 0.7222373731864297, "semantic": 0.06267519689419451}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4128231418937187, "overlap": 0.6877986702680241, "semantic": 0.00035984933226071176}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.27847623056459747, "overlap": 0.4503298870901919, "semantic": 0.020695745776205792}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.09596572605643716, "overlap": 0.0, "semantic": 0.2399143151410929}]}
{"symbol_id": "8ace2d13d1ae43b87de326f24e0d52ff48ccaa71", "symbol_name": "count_words_english", "query_text_overlap": "count_words_english text len split", "query_text_semantic": "统计英文单词数量", "best": {"chunk_id": "p-88308230dda7", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.5772216193997197, "overlap_score": 0.9395132680573294, "semantic_score": 0.033784146413305446}, {"chunk_id": "p-edce760829b6", "score": 0.5524196912807676, "overlap_score": 0.9206994854679461, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.5772216193997197, "overlap": 0.9395132680573294, "semantic": 0.033784146413305446}, {"chunk_id": "p-edce760829b6", "combined": 0.5524196912807676, "overlap": 0.9206994854679461, "semantic": 0.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.546068490935837, "overlap": 0.7352304275402555, "semantic": 0.2623255860292092}, {"chunk_id": "p-9158b9f667b9", "combined": 0.45969630775774106, "overlap": 0.7222373731864297, "semantic": 0.06588470961470821}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4588714335220053, "overlap": 0.7647857225366755, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.41267920216081444, "overlap": 0.6877986702680241, "semantic": 0.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3134816320740917, "overlap": 0.4503298870901919, "semantic": 0.10820924954994135}, {"chunk_id": "p-021b4cb4f328", "combined": 0.13922006005402437, "overlap": 0.0, "semantic": 0.3480501501350609}]}
{"symbol_id": "eb1e7819c3b2357d9efaab00894ddab9829753c8", "symbol_name": "contains_chinese", "query_text_overlap": "contains_chinese text bool search u4e00 u9fff", "query_text_semantic": "检测文本是否包含中文字符", "best": {"chunk_id": "p-88308230dda7", "score": 0.6327397986333245, "overlap_score": 1.0, "semantic_score": 0.08184949658331143}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.6316738182699599, "overlap_score": 0.9395132680573294, "semantic_score": 0.16991464358890584}, {"chunk_id": "p-edce760829b6", "score": 0.5524196912807676, "overlap_score": 0.9206994854679461, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.6327397986333245, "overlap": 1.0, "semantic": 0.08184949658331143}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.6316738182699599, "overlap": 0.9395132680573294, "semantic": 0.16991464358890584}, {"chunk_id": "p-edce760829b6", "combined": 0.5524196912807676, "overlap": 0.9206994854679461, "semantic": 0.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5371841353503976, "overlap": 0.7352304275402555, "semantic": 0.24011469706561075}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4899589387863558, "overlap": 0.7222373731864297, "semantic": 0.1415412871862451}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4588714335220053, "overlap": 0.7647857225366755, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.41267920216081444, "overlap": 0.6877986702680241, "semantic": 0.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.27019793225411515, "overlap": 0.4503298870901919, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.11962855601827907, "overlap": 0.0, "semantic": 0.29907139004569766}]}
{"symbol_id": "b59568c2fbaff27af45667b3c8fb80fa7f82090a", "symbol_name": "split_text", "query_text_overlap": "texts text length curr segments break_text split add_cleaned map split_text utf_8_len longer than break_text_by_length clean_text list protect_float unprotect_float still break", "query_text_semantic": "def split_text(text, length): text = clean_text(text) # Break the text into pieces with following rules: # 1. Split the text at \".\", \"!\", \"?\" if text is NOT a float # 2. If the text is longer than length, split at \",\" # 3. If the text is still longer than length, split at \" \" # 4. If the text is still longer than length, split at any character to length texts = [text] texts = map(protect_float, texts) texts = break_text(texts, length, {\".\", \"!\", \"?\", \"。\", \"！\", \"？\"}) texts = map(unprotect_float, texts) texts = break_text(texts, length, {\",\", \"，\"}) texts = break_text(texts, length, {\" \"}) texts = list(break_text_by_length(texts, length)) # Then, merge the texts into segments with length <= length", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.8649763422547121, "overlap_score": 1.0, "semantic_score": 0.6624408556367801}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.8495163204432384, "overlap_score": 0.7491938674053974, "semantic_score": 1.0}, {"chunk_id": "p-0d66effb9582", "score": 0.5895551614327533, "overlap_score": 0.6105273868070776, "semantic_score": 0.5580968233712669}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.8649763422547121, "overlap": 1.0, "semantic": 0.6624408556367801}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.8495163204432384, "overlap": 0.7491938674053974, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.5895551614327533, "overlap": 0.6105273868070776, "semantic": 0.5580968233712669}, {"chunk_id": "p-88308230dda7", "combined": 0.5785734848664299, "overlap": 0.3676768257988118, "semantic": 0.894918473467857}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5363279239927903, "overlap": 0.2811939868785357, "semantic": 0.9190288296641721}, {"chunk_id": "p-edce760829b6", "combined": 0.5337275133290493, "overlap": 0.33851986433145365, "semantic": 0.826538986825443}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.514629176354882, "overlap": 0.27032718982870446, "semantic": 0.8810821561441483}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4940851939188774, "overlap": 0.34543725619518706, "semantic": 0.717057100504413}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.4474565326593369, "overlap": 0.7457608877655615, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3490119623189827, "overlap": 0.0, "semantic": 0.8725299057974567}]}
{"symbol_id": "080dd747360fb4703da61456f377ec47e7e78d29", "symbol_name": "unprotect_float", "query_text_overlap": "text unprotect_float sub turns 3_f_14 _f_", "query_text_semantic": "def unprotect_float(text): # Turns <3_f_14> into 3.14 return re.sub(r\"<(\\d+)_f_(\\d+)>\", r\"\\1.\\2\", text)", "best": {"chunk_id": "p-5c1af97004f2", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.5471197460881139, "overlap_score": 0.2451995768135231, "semantic_score": 1.0}, {"chunk_id": "p-0212d69b9ec4", "score": 0.43385337447307815, "overlap_score": 0.7230889574551302, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-5c1af97004f2", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5471197460881139, "overlap": 0.2451995768135231, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.43385337447307815, "overlap": 0.7230889574551302, "semantic": 0.0}, {"chunk_id": "p-88308230dda7", "combined": 0.42737612433034355, "overlap": 0.3564990562106972, "semantic": 0.5336917265098131}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.3281381746262775, "overlap": 0.272645388287741, "semantic": 0.4113773541340823}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.30371813281238697, "overlap": 0.26210895351548846, "semantic": 0.36613190175773475}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.26717724580361457, "overlap": 0.16054217973112325, "semantic": 0.4271298449123515}, {"chunk_id": "p-edce760829b6", "combined": 0.2593118939578876, "overlap": 0.3282284976229973, "semantic": 0.15593698846022322}, {"chunk_id": "p-021b4cb4f328", "combined": 0.20633356317586315, "overlap": 0.0, "semantic": 0.5158339079396579}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.20096135601591938, "overlap": 0.33493559335986567, "semantic": 0.0}]}
{"symbol_id": "2ac5acb3061b97977bf4d92b186f04cafccd70b9", "symbol_name": "protect_float", "query_text_overlap": "protect_float text sub turns 3_f_14 prevent splitting 1_f_", "query_text_semantic": "def protect_float(text): # Turns 3.14 into <3_f_14> to prevent splitting return re.sub(r\"(\\d+)\\.(\\d+)\", r\"<\\1_f_\\2>\", text)", "best": {"chunk_id": "p-88308230dda7", "score": 0.791389723656712, "overlap_score": 1.0, "semantic_score": 0.4784743091417802}, "alternatives": [{"chunk_id": "p-5c1af97004f2", "score": 0.5978092849055364, "overlap_score": 0.996348808175894, "semantic_score": 0.0}, {"chunk_id": "p-62dccf79cb8d", "score": 0.5465825836740323, "overlap_score": 0.2443043061233873, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.791389723656712, "overlap": 1.0, "semantic": 0.4784743091417802}, {"chunk_id": "p-5c1af97004f2", "combined": 0.5978092849055364, "overlap": 0.996348808175894, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5465825836740323, "overlap": 0.2443043061233873, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.4322692925793412, "overlap": 0.7204488209655687, "semantic": 0.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.35704480156611407, "overlap": 0.2716499076751446, "semantic": 0.4851371424025684}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.32879109779019744, "overlap": 0.1599560094370648, "semantic": 0.5820437303198964}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3188965996403808, "overlap": 0.26115194344738774, "semantic": 0.40551358392987036}, {"chunk_id": "p-021b4cb4f328", "combined": 0.2822790815114039, "overlap": 0.0, "semantic": 0.7056977037785097}, {"chunk_id": "p-edce760829b6", "combined": 0.2537462771159078, "overlap": 0.3270300724160376, "semantic": 0.14382058416571308}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.20022760755587282, "overlap": 0.33371267925978804, "semantic": 0.0}]}
{"symbol_id": "ffb881eb8089f46035ae853b8e247d692015f213", "symbol_name": "add_cleaned", "query_text_overlap": "curr add_cleaned segments all append isspace punctuation string strip not", "query_text_semantic": "def add_cleaned(curr, segments): curr = curr.strip() if curr and not all(c.isspace() or c in string.punctuation for c in curr): segments.append(curr)", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.7692200050714575, "overlap_score": 1.0, "semantic_score": 0.42305001267864367}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.6343914931366096, "overlap_score": 0.6177462334190112, "semantic_score": 0.6593593827130072}, {"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.7692200050714575, "overlap": 1.0, "semantic": 0.42305001267864367}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6343914931366096, "overlap": 0.6177462334190112, "semantic": 0.6593593827130072}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.3595003898981019, "overlap": 0.0, "semantic": 0.8987509747452547}, {"chunk_id": "p-021b4cb4f328", "combined": 0.355626383491208, "overlap": 0.5927106391520134, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.29762374395975905, "overlap": 0.0, "semantic": 0.7440593598993975}, {"chunk_id": "p-0d66effb9582", "combined": 0.26144326684530705, "overlap": 0.0, "semantic": 0.6536081671132676}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2247386172408887, "overlap": 0.0, "semantic": 0.5618465431022217}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.16258488530795592, "overlap": 0.0, "semantic": 0.4064622132698898}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.16053216917682614, "overlap": 0.0, "semantic": 0.40133042294206533}]}
{"symbol_id": "5e2fbad42beeae61e10923a0cfa61974548c8228", "symbol_name": "break_text_by_length", "query_text_overlap": "curr text length break_text_by_length char texts utf_8_len yield continue", "query_text_semantic": "def break_text_by_length(texts, length): for text in texts: if utf_8_len(text) <= length: yield text continue curr = \"\" for char in text: curr += char if utf_8_len(curr) >= length: yield curr curr = \"\" if curr: yield curr", "best": {"chunk_id": "p-88308230dda7", "score": 0.9437703077700802, "overlap_score": 1.0, "semantic_score": 0.8594257694252005}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.5110346434847488, "overlap_score": 0.26115194344738774, "semantic_score": 0.8858586935407902}, {"chunk_id": "p-8f7919ad8ffb", "score": 0.4937307441288139, "overlap_score": 0.33371267925978804, "semantic_score": 0.7337578414323527}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9437703077700802, "overlap": 1.0, "semantic": 0.8594257694252005}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5110346434847488, "overlap": 0.26115194344738774, "semantic": 0.8858586935407902}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4937307441288139, "overlap": 0.33371267925978804, "semantic": 0.7337578414323527}, {"chunk_id": "p-edce760829b6", "combined": 0.47939269022960185, "overlap": 0.3270300724160376, "semantic": 0.7079366169499482}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.46276540701874536, "overlap": 0.2716499076751446, "semantic": 0.7494386560341465}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4442359497816871, "overlap": 0.2443043061233873, "semantic": 0.7441334152691368}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3948963936285468, "overlap": 0.658160656047578, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.39134260977150054, "overlap": 0.1599560094370648, "semantic": 0.7384225102731541}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3139536023991678, "overlap": 0.0, "semantic": 0.7848840059979195}]}
{"symbol_id": "a951b812a20e053c00a8cb8697efe607c28332d2", "symbol_name": "break_text", "query_text_overlap": "curr text char break_text length splits texts yield set utf_8_len continue", "query_text_semantic": "def break_text(texts, length, splits: set): for text in texts: if utf_8_len(text) <= length: yield text continue curr = \"\" for char in text: curr += char if char in splits: yield curr curr = \"\" if curr: yield curr", "best": {"chunk_id": "p-88308230dda7", "score": 0.9675968325757948, "overlap_score": 1.0, "semantic_score": 0.918992081439487}, "alternatives": [{"chunk_id": "p-8f7919ad8ffb", "score": 0.6641371444204615, "overlap_score": 0.6239998197653811, "semantic_score": 0.7243431314030819}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.5598097403127473, "overlap_score": 0.3761411476084523, "semantic_score": 0.8353126293691899}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.9675968325757948, "overlap": 1.0, "semantic": 0.918992081439487}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.6641371444204615, "overlap": 0.6239998197653811, "semantic": 0.7243431314030819}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5598097403127473, "overlap": 0.3761411476084523, "semantic": 0.8353126293691899}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5456567493333682, "overlap": 0.26115194344738774, "semantic": 0.9724139581623386}, {"chunk_id": "p-edce760829b6", "combined": 0.5160967822239899, "overlap": 0.3270300724160376, "semantic": 0.7996968469359182}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4891745668550811, "overlap": 0.2716499076751446, "semantic": 0.8154615556249858}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.48703780417533377, "overlap": 0.2443043061233873, "semantic": 0.8511380512532534}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.41291378247786337, "overlap": 0.23332505516045648, "semantic": 0.6822968734539737}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3948963936285468, "overlap": 0.658160656047578, "semantic": 0.0}]}
{"symbol_id": "4c5d7cf0d8342606c6aaca8ab837f48ee7518626", "symbol_name": "utf_8_len", "query_text_overlap": "text utf_8_len encode len utf", "query_text_semantic": "def utf_8_len(text): return len(text.encode(\"utf-8\"))", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.7210135996148512, "overlap_score": 0.9395132680573294, "semantic_score": 0.393264096951134}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.6649367594629811, "overlap_score": 0.7352304275402555, "semantic_score": 0.5594962573470695}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.6199797022474927, "overlap_score": 0.7647857225366755, "semantic_score": 0.40277067181371823}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.7210135996148512, "overlap": 0.9395132680573294, "semantic": 0.393264096951134}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6649367594629811, "overlap": 0.7352304275402555, "semantic": 0.5594962573470695}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.6199797022474927, "overlap": 0.7647857225366755, "semantic": 0.40277067181371823}, {"chunk_id": "p-88308230dda7", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5895498801948813, "overlap": 0.6877986702680241, "semantic": 0.4421766950851671}, {"chunk_id": "p-edce760829b6", "combined": 0.5524196912807676, "overlap": 0.9206994854679461, "semantic": 0.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4333424239118578, "overlap": 0.7222373731864297, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.42847977556146766, "overlap": 0.4503298870901919, "semantic": 0.39570460826838116}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.26340536772474565, "overlap": 0.0, "semantic": 0.6585134193118641}]}
{"symbol_id": "1a12d9cf059a28e6015a4b9c1a4a246e52639578", "symbol_name": "clean_text", "query_text_overlap": "text sub clean_text group replace emoji_regex replace_symbol_regex strip symbols_mapping lambda remove clean xa0 all chinese symbols their english counterparts emojis", "query_text_semantic": "def clean_text(text): # Clean the text text = text.strip() text = text.replace(\"\\xa0\", \"\") # Replace all chinese symbols with their english counterparts text = REPLACE_SYMBOL_REGEX.sub(lambda x: SYMBOLS_MAPPING[x.group()], text) # Remove emojis text = EMOJI_REGEX.sub(r\"\", text) # Remove continuous periods (...) and commas (,,,) text = re.sub(r\"[.,]{2,}\", lambda m: m.group()[0], text) return text", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.7561023643146767, "overlap_score": 1.0, "semantic_score": 0.39025591078669186}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.7001321124781801, "overlap_score": 0.8443539697369662, "semantic_score": 0.48379932659000086}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.7561023643146767, "overlap": 1.0, "semantic": 0.39025591078669186}, {"chunk_id": "p-88308230dda7", "combined": 0.7001321124781801, "overlap": 0.8443539697369662, "semantic": 0.48379932659000086}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-edce760829b6", "combined": 0.3825419680550146, "overlap": 0.27612913986784887, "semantic": 0.5421612103357631}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3374739244209351, "overlap": 0.281771625484561, "semantic": 0.4210273728254963}, {"chunk_id": "p-ae67c9c86886", "combined": 0.33343233759507507, "overlap": 0.5557205626584585, "semantic": 0.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3236182151279342, "overlap": 0.22050468015432553, "semantic": 0.47828851758834723}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3196551318630729, "overlap": 0.2062793106991171, "semantic": 0.48971886360900674}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.27690411770836726, "overlap": 0.1350594915514693, "semantic": 0.4896710569437142}, {"chunk_id": "p-0d66effb9582", "combined": 0.2312010770158738, "overlap": 0.0, "semantic": 0.5780026925396845}]}
{"symbol_id": "7ffa9a5d4ff282fed5a75880f349be6da10586a5", "symbol_name": "Model", "query_text_overlap": "config tokens device backbone_dim dtype model seq_len audio_num_codebooks forward n_codebooks torch audio_mask audio_vocab_size backbone bias bsz decoder_dim linear max_batch_size next", "query_text_semantic": "class Model(nn.Module, PyTorchModelHubMixin): def __init__(self, config: ModelArgs): super().__init__() self.config = config self.backbone, backbone_dim = _prepare_transformer( FLAVORS[config.backbone_flavor]() ) self.decoder, decoder_dim = _prepare_transformer( FLAVORS[config.decoder_flavor]() ) self.text_embeddings = nn.Embedding(config.text_vocab_size, backbone_dim) self.audio_embeddings = nn.Embedding( config.audio_vocab_size * config.audio_num_codebooks, backbone_dim ) self.projection = nn.Linear(backbone_dim, decoder_dim, bias=False) self.text_head = nn.Linear(backbone_dim, config.text_vocab_size, bias=False) self.codebook0_head = nn.Linear( backbone_dim, config.audio_vocab_size, bias=False ) self.audio_head = nn.Parameter( torch.empty( config.audio_num_codebooks - 1, decoder_dim, config.audio_vocab_size ) ) self.decoder_loss_weight = config.decoder_loss_weight self.use_text_loss = config.use_text_loss def setup_caches(self, max_batch_size: int) -> torch.Tensor: \"\"\"Setup KV caches and return a causal mask.\"\"\" dtype = next(self.parameters()).dtype device = next(self.parameters()).device with device: self.backbone.setup_caches(max_batch_size, dtype) self.decoder.setup_caches( max_batch_size, dtype, decoder_max_seq_len=self.config.audio_num_codebooks, ) self.register_buffer( \"backbone_causal_mask\", _create_causal_mask(self.backbone.max_seq_len, device), ) self.register_buffer( \"decoder_causal_mask\", _create_causal_mask(self.config.audio_num_codebooks, device), ) def forward(self, tokens: torch.Tensor, tokens_mask: torch.Tensor): \"\"\" Forward pass for Sesame's CSM", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8038944555748957, "overlap_score": 1.0, "semantic_score": 0.5097361389372393}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.6925520367333049, "overlap_score": 0.48758672788884144, "semantic_score": 1.0}, {"chunk_id": "p-62dccf79cb8d", "score": 0.5346471239994204, "overlap_score": 0.5194175354291962, "semantic_score": 0.5574915068547565}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8038944555748957, "overlap": 1.0, "semantic": 0.5097361389372393}, {"chunk_id": "p-021b4cb4f328", "combined": 0.6925520367333049, "overlap": 0.48758672788884144, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5346471239994204, "overlap": 0.5194175354291962, "semantic": 0.5574915068547565}, {"chunk_id": "p-88308230dda7", "combined": 0.4698110350786648, "overlap": 0.3988149044640724, "semantic": 0.5763052310005533}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.46249796358569645, "overlap": 0.43255916894547797, "semantic": 0.5074061555460242}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.363276988111268, "overlap": 0.19894823722614463, "semantic": 0.609770114438953}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.30364018405152987, "overlap": 0.1029719972517202, "semantic": 0.6046424642512443}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.278610953603783, "overlap": 0.12191426244517252, "semantic": 0.5136559903416987}, {"chunk_id": "p-0d66effb9582", "combined": 0.24581261616328454, "overlap": 0.0, "semantic": 0.6145315404082113}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24035138832238712, "overlap": 0.0, "semantic": 0.6008784708059678}]}
{"symbol_id": "7d5eabee16a54a44cf06e3c8c9b08df15db07295", "symbol_name": "_embed_tokens", "query_text_overlap": "tokens torch config _embed_tokens audio_embeds audio_num_codebooks audio_tokens device size tensor text_embeds arange audio_embeddings audio_vocab_size cat dim reshape text_embeddings unsqueeze view", "query_text_semantic": "def _embed_tokens(self, tokens: torch.Tensor) -> torch.Tensor: text_embeds = self.text_embeddings(tokens[:, :, -1]).unsqueeze(-2) audio_tokens = tokens[:, :, :-1] + ( self.config.audio_vocab_size * torch.arange(self.config.audio_num_codebooks, device=tokens.device) ) audio_embeds = self.audio_embeddings(audio_tokens.view(-1)).reshape( tokens.size(0), tokens.size(1), self.config.audio_num_codebooks, -1 ) return torch.cat([audio_embeds, text_embeds], dim=-2)", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.9581220138435393, "overlap_score": 1.0, "semantic_score": 0.8953050346088485}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.912353377866262, "overlap_score": 0.8870812243914196, "semantic_score": 0.9502616080785257}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.8401483869478436, "overlap_score": 0.8502945593161604, "semantic_score": 0.8249291283953682}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.9581220138435393, "overlap": 1.0, "semantic": 0.8953050346088485}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.912353377866262, "overlap": 0.8870812243914196, "semantic": 0.9502616080785257}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8401483869478436, "overlap": 0.8502945593161604, "semantic": 0.8249291283953682}, {"chunk_id": "p-88308230dda7", "combined": 0.6784343074748114, "overlap": 0.6575256811076372, "semantic": 0.7097972470255726}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3934046519827463, "overlap": 0.0, "semantic": 0.9835116299568657}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3683768420061601, "overlap": 0.0, "semantic": 0.9209421050154002}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3237955776371456, "overlap": 0.0, "semantic": 0.809488944092864}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2388674475891333, "overlap": 0.0, "semantic": 0.5971686189728332}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.23085897996070429, "overlap": 0.0, "semantic": 0.5771474499017607}]}
{"symbol_id": "1a4a583533015cd98d774a990aa55811c2abdc08", "symbol_name": "_embed_audio", "query_text_overlap": "_embed_audio codebook tensor tokens torch audio_embeddings audio_vocab_size config int", "query_text_semantic": "def _embed_audio(self, codebook: int, tokens: torch.Tensor) -> torch.Tensor: return self.audio_embeddings(tokens + codebook * self.config.audio_vocab_size)", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.9366143177316812, "overlap_score": 1.0, "semantic_score": 0.841535794329203}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.8711259060010743, "overlap_score": 0.8870812243914196, "semantic_score": 0.8471929284155564}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.8052430360842675, "overlap_score": 0.8502945593161604, "semantic_score": 0.737665751236428}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.9366143177316812, "overlap": 1.0, "semantic": 0.841535794329203}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.8711259060010743, "overlap": 0.8870812243914196, "semantic": 0.8471929284155564}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8052430360842675, "overlap": 0.8502945593161604, "semantic": 0.737665751236428}, {"chunk_id": "p-88308230dda7", "combined": 0.623132713281575, "overlap": 0.6575256811076372, "semantic": 0.5715432615424818}, {"chunk_id": "p-0d66effb9582", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.39992125356457575, "overlap": 0.0, "semantic": 0.9998031339114394}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.32510399130628115, "overlap": 0.0, "semantic": 0.8127599782657028}, {"chunk_id": "p-021b4cb4f328", "combined": 0.2833916672783975, "overlap": 0.0, "semantic": 0.7084791681959937}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.20936654077305678, "overlap": 0.0, "semantic": 0.5234163519326419}, {"chunk_id": "p-9158b9f667b9", "combined": 0.1967240148178172, "overlap": 0.0, "semantic": 0.491810037044543}]}
{"symbol_id": "5254010b836fd16183f0b6dfb9db79f6774c5343", "symbol_name": "reset_caches", "query_text_overlap": "reset_caches backbone decoder", "query_text_semantic": "def reset_caches(self): self.backbone.reset_caches() self.decoder.reset_caches()", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.8711219092774742, "overlap_score": 0.7852031821291238, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.34222182815480373, "overlap_score": 0.5703697135913396, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.8711219092774742, "overlap": 0.7852031821291238, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.34222182815480373, "overlap": 0.5703697135913396, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.08895763903351828, "overlap": 0.0, "semantic": 0.2223940975837957}, {"chunk_id": "p-edce760829b6", "combined": 0.08823521444564432, "overlap": 0.0, "semantic": 0.2205880361141108}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.07258969531506614, "overlap": 0.0, "semantic": 0.18147423828766532}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.05745673434125162, "overlap": 0.0, "semantic": 0.14364183585312904}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.04590853064141869, "overlap": 0.0, "semantic": 0.11477132660354672}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.04423527517423878, "overlap": 0.0, "semantic": 0.11058818793559695}, {"chunk_id": "p-0d66effb9582", "combined": 0.04186099501912132, "overlap": 0.0, "semantic": 0.10465248754780329}]}
{"symbol_id": "33f362b1965f672e26e6554beacf009ecdcba87b", "symbol_name": "generate_frame", "query_text_overlap": "batch_size torch audio_num_codebooks input_pos tokens seq_len curr_h dtype curr_pos curr_sample mask tensor tokens_mask backbone c0_sample ci_sample decoder dim last_h size", "query_text_semantic": "Args:\n            tokens: (batch_size, seq_len, audio_num_codebooks+1)\n            tokens_mask: (batch_size, seq_len, audio_num_codebooks+1)\n            input_pos: (batch_size, seq_len) positions for each token\n            mask: (batch_size, seq_len, max_seq_len\n\n        Returns:\n            (batch_size, audio_num_codebooks) sampled tokens", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.6180399202438944, "overlap_score": 0.41384451021457486, "semantic_score": 0.9243330352878736}, {"chunk_id": "p-62dccf79cb8d", "score": 0.532357223707953, "overlap_score": 0.30936019507356516, "semantic_score": 0.8668527666595347}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6180399202438944, "overlap": 0.41384451021457486, "semantic": 0.9243330352878736}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.532357223707953, "overlap": 0.30936019507356516, "semantic": 0.8668527666595347}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4001849940171768, "overlap": 0.2630472907400385, "semantic": 0.6058915489328841}, {"chunk_id": "p-88308230dda7", "combined": 0.3727918972666353, "overlap": 0.20341227297333747, "semantic": 0.626861333706582}, {"chunk_id": "p-0d66effb9582", "combined": 0.3587912802550248, "overlap": 0.0, "semantic": 0.896978200637562}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3418330446907027, "overlap": 0.5697217411511711, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2862042141074301, "overlap": 0.0, "semantic": 0.7155105352685752}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2619370410887636, "overlap": 0.0, "semantic": 0.654842602721909}, {"chunk_id": "p-5c1af97004f2", "combined": 0.21612681793044206, "overlap": 0.0, "semantic": 0.5403170448261051}]}
{"symbol_id": "f4d6ab6c91888f0be3030ab04f6a01e2f22ce7ad", "symbol_name": "forward", "query_text_overlap": "seq_len tokens forward tokens_mask bsz model backbone_attn_mask device n_codebooks unsqueeze torch audio_mask dtype backbone embeds input_pos padding_mask batch_size expand masked_embeds", "query_text_semantic": "Forward pass for Sesame's CSM model.\n        This will be added to the model with `model.forward = types.MethodType(forward, model)`\n\n        Args:\n            tokens: (batch_size, seq_len, n_codebooks+1)\n            tokens_mask: (batch_size, seq_len, n_codebooks+1)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.664912410629601, "overlap_score": 0.5194175354291962, "semantic_score": 0.8831547234302082}, {"chunk_id": "p-88308230dda7", "score": 0.5580986865334615, "overlap_score": 0.3988149044640724, "semantic_score": 0.797024359637545}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.664912410629601, "overlap": 0.5194175354291962, "semantic": 0.8831547234302082}, {"chunk_id": "p-88308230dda7", "combined": 0.5580986865334615, "overlap": 0.3988149044640724, "semantic": 0.797024359637545}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5186959336579375, "overlap": 0.48758672788884144, "semantic": 0.5653597423115815}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.471059850715255, "overlap": 0.43255916894547797, "semantic": 0.5288108733699206}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.36368243112893456, "overlap": 0.19894823722614463, "semantic": 0.6107837219831195}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.34039350682318903, "overlap": 0.1029719972517202, "semantic": 0.6965257711803922}, {"chunk_id": "p-0d66effb9582", "combined": 0.32240896764676447, "overlap": 0.0, "semantic": 0.8060224191169111}, {"chunk_id": "p-ae67c9c86886", "combined": 0.29698962062330514, "overlap": 0.0, "semantic": 0.7424740515582628}, {"chunk_id": "p-5c1af97004f2", "combined": 0.281721040825335, "overlap": 0.12151819687801547, "semantic": 0.5220253067463142}]}
{"symbol_id": "96e939417d3524fdc45124d8305524bf8f21fdfa", "symbol_name": "setup_caches", "query_text_overlap": "device dtype setup_caches max_batch_size _create_causal_mask audio_num_codebooks backbone config next parameters register_buffer decoder decoder_max_seq_len int max_seq_len tensor torch setup caches causal", "query_text_semantic": "Setup KV caches and return a causal mask.", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.8711219092774742, "overlap_score": 0.7852031821291238, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.7377665301569675, "overlap_score": 1.0, "semantic_score": 0.3444163253924187}, {"chunk_id": "p-ae67c9c86886", "score": 0.43428370523435356, "overlap_score": 0.5703697135913396, "semantic_score": 0.23015469269887462}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.8711219092774742, "overlap": 0.7852031821291238, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.7377665301569675, "overlap": 1.0, "semantic": 0.3444163253924187}, {"chunk_id": "p-ae67c9c86886", "combined": 0.43428370523435356, "overlap": 0.5703697135913396, "semantic": 0.23015469269887462}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3612007349555582, "overlap": 0.0, "semantic": 0.9030018373888955}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.13906303426629676, "overlap": 0.0, "semantic": 0.3476575856657419}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.11673557372132218, "overlap": 0.0, "semantic": 0.29183893430330543}, {"chunk_id": "p-5c1af97004f2", "combined": 0.11416685616404963, "overlap": 0.0, "semantic": 0.28541714041012406}, {"chunk_id": "p-0d66effb9582", "combined": 0.11106585179212825, "overlap": 0.0, "semantic": 0.2776646294803206}, {"chunk_id": "p-88308230dda7", "combined": 0.10258027431267332, "overlap": 0.0, "semantic": 0.2564506857816833}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.07781067171314304, "overlap": 0.0, "semantic": 0.1945266792828576}]}
{"symbol_id": "610bcfb5fae00fc3a479172e00b7d5ee22b51377", "symbol_name": "__init__", "query_text_overlap": "config backbone_dim __init__ audio_vocab_size bias decoder_dim linear _prepare_transformer audio_num_codebooks decoder_loss_weight embedding flavors text_vocab_size use_text_loss audio_embeddings audio_head backbone backbone_flavor codebook0_head decoder", "query_text_semantic": "def __init__(self, config: ModelArgs): super().__init__() self.config = config self.backbone, backbone_dim = _prepare_transformer( FLAVORS[config.backbone_flavor]() ) self.decoder, decoder_dim = _prepare_transformer( FLAVORS[config.decoder_flavor]() ) self.text_embeddings = nn.Embedding(config.text_vocab_size, backbone_dim) self.audio_embeddings = nn.Embedding( config.audio_vocab_size * config.audio_num_codebooks, backbone_dim ) self.projection = nn.Linear(backbone_dim, decoder_dim, bias=False) self.text_head = nn.Linear(backbone_dim, config.text_vocab_size, bias=False) self.codebook0_head = nn.Linear( backbone_dim, config.audio_vocab_size, bias=False ) self.audio_head = nn.Parameter( torch.empty( config.audio_num_codebooks - 1, decoder_dim, config.audio_vocab_size ) ) self.decoder_loss_weight = config.decoder_loss_weight self.use_text_loss = config.use_text_loss", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.8711219092774742, "overlap_score": 0.7852031821291238, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.792456636665853, "overlap_score": 1.0, "semantic_score": 0.48114159166463233}, {"chunk_id": "p-ae67c9c86886", "score": 0.5807753554991973, "overlap_score": 0.5703697135913396, "semantic_score": 0.5963838183609841}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.8711219092774742, "overlap": 0.7852031821291238, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.792456636665853, "overlap": 1.0, "semantic": 0.48114159166463233}, {"chunk_id": "p-ae67c9c86886", "combined": 0.5807753554991973, "overlap": 0.5703697135913396, "semantic": 0.5963838183609841}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24069394201828356, "overlap": 0.0, "semantic": 0.6017348550457089}, {"chunk_id": "p-88308230dda7", "combined": 0.2218191709024156, "overlap": 0.0, "semantic": 0.554547927256039}, {"chunk_id": "p-0d66effb9582", "combined": 0.21980488331421721, "overlap": 0.0, "semantic": 0.549512208285543}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.21332785286221775, "overlap": 0.0, "semantic": 0.5333196321555443}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.21290891135326057, "overlap": 0.0, "semantic": 0.5322722783831514}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.19572558995186598, "overlap": 0.0, "semantic": 0.48931397487966494}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.18704320839169739, "overlap": 0.0, "semantic": 0.4676080209792434}]}
{"symbol_id": "6c1eb2d3fa2559247ca190a61091fbdb218afe1b", "symbol_name": "ModelArgs", "query_text_overlap": "int modelargs str audio_num_codebooks audio_vocab_size backbone_flavor bool decoder_flavor decoder_loss_weight float text_vocab_size use_text_loss", "query_text_semantic": "class ModelArgs: backbone_flavor: str decoder_flavor: str text_vocab_size: int audio_vocab_size: int audio_num_codebooks: int decoder_loss_weight: float use_text_loss: bool", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.24093733962778296, "overlap_score": 0.0, "semantic_score": 0.6023433490694574}, {"chunk_id": "p-ebeeda9fc683", "score": 0.23960438435495557, "overlap_score": 0.0, "semantic_score": 0.5990109608873889}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.24093733962778296, "overlap": 0.0, "semantic": 0.6023433490694574}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23960438435495557, "overlap": 0.0, "semantic": 0.5990109608873889}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.23764770816338432, "overlap": 0.0, "semantic": 0.5941192704084608}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.23585430928605988, "overlap": 0.0, "semantic": 0.5896357732151497}, {"chunk_id": "p-ae67c9c86886", "combined": 0.22538510047552449, "overlap": 0.0, "semantic": 0.5634627511888112}, {"chunk_id": "p-88308230dda7", "combined": 0.19597880093843814, "overlap": 0.0, "semantic": 0.48994700234609534}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1948986295674935, "overlap": 0.0, "semantic": 0.48724657391873366}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.17739216062131558, "overlap": 0.0, "semantic": 0.4434804015532889}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17482772033697472, "overlap": 0.0, "semantic": 0.4370693008424368}]}
{"symbol_id": "70efecca7694d37f0b7ea2d6be9a4017570fa992", "symbol_name": "sample_top_nsigma", "query_text_overlap": "logits float _description_ torch dim temperature tensor functional keepdim probs sample_token sample_top_nsigma threshold _multinomial_sample_one_no_sync max softmax std values _summary_ returns", "query_text_semantic": "_summary_\n\n    Args:\n        logits (torch.Tensor): _description_\n        n (float): _description_\n        temperature (float): _description_\n\n    Returns:\n        _type_: _description_", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.2706671446312745, "overlap_score": 0.0, "semantic_score": 0.6766678615781863}, {"chunk_id": "p-ae67c9c86886", "score": 0.26932368148652336, "overlap_score": 0.0, "semantic_score": 0.6733092037163084}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2706671446312745, "overlap": 0.0, "semantic": 0.6766678615781863}, {"chunk_id": "p-ae67c9c86886", "combined": 0.26932368148652336, "overlap": 0.0, "semantic": 0.6733092037163084}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.26577694638005106, "overlap": 0.0, "semantic": 0.6644423659501276}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.249202581177675, "overlap": 0.0, "semantic": 0.6230064529441874}, {"chunk_id": "p-edce760829b6", "combined": 0.24614011227245164, "overlap": 0.0, "semantic": 0.6153502806811291}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.24257035806413363, "overlap": 0.0, "semantic": 0.6064258951603341}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2295863608762197, "overlap": 0.0, "semantic": 0.5739659021905492}, {"chunk_id": "p-0d66effb9582", "combined": 0.22139067445757418, "overlap": 0.0, "semantic": 0.5534766861439354}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.21608210244787368, "overlap": 0.0, "semantic": 0.5402052561196842}]}
{"symbol_id": "5e233f03221b229f1ff616608e60c6f5b8e13fa2", "symbol_name": "sample_topk", "query_text_overlap": "logits scores_processed torch float topk dim filter_value functional indices_to_remove probs sample_token sample_topk temperature _multinomial_sample_one_no_sync int log_softmax masked_fill softmax tensor inf", "query_text_semantic": "def sample_topk(logits: torch.Tensor, topk: int, temperature: float): logits = logits / temperature filter_value: float = -float(\"Inf\") indices_to_remove = logits < torch.topk(logits, topk)[0][..., -1, None] scores_processed = logits.masked_fill(indices_to_remove, filter_value) scores_processed = torch.nn.functional.log_softmax(scores_processed, dim=-1) probs = torch.nn.functional.softmax(scores_processed, dim=-1) sample_token = _multinomial_sample_one_no_sync(probs) return sample_token", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.21408727626603063, "overlap_score": 0.0, "semantic_score": 0.5352181906650766}, {"chunk_id": "p-0d66effb9582", "score": 0.21303229083217146, "overlap_score": 0.0, "semantic_score": 0.5325807270804286}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.21408727626603063, "overlap": 0.0, "semantic": 0.5352181906650766}, {"chunk_id": "p-0d66effb9582", "combined": 0.21303229083217146, "overlap": 0.0, "semantic": 0.5325807270804286}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.20954016529414043, "overlap": 0.0, "semantic": 0.5238504132353511}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.19182235565221695, "overlap": 0.0, "semantic": 0.47955588913054237}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18697851763202614, "overlap": 0.0, "semantic": 0.4674462940800653}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.18310125379176295, "overlap": 0.0, "semantic": 0.45775313447940735}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.17500974001280556, "overlap": 0.0, "semantic": 0.4375243500320139}, {"chunk_id": "p-edce760829b6", "combined": 0.16454469741208677, "overlap": 0.0, "semantic": 0.41136174353021693}, {"chunk_id": "p-ae67c9c86886", "combined": 0.16352334712552863, "overlap": 0.0, "semantic": 0.4088083678138215}]}
{"symbol_id": "c3f9d7b03cb8f955a7b2cbfb2f0b01a7879327b9", "symbol_name": "_multinomial_sample_one_no_sync", "query_text_overlap": "probs torch _multinomial_sample_one_no_sync argmax dim dtype empty_like exponential_ int keepdim does multinomial sampling without cuda synchronization", "query_text_semantic": "Does multinomial sampling without a cuda synchronization", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8335037286242358, "overlap_score": 0.7741123656645355, "semantic_score": 0.9225907730637863}, "alternatives": [{"chunk_id": "p-edce760829b6", "score": 0.7397066846506801, "overlap_score": 1.0, "semantic_score": 0.3492667116267002}, {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8335037286242358, "overlap": 0.7741123656645355, "semantic": 0.9225907730637863}, {"chunk_id": "p-edce760829b6", "combined": 0.7397066846506801, "overlap": 1.0, "semantic": 0.3492667116267002}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.33684077128671, "overlap": 0.0, "semantic": 0.8421019282167749}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23455431811800498, "overlap": 0.0, "semantic": 0.5863857952950124}, {"chunk_id": "p-88308230dda7", "combined": 0.20250274558307654, "overlap": 0.0, "semantic": 0.5062568639576913}, {"chunk_id": "p-9158b9f667b9", "combined": 0.16951942966509218, "overlap": 0.0, "semantic": 0.4237985741627304}, {"chunk_id": "p-0d66effb9582", "combined": 0.16791106443323703, "overlap": 0.0, "semantic": 0.41977766108309256}, {"chunk_id": "p-ae67c9c86886", "combined": 0.16067945184300597, "overlap": 0.0, "semantic": 0.4016986296075149}, {"chunk_id": "p-5c1af97004f2", "combined": 0.10873921758879163, "overlap": 0.0, "semantic": 0.27184804397197904}]}
{"symbol_id": "77bb2a258e5a005f3d456c0835cd6021a03e6708", "symbol_name": "_index_causal_mask", "query_text_overlap": "max_seq_len input_pos mask batch_size seq_len _index_causal_mask tensor torch returns", "query_text_semantic": "Args:\n        mask: (max_seq_len, max_seq_len)\n        input_pos: (batch_size, seq_len)\n\n    Returns:\n        (batch_size, seq_len, max_seq_len)", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.39392553418911247, "overlap_score": 0.0, "semantic_score": 0.9848138354727811}, {"chunk_id": "p-ae67c9c86886", "score": 0.38706376505496265, "overlap_score": 0.0, "semantic_score": 0.9676594126374065}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.39392553418911247, "overlap": 0.0, "semantic": 0.9848138354727811}, {"chunk_id": "p-ae67c9c86886", "combined": 0.38706376505496265, "overlap": 0.0, "semantic": 0.9676594126374065}, {"chunk_id": "p-021b4cb4f328", "combined": 0.359166993142329, "overlap": 0.0, "semantic": 0.8979174828558225}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3511427259846185, "overlap": 0.0, "semantic": 0.8778568149615462}, {"chunk_id": "p-5c1af97004f2", "combined": 0.34437154428952016, "overlap": 0.0, "semantic": 0.8609288607238004}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2982227796520182, "overlap": 0.0, "semantic": 0.7455569491300456}, {"chunk_id": "p-0d66effb9582", "combined": 0.28846851260746553, "overlap": 0.0, "semantic": 0.7211712815186638}, {"chunk_id": "p-88308230dda7", "combined": 0.28495168924777253, "overlap": 0.0, "semantic": 0.7123792231194314}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2121024451574408, "overlap": 0.0, "semantic": 0.530256112893602}]}
{"symbol_id": "3dab486b0b26c0b5b9041b5f176784060a0a8a40", "symbol_name": "_create_causal_mask", "query_text_overlap": "device torch seq_len _create_causal_mask bool dtype int ones tril", "query_text_semantic": "def _create_causal_mask(seq_len: int, device: torch.device): return torch.tril(torch.ones(seq_len, seq_len, dtype=torch.bool, device=device))", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.9534882955828298, "overlap_score": 1.0, "semantic_score": 0.8837207389570745}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-62dccf79cb8d", "score": 0.3516494886286052, "overlap_score": 0.0, "semantic_score": 0.8791237215715129}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.9534882955828298, "overlap": 1.0, "semantic": 0.8837207389570745}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3516494886286052, "overlap": 0.0, "semantic": 0.8791237215715129}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3097424557392093, "overlap": 0.0, "semantic": 0.7743561393480232}, {"chunk_id": "p-0d66effb9582", "combined": 0.27364990205299705, "overlap": 0.0, "semantic": 0.6841247551324926}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2525488587313075, "overlap": 0.0, "semantic": 0.6313721468282687}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.24328125355378383, "overlap": 0.0, "semantic": 0.6082031338844596}, {"chunk_id": "p-5c1af97004f2", "combined": 0.20773800206913623, "overlap": 0.0, "semantic": 0.5193450051728405}, {"chunk_id": "p-88308230dda7", "combined": 0.20356248285266526, "overlap": 0.0, "semantic": 0.5089062071316631}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.20165136439700926, "overlap": 0.0, "semantic": 0.5041284109925231}]}
{"symbol_id": "7c0329252ce0979d9044d67ed5cdee5330382ede", "symbol_name": "_prepare_transformer", "query_text_overlap": "model _prepare_transformer embed_dim identity tok_embeddings embedding_dim output", "query_text_semantic": "def _prepare_transformer(model): embed_dim = model.tok_embeddings.embedding_dim model.tok_embeddings = nn.Identity() model.output = nn.Identity() return model, embed_dim", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.897389770723104, "overlap_score": 0.8289829512051734, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.7991899162127869, "overlap_score": 1.0, "semantic_score": 0.4979747905319672}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.7246752487081419, "overlap_score": 0.8496625692938057, "semantic_score": 0.5371942678296463}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.897389770723104, "overlap": 0.8289829512051734, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.7991899162127869, "overlap": 1.0, "semantic": 0.4979747905319672}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.7246752487081419, "overlap": 0.8496625692938057, "semantic": 0.5371942678296463}, {"chunk_id": "p-88308230dda7", "combined": 0.6838604207446646, "overlap": 0.7695372189478279, "semantic": 0.5553452234399198}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.6227833822635374, "overlap": 0.7324433825057135, "semantic": 0.45829338190027324}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5528481217791008, "overlap": 0.5770584383696186, "semantic": 0.516532646893324}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.503130327870933, "overlap": 0.6127938811872581, "semantic": 0.33863499789644547}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3977415732132909, "overlap": 0.5175818528850388, "semantic": 0.21798115370566915}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3863640515115535, "overlap": 0.6439400858525892, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3664818504721476, "overlap": 0.610803084120246, "semantic": 0.0}]}
{"symbol_id": "0ccf445fd02a4d00de291c974780ecf9b1623eed", "symbol_name": "read_jsonl", "query_text_overlap": "path data_list data json_str line read_jsonl append expanduser json loads open read splitlines", "query_text_semantic": "def read_jsonl(path): path = os.path.expanduser(path) with open(path, \"r\") as f: json_str = f.read() data_list = [] for line in json_str.splitlines(): data = json.loads(line) data_list.append(data) return data_list", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8581024928722278, "overlap_score": 1.0, "semantic_score": 0.6452562321805695}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.47300514274069055, "overlap_score": 0.7191476864843699, "semantic_score": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8581024928722278, "overlap": 1.0, "semantic": 0.6452562321805695}, {"chunk_id": "p-021b4cb4f328", "combined": 0.47300514274069055, "overlap": 0.7191476864843699, "semantic": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.27378057714036874, "overlap": 0.0, "semantic": 0.6844514428509219}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25385857994541333, "overlap": 0.0, "semantic": 0.6346464498635334}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.13749994055422562, "overlap": 0.0, "semantic": 0.3437498513855641}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11499095877030124, "overlap": 0.0, "semantic": 0.2874773969257531}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.0927525124669479, "overlap": 0.0, "semantic": 0.23188128116736975}, {"chunk_id": "p-88308230dda7", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}, {"chunk_id": "p-9158b9f667b9", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}]}
{"symbol_id": "b9d25ae766c0866ddc37fad445f246e596ccbe90", "symbol_name": "get_grad_norm", "query_text_overlap": "total_norm num get_grad_norm model name param_norm data grad item named_parameters norm print try except", "query_text_semantic": "def get_grad_norm(model): total_norm = 0 num = 0 for name, p in model.named_parameters(): try: param_norm = p.grad.data.norm(2) total_norm += param_norm.item() ** 2 num += 1 except: print(name) total_norm = total_norm ** (1.0 / 2) total_norm = total_norm / num return total_norm", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.7853087435908994, "overlap_score": 0.9174454484175721, "semantic_score": 0.5871036863508904}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.6625540777384245, "overlap_score": 1.0, "semantic_score": 0.1563851943460612}, {"chunk_id": "p-0212d69b9ec4", "score": 0.5376366649623097, "overlap_score": 0.22939444160384945, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.7853087435908994, "overlap": 0.9174454484175721, "semantic": 0.5871036863508904}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6625540777384245, "overlap": 1.0, "semantic": 0.1563851943460612}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.5376366649623097, "overlap": 0.22939444160384945, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.32428373504771524, "overlap": 0.0, "semantic": 0.8107093376192881}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3005813172801067, "overlap": 0.31806432247205235, "semantic": 0.2743568094921882}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2887823824728647, "overlap": 0.27418426634875237, "semantic": 0.31067955665903313}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.25437498690070703, "overlap": 0.24105377183971963, "semantic": 0.2743568094921882}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.23935302406892095, "overlap": 0.21601716712007615, "semantic": 0.2743568094921882}, {"chunk_id": "p-88308230dda7", "combined": 0.23544845217979868, "overlap": 0.2880700445179099, "semantic": 0.15651606367263182}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.22460515548171825, "overlap": 0.37434192580286374, "semantic": 0.0}]}
{"symbol_id": "4e81ada5cfab9c033373d199ac8e84b75f992dca", "symbol_name": "summarize", "query_text_overlap": "global_step writer items audio_sampling_rate audios histograms images scalars summarize add_audio add_histogram add_image add_scalar dataformats 22050 hwc", "query_text_semantic": "def summarize( writer, global_step, scalars={}, histograms={}, images={}, audios={}, audio_sampling_rate=22050, ): for k, v in scalars.items(): writer.add_scalar(k, v, global_step) for k, v in histograms.items(): writer.add_histogram(k, v, global_step) for k, v in images.items(): writer.add_image(k, v, global_step, dataformats=\"HWC\") for k, v in audios.items(): writer.add_audio(k, v, global_step, audio_sampling_rate)", "best": {"chunk_id": "p-0212d69b9ec4", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.39056024269795653, "overlap_score": 0.0, "semantic_score": 0.9764006067448913}, {"chunk_id": "p-0d66effb9582", "score": 0.3593671119808252, "overlap_score": 0.0, "semantic_score": 0.898417779952063}], "topk_raw": [{"chunk_id": "p-0212d69b9ec4", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.39056024269795653, "overlap": 0.0, "semantic": 0.9764006067448913}, {"chunk_id": "p-0d66effb9582", "combined": 0.3593671119808252, "overlap": 0.0, "semantic": 0.898417779952063}, {"chunk_id": "p-ae67c9c86886", "combined": 0.34221984509212294, "overlap": 0.0, "semantic": 0.8555496127303073}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3409272457987988, "overlap": 0.0, "semantic": 0.8523181144969969}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3311949384231494, "overlap": 0.0, "semantic": 0.8279873460578734}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3148217276717731, "overlap": 0.0, "semantic": 0.7870543191794327}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2816654640151656, "overlap": 0.0, "semantic": 0.7041636600379141}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2557968925951171, "overlap": 0.0, "semantic": 0.6394922314877928}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2545859324079032, "overlap": 0.0, "semantic": 0.636464831019758}]}
{"symbol_id": "a98f55993f3fb1e554f7e0741e5978834ae4bc3e", "symbol_name": "load_llm_model", "query_text_overlap": "model device configs llm_models checkpoint_path decoder_loss_weight path load move audio_num_codebooks audio_vocab_size backbone_flavor decoder_flavor load_llm_model model_arg state_dict str text_vocab_size torch union", "query_text_semantic": "Load model, add forward method, and move to device.\n\n    Args:\n        model_name_or_checkpoint_path: Name or path of pretrained model or checkpoint.\n        device: Device to move the model to.\n        decoder_loss_weight: Decoder loss weight.", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.8611107455517111, "overlap_score": 0.8289829512051734, "semantic_score": 0.9093024370715175}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.8394660295034282, "overlap_score": 0.7324433825057135, "semantic_score": 1.0}, {"chunk_id": "p-ebeeda9fc683", "score": 0.826145464540608, "overlap_score": 1.0, "semantic_score": 0.5653636613515199}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.8611107455517111, "overlap": 0.8289829512051734, "semantic": 0.9093024370715175}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.8394660295034282, "overlap": 0.7324433825057135, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.826145464540608, "overlap": 1.0, "semantic": 0.5653636613515199}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.7861133206841262, "overlap": 0.8496625692938057, "semantic": 0.6907894477696069}, {"chunk_id": "p-88308230dda7", "combined": 0.7591238176857431, "overlap": 0.7695372189478279, "semantic": 0.7435037157926158}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.6603226901508057, "overlap": 0.5175818528850388, "semantic": 0.8744339460494562}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.563490371355267, "overlap": 0.5770584383696186, "semantic": 0.5431382708337397}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3863640515115535, "overlap": 0.6439400858525892, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.36767632871235484, "overlap": 0.6127938811872581, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3664818504721476, "overlap": 0.610803084120246, "semantic": 0.0}]}
{"symbol_id": "1ffc701cef908235286acb66ad683de3f73778d0", "symbol_name": "load_model", "query_text_overlap": "model device configs models checkpoint_path decoder_loss_weight path load move audio_num_codebooks audio_vocab_size backbone_flavor decoder_flavor load_model model_arg state_dict str text_vocab_size torch union", "query_text_semantic": "Load model, add forward method, and move to device.\n\n    Args:\n        model_name_or_checkpoint_path: Name or path of pretrained model or checkpoint.\n        device: Device to move the model to.\n        decoder_loss_weight: Decoder loss weight.", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.8611107455517111, "overlap_score": 0.8289829512051734, "semantic_score": 0.9093024370715175}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.8394660295034282, "overlap_score": 0.7324433825057135, "semantic_score": 1.0}, {"chunk_id": "p-ebeeda9fc683", "score": 0.826145464540608, "overlap_score": 1.0, "semantic_score": 0.5653636613515199}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.8611107455517111, "overlap": 0.8289829512051734, "semantic": 0.9093024370715175}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.8394660295034282, "overlap": 0.7324433825057135, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.826145464540608, "overlap": 1.0, "semantic": 0.5653636613515199}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.7861133206841262, "overlap": 0.8496625692938057, "semantic": 0.6907894477696069}, {"chunk_id": "p-88308230dda7", "combined": 0.7591238176857431, "overlap": 0.7695372189478279, "semantic": 0.7435037157926158}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.6603226901508057, "overlap": 0.5175818528850388, "semantic": 0.8744339460494562}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.563490371355267, "overlap": 0.5770584383696186, "semantic": 0.5431382708337397}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3863640515115535, "overlap": 0.6439400858525892, "semantic": 0.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.36767632871235484, "overlap": 0.6127938811872581, "semantic": 0.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3664818504721476, "overlap": 0.610803084120246, "semantic": 0.0}]}
{"symbol_id": "5afec1a76c1bebdb2d8edcaaff6364fd52679cf7", "symbol_name": "init_weights", "query_text_overlap": "model init initialization isinstance linear xavier_uniform_ xavier uniform _init_weights audio_head bias init_weights parameter weight apply data embedding mean module normal_", "query_text_semantic": "Initialize the weights of the model.\n    - Xavier uniform initialization for linear layers\n    - Normal initialization for embeddings\n    - Xavier uniform initialization for parameters", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.913411386918036, "overlap_score": 1.0, "semantic_score": 0.78352846729509}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.8948052094567263, "overlap_score": 0.8246753490945437, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.8787203033010852, "overlap_score": 0.8988821629852324, "semantic_score": 0.8484775137748646}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.913411386918036, "overlap": 1.0, "semantic": 0.78352846729509}, {"chunk_id": "p-021b4cb4f328", "combined": 0.8948052094567263, "overlap": 0.8246753490945437, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.8787203033010852, "overlap": 0.8988821629852324, "semantic": 0.8484775137748646}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6863539189190973, "overlap": 0.8341406500834355, "semantic": 0.4646738221725898}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4918645665599085, "overlap": 0.24645934639208555, "semantic": 0.859972396811643}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.4907717123250033, "overlap": 0.28590234615211085, "semantic": 0.798075761584342}, {"chunk_id": "p-88308230dda7", "combined": 0.4301412744565384, "overlap": 0.258941024707511, "semantic": 0.6869416490800795}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2789329750546403, "overlap": 0.20552868997402893, "semantic": 0.3890394026755574}, {"chunk_id": "p-0d66effb9582", "combined": 0.25486910551702063, "overlap": 0.0, "semantic": 0.6371727637925516}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.24485195077469327, "overlap": 0.0, "semantic": 0.6121298769367332}]}
{"symbol_id": "6861cf779ee955cf8b3daef7de54ecda54ce7cdf", "symbol_name": "_init_weights", "query_text_overlap": "init isinstance _init_weights bias weight xavier_uniform_ data embedding linear mean normal_ parameter std zeros_ elif not", "query_text_semantic": "def _init_weights(m): if isinstance(m, nn.Linear): nn.init.xavier_uniform_(m.weight) if m.bias is not None: nn.init.zeros_(m.bias) elif isinstance(m, nn.Embedding): nn.init.normal_(m.weight, mean=0.0, std=0.02) elif isinstance(m, nn.Parameter): nn.init.xavier_uniform_(m.data)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.7964922733603894, "overlap_score": 0.660820455600649, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.7776981240787013, "overlap_score": 1.0, "semantic_score": 0.4442453101967532}, {"chunk_id": "p-ae67c9c86886", "score": 0.7089796834859738, "overlap_score": 0.9188939462923675, "semantic_score": 0.39410828927638325}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.7964922733603894, "overlap": 0.660820455600649, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.7776981240787013, "overlap": 1.0, "semantic": 0.4442453101967532}, {"chunk_id": "p-ae67c9c86886", "combined": 0.7089796834859738, "overlap": 0.9188939462923675, "semantic": 0.39410828927638325}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6628744358855697, "overlap": 0.7603684063633829, "semantic": 0.51663348016885}, {"chunk_id": "p-0d66effb9582", "combined": 0.2613386056314379, "overlap": 0.0, "semantic": 0.6533465140785948}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.17623336282862734, "overlap": 0.0, "semantic": 0.4405834070715683}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.13370259106486024, "overlap": 0.0, "semantic": 0.33425647766215055}, {"chunk_id": "p-88308230dda7", "combined": 0.10741967453997586, "overlap": 0.0, "semantic": 0.26854918634993963}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.1002591625694304, "overlap": 0.0, "semantic": 0.250647906423576}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.09160379888398598, "overlap": 0.0, "semantic": 0.22900949720996494}]}
{"symbol_id": "fca285a82fba052d22447cf63401b40a59dbff3f", "symbol_name": "load_custom_tokenizer", "query_text_overlap": "tok additional_special_tokens load_custom_tokenizer qwen2_tokenizer_path special_tokens_dict add_special_tokens autotokenizer from_pretrained str", "query_text_semantic": "def load_custom_tokenizer(qwen2_tokenizer_path: str): tok = AutoTokenizer.from_pretrained(qwen2_tokenizer_path) special_tokens_dict = { \"additional_special_tokens\": additional_special_tokens, } tok.add_special_tokens(special_tokens_dict) return tok", "best": {"chunk_id": "p-0d66effb9582", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.39410277225618007, "overlap_score": 0.0, "semantic_score": 0.9852569306404501}, {"chunk_id": "p-62dccf79cb8d", "score": 0.376688064888169, "overlap_score": 0.0, "semantic_score": 0.9417201622204225}], "topk_raw": [{"chunk_id": "p-0d66effb9582", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.39410277225618007, "overlap": 0.0, "semantic": 0.9852569306404501}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.376688064888169, "overlap": 0.0, "semantic": 0.9417201622204225}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3509335689673966, "overlap": 0.0, "semantic": 0.8773339224184914}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2840720098523331, "overlap": 0.0, "semantic": 0.7101800246308327}, {"chunk_id": "p-021b4cb4f328", "combined": 0.22886570194291617, "overlap": 0.0, "semantic": 0.5721642548572904}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2240030388740058, "overlap": 0.0, "semantic": 0.5600075971850145}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1937441324620707, "overlap": 0.0, "semantic": 0.48436033115517674}, {"chunk_id": "p-88308230dda7", "combined": 0.1600208787062172, "overlap": 0.0, "semantic": 0.400052196765543}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.14093506168647052, "overlap": 0.0, "semantic": 0.3523376542161763}]}
{"symbol_id": "6c75e647e0021eb2a209a1f970b8f87819c254a6", "symbol_name": "WarmupDecayLR", "query_text_overlap": "warmup_steps decay_type total_steps step int torch linear __init__ lr_lambda optimizer warmupdecaylr decay elif cos float lambdalr last_epoch str super tensor", "query_text_semantic": "Learning rate scheduler with a linear warmup and specificable decay.", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8926784682266501, "overlap_score": 1.0, "semantic_score": 0.7316961705666253}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-5c1af97004f2", "score": 0.2219495049565583, "overlap_score": 0.0, "semantic_score": 0.5548737623913957}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8926784682266501, "overlap": 1.0, "semantic": 0.7316961705666253}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2219495049565583, "overlap": 0.0, "semantic": 0.5548737623913957}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.21096982594531624, "overlap": 0.0, "semantic": 0.5274245648632906}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.20635396618350998, "overlap": 0.0, "semantic": 0.5158849154587749}, {"chunk_id": "p-ae67c9c86886", "combined": 0.19901273741844372, "overlap": 0.0, "semantic": 0.4975318435461093}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.19813352951719887, "overlap": 0.0, "semantic": 0.4953338237929971}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17804309153379425, "overlap": 0.0, "semantic": 0.44510772883448557}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.16865090779367461, "overlap": 0.0, "semantic": 0.4216272694841865}, {"chunk_id": "p-0d66effb9582", "combined": 0.1602202297336464, "overlap": 0.0, "semantic": 0.400550574334116}]}
{"symbol_id": "b0703a2949eb4871ee15e13ba57a40f219144dd6", "symbol_name": "lr_lambda", "query_text_overlap": "warmup_steps step decay_type total_steps torch lr_lambda elif cos float int tensor valueerror else linear constant exponential cosine raise invalid decay", "query_text_semantic": "def lr_lambda(self, step: int) -> float: if step < self.warmup_steps: return step / self.warmup_steps else: if self.decay_type == \"linear\": return (self.total_steps - step) / ( self.total_steps - self.warmup_steps ) elif self.decay_type == \"constant\": return 1.0 elif self.decay_type == \"exponential\": return 0.1 ** ( (step - self.warmup_steps) / (self.total_steps - self.warmup_steps) ) elif self.decay_type == \"cosine\": return 0.5 * ( 1 + torch.cos( torch.pi * torch.tensor( (step - self.warmup_steps) / (self.total_steps - self.warmup_steps) ) ) ) else: raise ValueError(f\"Invalid decay type: {self.decay_type}\")", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-3c728ae39fa1", "score": 0.17532611853910016, "overlap_score": 0.0, "semantic_score": 0.43831529634775035}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.17532611853910016, "overlap": 0.0, "semantic": 0.43831529634775035}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.11007281422202692, "overlap": 0.0, "semantic": 0.27518203555506726}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10803599498834121, "overlap": 0.0, "semantic": 0.270089987470853}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1051391785477353, "overlap": 0.0, "semantic": 0.2628479463693382}, {"chunk_id": "p-0d66effb9582", "combined": 0.09976152923103603, "overlap": 0.0, "semantic": 0.24940382307759004}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.08541941755241052, "overlap": 0.0, "semantic": 0.2135485438810263}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.07896571549724653, "overlap": 0.0, "semantic": 0.1974142887431163}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.07199164238165427, "overlap": 0.0, "semantic": 0.1799791059541357}]}
{"symbol_id": "256a1d8d12ed41ca25984be80d56d2beb5595e99", "symbol_name": "__init__", "query_text_overlap": "__init__ decay_type total_steps warmup_steps int optimizer last_epoch lr_lambda str super linear", "query_text_semantic": "def __init__( self, optimizer, warmup_steps: int, total_steps: int, decay_type: str = \"linear\" ): self.warmup_steps = warmup_steps self.total_steps = total_steps self.decay_type = decay_type super().__init__(optimizer, self.lr_lambda, last_epoch=-1)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.2278531845642895, "overlap_score": 0.0, "semantic_score": 0.5696329614107237}, {"chunk_id": "p-62dccf79cb8d", "score": 0.13762410119538343, "overlap_score": 0.0, "semantic_score": 0.34406025298845855}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2278531845642895, "overlap": 0.0, "semantic": 0.5696329614107237}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.13762410119538343, "overlap": 0.0, "semantic": 0.34406025298845855}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.13291224460830048, "overlap": 0.0, "semantic": 0.33228061152075117}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.13074733462387222, "overlap": 0.0, "semantic": 0.32686833655968056}, {"chunk_id": "p-0d66effb9582", "combined": 0.1219587625653753, "overlap": 0.0, "semantic": 0.30489690641343825}, {"chunk_id": "p-ae67c9c86886", "combined": 0.11818069686307076, "overlap": 0.0, "semantic": 0.2954517421576769}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.11195602598111165, "overlap": 0.0, "semantic": 0.2798900649527791}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11103870617476341, "overlap": 0.0, "semantic": 0.27759676543690853}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10174364576845317, "overlap": 0.0, "semantic": 0.2543591144211329}]}
{"symbol_id": "dd1f286c9840556cef11d4f860d93eb1faa9af59", "symbol_name": "Segment", "query_text_overlap": "segment str audio speaker tensor text torch", "query_text_semantic": "class Segment: speaker: str text: str audio: torch.Tensor", "best": {"chunk_id": "p-88308230dda7", "score": 0.705011192711561, "overlap_score": 0.5888189218807022, "semantic_score": 0.8792995989578493}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.6195305190811394, "overlap_score": 0.37491311155671186, "semantic_score": 0.9864566303677806}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.6180196366571507, "overlap_score": 0.49200633261555615, "semantic_score": 0.8070395927195425}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.705011192711561, "overlap": 0.5888189218807022, "semantic": 0.8792995989578493}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6195305190811394, "overlap": 0.37491311155671186, "semantic": 0.9864566303677806}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.6180196366571507, "overlap": 0.49200633261555615, "semantic": 0.8070395927195425}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5760549728870392, "overlap": 0.3507264252616029, "semantic": 0.9140477943251937}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5738252817896696, "overlap": 0.2897088029827826, "semantic": 1.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4857966164343072, "overlap": 0.36828761531233667, "semantic": 0.6620601181172631}, {"chunk_id": "p-0d66effb9582", "combined": 0.39878845968393994, "overlap": 0.10928065477414986, "semantic": 0.8330501670486251}, {"chunk_id": "p-ae67c9c86886", "combined": 0.382125369437201, "overlap": 0.0, "semantic": 0.9553134235930024}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3180553361757355, "overlap": 0.0, "semantic": 0.7951383404393387}]}
{"symbol_id": "bfee7545bd86eafc9b45f076cbcf485caff787c0", "symbol_name": "qwen2_7B", "query_text_overlap": "qwen2_7b attn_dropout embed_dim intermediate_dim max_seq_len norm_eps num_heads num_kv_heads num_layers qwen2 rope_base transformerdecoder vocab_size 152064 3584 18944 4096 1000000", "query_text_semantic": "def qwen2_7B() -> TransformerDecoder: return qwen2( vocab_size=152064, num_layers=28, num_heads=28, num_kv_heads=4, embed_dim=3584, intermediate_dim=18944, max_seq_len=4096, attn_dropout=0.0, norm_eps=1e-6, rope_base=1000000.0, )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.2174518562698313, "overlap_score": 0.0, "semantic_score": 0.5436296406745782}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.20754121411041304, "overlap_score": 0.0, "semantic_score": 0.5188530352760325}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2174518562698313, "overlap": 0.0, "semantic": 0.5436296406745782}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.20754121411041304, "overlap": 0.0, "semantic": 0.5188530352760325}, {"chunk_id": "p-ae67c9c86886", "combined": 0.19757186709930843, "overlap": 0.0, "semantic": 0.4939296677482711}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17542070650248553, "overlap": 0.0, "semantic": 0.43855176625621384}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1730309530342869, "overlap": 0.0, "semantic": 0.4325773825857172}, {"chunk_id": "p-88308230dda7", "combined": 0.1629159869240292, "overlap": 0.0, "semantic": 0.40728996731007294}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15959372608383615, "overlap": 0.0, "semantic": 0.3989843152095903}, {"chunk_id": "p-0d66effb9582", "combined": 0.13288728294793314, "overlap": 0.0, "semantic": 0.3322182073698329}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1165309184136648, "overlap": 0.0, "semantic": 0.29132729603416196}]}
{"symbol_id": "8b37bd657d34f45fcd831b851b2607e3c80ccf2b", "symbol_name": "qwen2_3B", "query_text_overlap": "qwen2_3b attn_dropout embed_dim intermediate_dim max_seq_len norm_eps num_heads num_kv_heads num_layers qwen2 rope_base tie_word_embeddings transformerdecoder vocab_size 151936 2048 11008 4096 1000000", "query_text_semantic": "def qwen2_3B() -> TransformerDecoder: return qwen2( vocab_size=151936, num_layers=36, num_heads=16, num_kv_heads=2, embed_dim=2048, intermediate_dim=11008, max_seq_len=4096, attn_dropout=0.0, norm_eps=1e-6, rope_base=1000000.0, tie_word_embeddings=True, )", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8402361703859211, "overlap_score": 1.0, "semantic_score": 0.6005904259648028}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.26099508976003927, "overlap_score": 0.0, "semantic_score": 0.6524877244000982}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8402361703859211, "overlap": 1.0, "semantic": 0.6005904259648028}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.26099508976003927, "overlap": 0.0, "semantic": 0.6524877244000982}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.24682524926169422, "overlap": 0.0, "semantic": 0.6170631231542355}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.22526395298677052, "overlap": 0.0, "semantic": 0.5631598824669263}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.22110292794727315, "overlap": 0.0, "semantic": 0.5527573198681829}, {"chunk_id": "p-0d66effb9582", "combined": 0.19656182755306137, "overlap": 0.0, "semantic": 0.4914045688826534}, {"chunk_id": "p-88308230dda7", "combined": 0.1961654633131434, "overlap": 0.0, "semantic": 0.4904136582828585}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.18695846443603648, "overlap": 0.0, "semantic": 0.4673961610900912}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.16199227320009632, "overlap": 0.0, "semantic": 0.40498068300024076}]}
{"symbol_id": "a8516532c0a085de0869036cad13dacf24351a9c", "symbol_name": "qwen2_1_5B", "query_text_overlap": "qwen2_1_5b attn_dropout embed_dim intermediate_dim max_seq_len norm_eps num_heads num_kv_heads num_layers qwen2 rope_base tie_word_embeddings transformerdecoder vocab_size 151936 1536 8960 4096 1000000", "query_text_semantic": "def qwen2_1_5B() -> TransformerDecoder: return qwen2( vocab_size=151936, num_layers=28, num_heads=12, num_kv_heads=2, embed_dim=1536, intermediate_dim=8960, max_seq_len=4096, attn_dropout=0.0, norm_eps=1e-6, rope_base=1000000.0, tie_word_embeddings=True, )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.2701080833437521, "overlap_score": 0.0, "semantic_score": 0.6752702083593802}, {"chunk_id": "p-ebeeda9fc683", "score": 0.25312789404819763, "overlap_score": 0.0, "semantic_score": 0.632819735120494}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2701080833437521, "overlap": 0.0, "semantic": 0.6752702083593802}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.25312789404819763, "overlap": 0.0, "semantic": 0.632819735120494}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24639844747093168, "overlap": 0.0, "semantic": 0.6159961186773292}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.23854822772417636, "overlap": 0.0, "semantic": 0.5963705693104409}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.22115916822378995, "overlap": 0.0, "semantic": 0.5528979205594748}, {"chunk_id": "p-88308230dda7", "combined": 0.20702757221190304, "overlap": 0.0, "semantic": 0.5175689305297576}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.19436765860290875, "overlap": 0.0, "semantic": 0.48591914650727186}, {"chunk_id": "p-0d66effb9582", "combined": 0.1887148352919875, "overlap": 0.0, "semantic": 0.4717870882299687}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1649539377403869, "overlap": 0.0, "semantic": 0.4123848443509673}]}
{"symbol_id": "0cd196bed60a3327e563ffd91553a7e874f27748", "symbol_name": "qwen2_500M", "query_text_overlap": "qwen2_500m attn_dropout embed_dim intermediate_dim max_seq_len norm_eps num_heads num_kv_heads num_layers qwen2 rope_base tie_word_embeddings transformerdecoder vocab_size 151936 896 4864 4096 1000000", "query_text_semantic": "def qwen2_500M() -> TransformerDecoder: return qwen2( vocab_size=151936, num_layers=24, num_heads=14, num_kv_heads=2, embed_dim=896, intermediate_dim=4864, max_seq_len=4096, attn_dropout=0.0, norm_eps=1e-6, rope_base=1000000.0, tie_word_embeddings=True, )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.26216994568603036, "overlap_score": 0.0, "semantic_score": 0.6554248642150758}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.2516791326675606, "overlap_score": 0.0, "semantic_score": 0.6291978316689014}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.26216994568603036, "overlap": 0.0, "semantic": 0.6554248642150758}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2516791326675606, "overlap": 0.0, "semantic": 0.6291978316689014}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24321357688617293, "overlap": 0.0, "semantic": 0.6080339422154323}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2403807756180334, "overlap": 0.0, "semantic": 0.6009519390450835}, {"chunk_id": "p-88308230dda7", "combined": 0.2167513096619428, "overlap": 0.0, "semantic": 0.541878274154857}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.21492216708226183, "overlap": 0.0, "semantic": 0.5373054177056545}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.20074190361246902, "overlap": 0.0, "semantic": 0.5018547590311725}, {"chunk_id": "p-0d66effb9582", "combined": 0.19790708584841946, "overlap": 0.0, "semantic": 0.4947677146210486}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1777107250394486, "overlap": 0.0, "semantic": 0.44427681259862145}]}
{"symbol_id": "59dedbd6911d026578343f3ab1f6c6180518b155", "symbol_name": "qwen2_200M", "query_text_overlap": "qwen2_200m attn_dropout embed_dim intermediate_dim max_seq_len norm_eps num_heads num_kv_heads num_layers qwen2 rope_base tie_word_embeddings transformerdecoder vocab_size 151936 1536 8960 4096 1000000", "query_text_semantic": "def qwen2_200M() -> TransformerDecoder: return qwen2( vocab_size=151936, num_layers=4, num_heads=12, num_kv_heads=2, embed_dim=1536, intermediate_dim=8960, max_seq_len=4096, attn_dropout=0.0, norm_eps=1e-6, rope_base=1000000.0, tie_word_embeddings=True, )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.26416010317139704, "overlap_score": 0.0, "semantic_score": 0.6604002579284926}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.2639451448005547, "overlap_score": 0.0, "semantic_score": 0.6598628620013867}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.26416010317139704, "overlap": 0.0, "semantic": 0.6604002579284926}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2639451448005547, "overlap": 0.0, "semantic": 0.6598628620013867}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2496812734997063, "overlap": 0.0, "semantic": 0.6242031837492658}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24482769722039888, "overlap": 0.0, "semantic": 0.6120692430509972}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.22952734347796394, "overlap": 0.0, "semantic": 0.5738183586949098}, {"chunk_id": "p-88308230dda7", "combined": 0.22945463102741834, "overlap": 0.0, "semantic": 0.5736365775685458}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.20486417737204166, "overlap": 0.0, "semantic": 0.5121604434301041}, {"chunk_id": "p-0d66effb9582", "combined": 0.20296825208455604, "overlap": 0.0, "semantic": 0.5074206302113901}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.17932245412468045, "overlap": 0.0, "semantic": 0.4483061353117011}]}
{"symbol_id": "8cb02d45513dce4f4d892c553559f45f51f225e8", "symbol_name": "mel_filter_bank", "query_text_overlap": "mel_scale norm num_frequency_bins num_mel_filters filter_freqs fft_freqs hertz_to_mel int mel_filters mel_freqs sampling_rate slaney mel enorm fft_bin_width float linspace max_frequency mel_filter_bank mel_max", "query_text_semantic": "def mel_filter_bank( num_frequency_bins: int, num_mel_filters: int, min_frequency: float, max_frequency: float, sampling_rate: int, norm: Optional[str] = None, mel_scale: str = \"htk\", triangularize_in_mel_space: bool = False, ) -> np.ndarray: if norm is not None and norm != \"slaney\": raise ValueError('norm must be one of None or \"slaney\"') # center points of the triangular mel filters mel_min = hertz_to_mel(min_frequency, mel_scale=mel_scale) mel_max = hertz_to_mel(max_frequency, mel_scale=mel_scale) mel_freqs = np.linspace(mel_min, mel_max, num_mel_filters + 2) filter_freqs = mel_to_hertz(mel_freqs, mel_scale=mel_scale) if triangularize_in_mel_space: # frequencies of FFT bins in Hz, but filters triangularized in mel space fft_bin_width = sampling_rate / (num_frequency_bins * 2) fft_freqs = hertz_to_mel( fft_bin_width * np.arange(num_frequency_bins), mel_scale=mel_scale ) filter_freqs = mel_freqs else: # frequencies of FFT bins in Hz fft_freqs = np.linspace(0, sampling_rate // 2, num_frequency_bins)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3522056621822572, "overlap_score": 0.0, "semantic_score": 0.8805141554556429}, {"chunk_id": "p-0212d69b9ec4", "score": 0.3104855244683264, "overlap_score": 0.0, "semantic_score": 0.7762138111708159}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3522056621822572, "overlap": 0.0, "semantic": 0.8805141554556429}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3104855244683264, "overlap": 0.0, "semantic": 0.7762138111708159}, {"chunk_id": "p-88308230dda7", "combined": 0.25160642518464105, "overlap": 0.0, "semantic": 0.6290160629616026}, {"chunk_id": "p-ae67c9c86886", "combined": 0.15428840236185337, "overlap": 0.0, "semantic": 0.3857210059046334}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.13688901581064727, "overlap": 0.0, "semantic": 0.3422225395266182}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.12758794468849166, "overlap": 0.0, "semantic": 0.31896986172122915}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.11743632575272106, "overlap": 0.0, "semantic": 0.2935908143818026}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10916709603112412, "overlap": 0.0, "semantic": 0.2729177400778103}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.10695831337039488, "overlap": 0.0, "semantic": 0.2673957834259872}]}
{"symbol_id": "ae777c89dd73b4fb213788d97756800ec074e62a", "symbol_name": "_create_triangular_filter_bank", "query_text_overlap": "ndarray filter_freqs shape fft_freqs filter_diff slopes triangular num_frequency_bins frequencies num_mel_filters _create_triangular_filter_bank down_slopes expand_dims up_slopes diff maximum minimum zeros creates filter", "query_text_semantic": "Creates a triangular filter bank.\n\n    Adapted from *torchaudio* and *librosa*.\n\n    Args:\n        fft_freqs (`np.ndarray` of shape `(num_frequency_bins,)`):\n            Discrete frequencies of the FFT bins in Hz.\n        filter_freqs (`np.ndarray` of shape `(num_mel_filters,)`):\n            Center frequencies of the triangular filters to create, in Hz.\n\n    Returns:\n        `np.ndarray` of shape `(num_frequency_bins, num_mel_filters)`", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-3c728ae39fa1", "score": 0.31535888134782886, "overlap_score": 0.0, "semantic_score": 0.7883972033695721}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.31535888134782886, "overlap": 0.0, "semantic": 0.7883972033695721}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3118504571750813, "overlap": 0.0, "semantic": 0.7796261429377033}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.30451899517974496, "overlap": 0.0, "semantic": 0.7612974879493624}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.25481453825001615, "overlap": 0.0, "semantic": 0.6370363456250403}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.19953547889071585, "overlap": 0.0, "semantic": 0.4988386972267896}, {"chunk_id": "p-88308230dda7", "combined": 0.19424965536703714, "overlap": 0.0, "semantic": 0.48562413841759283}, {"chunk_id": "p-ae67c9c86886", "combined": 0.18010761567327196, "overlap": 0.0, "semantic": 0.4502690391831799}, {"chunk_id": "p-0d66effb9582", "combined": 0.17396974988108163, "overlap": 0.0, "semantic": 0.43492437470270406}]}
{"symbol_id": "db8bd5047f6826a49f046db2485af2a74cc96dcd", "symbol_name": "mel_to_hertz", "query_text_overlap": "mels mel_scale min_log_mel freq exp log_region logstep min_log_hertz ndarray htk float mel_to_hertz union kaldi isinstance log power str valueerror slaney", "query_text_semantic": "def mel_to_hertz( mels: Union[float, np.ndarray], mel_scale: str = \"htk\" ) -> Union[float, np.ndarray]: if mel_scale not in [\"slaney\", \"htk\", \"kaldi\"]: raise ValueError('mel_scale should be one of \"htk\", \"slaney\" or \"kaldi\".') if mel_scale == \"htk\": return 700.0 * (np.power(10, mels / 2595.0) - 1.0) elif mel_scale == \"kaldi\": return 700.0 * (np.exp(mels / 1127.0) - 1.0) min_log_hertz = 1000.0 min_log_mel = 15.0 logstep = np.log(6.4) / 27.0 freq = 200.0 * mels / 3.0 if isinstance(mels, np.ndarray): log_region = mels >= min_log_mel freq[log_region] = min_log_hertz * np.exp( logstep * (mels[log_region] - min_log_mel) ) elif mels >= min_log_mel: freq = min_log_hertz * np.exp(logstep * (mels - min_log_mel)) return freq", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.267806242224521, "overlap_score": 0.0, "semantic_score": 0.6695156055613024}, {"chunk_id": "p-0d66effb9582", "score": 0.2521706896081007, "overlap_score": 0.0, "semantic_score": 0.6304267240202517}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.267806242224521, "overlap": 0.0, "semantic": 0.6695156055613024}, {"chunk_id": "p-0d66effb9582", "combined": 0.2521706896081007, "overlap": 0.0, "semantic": 0.6304267240202517}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.14801275018462287, "overlap": 0.0, "semantic": 0.37003187546155714}, {"chunk_id": "p-88308230dda7", "combined": 0.13680589471896037, "overlap": 0.0, "semantic": 0.3420147367974009}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.13418740829948442, "overlap": 0.0, "semantic": 0.33546852074871103}, {"chunk_id": "p-edce760829b6", "combined": 0.12910397157397774, "overlap": 0.0, "semantic": 0.3227599289349443}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.11930725390050556, "overlap": 0.0, "semantic": 0.2982681347512639}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.10064267294131607, "overlap": 0.0, "semantic": 0.25160668235329015}, {"chunk_id": "p-ae67c9c86886", "combined": 0.0997383293240427, "overlap": 0.0, "semantic": 0.24934582331010674}]}
{"symbol_id": "cd79a5973abe04b8b1ff88d82594fc8b93b0b63f", "symbol_name": "hertz_to_mel", "query_text_overlap": "freq mel_scale min_log_hertz log mels log_region logstep min_log_mel ndarray htk float hertz_to_mel union kaldi isinstance log10 str valueerror slaney 700", "query_text_semantic": "def hertz_to_mel( freq: Union[float, np.ndarray], mel_scale: str = \"htk\" ) -> Union[float, np.ndarray]: if mel_scale not in [\"slaney\", \"htk\", \"kaldi\"]: raise ValueError('mel_scale should be one of \"htk\", \"slaney\" or \"kaldi\".') if mel_scale == \"htk\": return 2595.0 * np.log10(1.0 + (freq / 700.0)) elif mel_scale == \"kaldi\": return 1127.0 * np.log(1.0 + (freq / 700.0)) min_log_hertz = 1000.0 min_log_mel = 15.0 logstep = 27.0 / np.log(6.4) mels = 3.0 * freq / 200.0 if isinstance(freq, np.ndarray): log_region = freq >= min_log_hertz mels[log_region] = ( min_log_mel + np.log(freq[log_region] / min_log_hertz) * logstep ) elif freq >= min_log_hertz: mels = min_log_mel + np.log(freq / min_log_hertz) * logstep return mels", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.28556227347874746, "overlap_score": 0.0, "semantic_score": 0.7139056836968686}, {"chunk_id": "p-0d66effb9582", "score": 0.21528666088460047, "overlap_score": 0.0, "semantic_score": 0.5382166522115012}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.28556227347874746, "overlap": 0.0, "semantic": 0.7139056836968686}, {"chunk_id": "p-0d66effb9582", "combined": 0.21528666088460047, "overlap": 0.0, "semantic": 0.5382166522115012}, {"chunk_id": "p-88308230dda7", "combined": 0.1526114792329002, "overlap": 0.0, "semantic": 0.3815286980822505}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.12367600305749354, "overlap": 0.0, "semantic": 0.30919000764373383}, {"chunk_id": "p-edce760829b6", "combined": 0.1094945676630414, "overlap": 0.0, "semantic": 0.2737364191576035}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.10509415563866215, "overlap": 0.0, "semantic": 0.26273538909665534}, {"chunk_id": "p-ae67c9c86886", "combined": 0.10113251062924136, "overlap": 0.0, "semantic": 0.2528312765731034}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.09731818311437294, "overlap": 0.0, "semantic": 0.24329545778593234}, {"chunk_id": "p-5c1af97004f2", "combined": 0.08050467422322903, "overlap": 0.0, "semantic": 0.20126168555807256}]}
{"symbol_id": "a6da3c38c80e0da3e5654200bfe61244fd6da82c", "symbol_name": "RedCodecInfer", "query_text_overlap": "codec torch audio16k audio16k_length shape tensor audio ssl chunk_size device indices vq_in_feats conf_path redcodec redcodecinfer rvq __init__ aco_feats aco_length acoustic_encoder", "query_text_semantic": "class RedCodecInfer(RedCodec): def __init__(self, codec: RedCodec): super().__init__( codec.ssl, codec.ssl_adaptor, codec.acoustic_encoder, codec.downsample, codec.rvq, codec.upsample, codec.semantic_decoder, codec.acoustic_decoder, ) @classmethod def from_pretrained(cls, conf_path: str, ckpt_path: str) -> \"RedCodecInfer\": with open(conf_path, \"r\") as f: codec = RedCodec.from_config(conf_path) ckpt = torch.load(ckpt_path)[\"generator\"] codec.load_state_dict(ckpt) return cls(codec) def _encode_one_batch(self, audio16k: torch.Tensor): B, T = audio16k.shape audio16k_length = torch.tensor( [T] * B, dtype=torch.long, device=audio16k.device ) # Semantic ssl, ssl_length = self.ssl.forward(audio16k, audio16k_length) ssl = ssl.clone() # For onnx export sem_feats, sem_length = self.ssl_adaptor(ssl, ssl_length) # Acoustic aco_feats, aco_length = self.acoustic_encoder(audio16k, audio16k_length) # VQ vq_in_feats = torch.cat([sem_feats, aco_feats], dim=2) vq_in_feats, vq_in_length = self.downsample(vq_in_feats, aco_length) # RVQ, indices = self.rvq.encode_codes(vq_in_feats.transpose(1, 2)) # (nq, B, L) indices = indices.permute(1, 0, 2) return indices # (B, nq, L) @staticmethod def _pad_and_chunk(audio: torch.Tensor, chunk_size:", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.3885462379015452, "overlap_score": 0.0, "semantic_score": 0.9713655947538629}, {"chunk_id": "p-0d66effb9582", "score": 0.38389828672004706, "overlap_score": 0.0, "semantic_score": 0.9597457168001176}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3885462379015452, "overlap": 0.0, "semantic": 0.9713655947538629}, {"chunk_id": "p-0d66effb9582", "combined": 0.38389828672004706, "overlap": 0.0, "semantic": 0.9597457168001176}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.34476198222300025, "overlap": 0.0, "semantic": 0.8619049555575006}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.33634477011563807, "overlap": 0.0, "semantic": 0.8408619252890951}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.32385941518775946, "overlap": 0.0, "semantic": 0.8096485379693986}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.30566268617147774, "overlap": 0.0, "semantic": 0.7641567154286943}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28742756968774724, "overlap": 0.0, "semantic": 0.718568924219368}, {"chunk_id": "p-88308230dda7", "combined": 0.28110455716088095, "overlap": 0.0, "semantic": 0.7027613929022023}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2434843887682323, "overlap": 0.0, "semantic": 0.6087109719205808}]}
{"symbol_id": "30523076615829dd1922b539fa2a3ea13a40d6d3", "symbol_name": "decode_one_token", "query_text_overlap": "token vq_out_feats audio cache_dict get bb_conv_cache1 bb_conv_cache2 bb_kv_cache is_cache torch up_conv_cache tensor vq_out_length decode_one_token device last_token new_bb_conv_cache1 new_bb_conv_cache2 new_bb_kv_cache new_cache_dict", "query_text_semantic": "Decode one single token to audio.\n\n        Args:\n            token: (B=1, nq, L=1)\n        Returns:\n            audio:  (B=1, t)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.33792953661231256, "overlap_score": 0.0, "semantic_score": 0.8448238415307814}, {"chunk_id": "p-ae67c9c86886", "score": 0.3303924344484989, "overlap_score": 0.0, "semantic_score": 0.8259810861212472}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.33792953661231256, "overlap": 0.0, "semantic": 0.8448238415307814}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3303924344484989, "overlap": 0.0, "semantic": 0.8259810861212472}, {"chunk_id": "p-0d66effb9582", "combined": 0.2969441738456663, "overlap": 0.0, "semantic": 0.7423604346141657}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2840558844582183, "overlap": 0.0, "semantic": 0.7101397111455456}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.27835001732475895, "overlap": 0.0, "semantic": 0.6958750433118973}, {"chunk_id": "p-88308230dda7", "combined": 0.24039182182628724, "overlap": 0.0, "semantic": 0.600979554565718}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2045228776184207, "overlap": 0.0, "semantic": 0.5113071940460517}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2002932204662166, "overlap": 0.0, "semantic": 0.5007330511655415}, {"chunk_id": "p-9158b9f667b9", "combined": 0.1921244517986502, "overlap": 0.0, "semantic": 0.48031112949662547}]}
{"symbol_id": "8ef8dd75ee4cfa0d87c5aaa31a2d46695829084e", "symbol_name": "decode", "query_text_overlap": "vq_out_feats tokens audio vq_out_length torch decode device tensor acoustic_decoder audio_length decode_codes dtype long permute rvq shape transpose upsample returns", "query_text_semantic": "Args:\n            tokens: (B=1, nq, L)\n        Returns:\n            audio: (B=1, t)", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.9363559949061531, "overlap_score": 1.0, "semantic_score": 0.8408899872653827}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.9322487346348517, "overlap_score": 0.8870812243914196, "semantic_score": 1.0}, {"chunk_id": "p-0212d69b9ec4", "score": 0.8046444654835523, "overlap_score": 0.9934963190173365, "semantic_score": 0.5213666851828759}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.9363559949061531, "overlap": 1.0, "semantic": 0.8408899872653827}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.9322487346348517, "overlap": 0.8870812243914196, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.8046444654835523, "overlap": 0.9934963190173365, "semantic": 0.5213666851828759}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.7945134585229661, "overlap": 0.8502945593161604, "semantic": 0.7108418073331746}, {"chunk_id": "p-88308230dda7", "combined": 0.6363279414930655, "overlap": 0.6575256811076372, "semantic": 0.604531332071208}, {"chunk_id": "p-ae67c9c86886", "combined": 0.326772942150072, "overlap": 0.0, "semantic": 0.8169323553751799}, {"chunk_id": "p-0d66effb9582", "combined": 0.29989665687952755, "overlap": 0.0, "semantic": 0.7497416421988188}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.29148872589586333, "overlap": 0.0, "semantic": 0.7287218147396584}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.22752633269471306, "overlap": 0.0, "semantic": 0.5688158317367826}, {"chunk_id": "p-9158b9f667b9", "combined": 0.1868309092214501, "overlap": 0.0, "semantic": 0.46707727305362523}]}
{"symbol_id": "810d6114c928a8ad7f55be73838564267e021778", "symbol_name": "encode", "query_text_overlap": "audio16k shape torch audio16k_length audio16k_batch dim token token_batch token_length token_list batch_size batch_size_list cat encode one_audio_chunks tensor append chunk_size device long", "query_text_semantic": "Args:\n            audio16k: shape (b, t)\n            audio16k_length: (b,)\n        Returns:\n            token: shape (b, nq, l)\n            token_length: (b,)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9959151925130323, "overlap_score": 1.0, "semantic_score": 0.9897879812825806}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.5429739352673786, "overlap_score": 0.46318727323471953, "semantic_score": 0.6626539283163673}, {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9959151925130323, "overlap": 1.0, "semantic": 0.9897879812825806}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.5429739352673786, "overlap": 0.46318727323471953, "semantic": 0.6626539283163673}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3510594109398894, "overlap": 0.0, "semantic": 0.8776485273497234}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.33290918698174904, "overlap": 0.0, "semantic": 0.8322729674543725}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.295317722802434, "overlap": 0.0, "semantic": 0.738294307006085}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.26123623114004924, "overlap": 0.0, "semantic": 0.653090577850123}, {"chunk_id": "p-88308230dda7", "combined": 0.2538331446082261, "overlap": 0.0, "semantic": 0.6345828615205652}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.23085677363595006, "overlap": 0.0, "semantic": 0.5771419340898751}, {"chunk_id": "p-5c1af97004f2", "combined": 0.21500705542734827, "overlap": 0.0, "semantic": 0.5375176385683706}]}
{"symbol_id": "2d7a40f430bc777b199daa4c0c4a512db8d803a0", "symbol_name": "_pad_and_chunk", "query_text_overlap": "audio chunk_size _pad_and_chunk audio_chunks pad_len shape tensor torch ceil dim int list math mode pad split value constant", "query_text_semantic": "def _pad_and_chunk(audio: torch.Tensor, chunk_size: int) -> List[torch.Tensor]: pad_len = math.ceil(audio.shape[1] / chunk_size) * chunk_size - audio.shape[1] audio = F.pad(audio, (0, pad_len), mode=\"constant\", value=0) audio_chunks = audio.split(chunk_size, dim=1) return audio_chunks", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.3893920539918733, "overlap_score": 0.0, "semantic_score": 0.9734801349796832}, {"chunk_id": "p-0d66effb9582", "score": 0.37892358084766387, "overlap_score": 0.0, "semantic_score": 0.9473089521191596}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3893920539918733, "overlap": 0.0, "semantic": 0.9734801349796832}, {"chunk_id": "p-0d66effb9582", "combined": 0.37892358084766387, "overlap": 0.0, "semantic": 0.9473089521191596}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3418471862637183, "overlap": 0.0, "semantic": 0.8546179656592957}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.33601427234509895, "overlap": 0.0, "semantic": 0.8400356808627474}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3226950390631506, "overlap": 0.0, "semantic": 0.8067375976578764}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.294774055259744, "overlap": 0.0, "semantic": 0.73693513814936}, {"chunk_id": "p-88308230dda7", "combined": 0.2597456958955314, "overlap": 0.0, "semantic": 0.6493642397388285}, {"chunk_id": "p-5c1af97004f2", "combined": 0.23461835072157244, "overlap": 0.0, "semantic": 0.5865458768039311}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.22551373036403857, "overlap": 0.0, "semantic": 0.5637843259100964}]}
{"symbol_id": "a376d26d9814d1c877a9e941bb6342258e7c51f4", "symbol_name": "_encode_one_batch", "query_text_overlap": "audio16k ssl indices torch vq_in_feats audio16k_length _encode_one_batch aco_feats aco_length device rvq sem_feats ssl_length tensor acoustic_encoder cat clone dim downsample dtype", "query_text_semantic": "def _encode_one_batch(self, audio16k: torch.Tensor): B, T = audio16k.shape audio16k_length = torch.tensor( [T] * B, dtype=torch.long, device=audio16k.device ) # Semantic ssl, ssl_length = self.ssl.forward(audio16k, audio16k_length) ssl = ssl.clone() # For onnx export sem_feats, sem_length = self.ssl_adaptor(ssl, ssl_length) # Acoustic aco_feats, aco_length = self.acoustic_encoder(audio16k, audio16k_length) # VQ vq_in_feats = torch.cat([sem_feats, aco_feats], dim=2) vq_in_feats, vq_in_length = self.downsample(vq_in_feats, aco_length) # RVQ, indices = self.rvq.encode_codes(vq_in_feats.transpose(1, 2)) # (nq, B, L) indices = indices.permute(1, 0, 2) return indices # (B, nq, L)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.37764152836344816, "overlap_score": 0.0, "semantic_score": 0.9441038209086203}, {"chunk_id": "p-0d66effb9582", "score": 0.34005883726141284, "overlap_score": 0.0, "semantic_score": 0.850147093153532}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.37764152836344816, "overlap": 0.0, "semantic": 0.9441038209086203}, {"chunk_id": "p-0d66effb9582", "combined": 0.34005883726141284, "overlap": 0.0, "semantic": 0.850147093153532}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3189832667224122, "overlap": 0.0, "semantic": 0.7974581668060304}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2934047770921932, "overlap": 0.0, "semantic": 0.733511942730483}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.27326808351830584, "overlap": 0.0, "semantic": 0.6831702087957646}, {"chunk_id": "p-88308230dda7", "combined": 0.26414934899828574, "overlap": 0.0, "semantic": 0.6603733724957144}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.26169901961320124, "overlap": 0.0, "semantic": 0.6542475490330031}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.25997918522572633, "overlap": 0.0, "semantic": 0.6499479630643158}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.23404441370027507, "overlap": 0.0, "semantic": 0.5851110342506877}]}
{"symbol_id": "c572dfb5dfb26572f40646e3f8d55d33dd1efe7a", "symbol_name": "from_pretrained", "query_text_overlap": "codec conf_path ckpt ckpt_path cls from_pretrained str from_config load load_state_dict open redcodec torch redcodecinfer generator", "query_text_semantic": "def from_pretrained(cls, conf_path: str, ckpt_path: str) -> \"RedCodecInfer\": with open(conf_path, \"r\") as f: codec = RedCodec.from_config(conf_path) ckpt = torch.load(ckpt_path)[\"generator\"] codec.load_state_dict(ckpt) return cls(codec)", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3773333408587221, "overlap_score": 0.0, "semantic_score": 0.9433333521468052}, {"chunk_id": "p-62dccf79cb8d", "score": 0.3580297074128842, "overlap_score": 0.0, "semantic_score": 0.8950742685322105}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3773333408587221, "overlap": 0.0, "semantic": 0.9433333521468052}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3580297074128842, "overlap": 0.0, "semantic": 0.8950742685322105}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3457316230005983, "overlap": 0.0, "semantic": 0.8643290575014957}, {"chunk_id": "p-0d66effb9582", "combined": 0.3013905977792578, "overlap": 0.0, "semantic": 0.7534764944481445}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2857518757031535, "overlap": 0.0, "semantic": 0.7143796892578838}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2703540836522217, "overlap": 0.0, "semantic": 0.6758852091305542}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.24806141281648963, "overlap": 0.0, "semantic": 0.620153532041224}, {"chunk_id": "p-88308230dda7", "combined": 0.2258514742236621, "overlap": 0.0, "semantic": 0.5646286855591552}, {"chunk_id": "p-9158b9f667b9", "combined": 0.17649788160305835, "overlap": 0.0, "semantic": 0.4412447040076458}]}
{"symbol_id": "3c3ffb9ed282e39eaa9cbc1826d7869670fe61cf", "symbol_name": "__init__", "query_text_overlap": "codec __init__ acoustic_decoder acoustic_encoder downsample redcodec rvq semantic_decoder ssl ssl_adaptor super upsample", "query_text_semantic": "def __init__(self, codec: RedCodec): super().__init__( codec.ssl, codec.ssl_adaptor, codec.acoustic_encoder, codec.downsample, codec.rvq, codec.upsample, codec.semantic_decoder, codec.acoustic_decoder, )", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3976302214692584, "overlap_score": 0.0, "semantic_score": 0.994075553673146}, {"chunk_id": "p-62dccf79cb8d", "score": 0.37873761742297674, "overlap_score": 0.0, "semantic_score": 0.9468440435574418}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3976302214692584, "overlap": 0.0, "semantic": 0.994075553673146}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.37873761742297674, "overlap": 0.0, "semantic": 0.9468440435574418}, {"chunk_id": "p-021b4cb4f328", "combined": 0.37189907920379756, "overlap": 0.0, "semantic": 0.9297476980094939}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.368326036631783, "overlap": 0.0, "semantic": 0.9208150915794574}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3224424830494466, "overlap": 0.0, "semantic": 0.8061062076236165}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3011338442798046, "overlap": 0.0, "semantic": 0.7528346106995114}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.29639875675840577, "overlap": 0.0, "semantic": 0.7409968918960144}, {"chunk_id": "p-88308230dda7", "combined": 0.2711735593359825, "overlap": 0.0, "semantic": 0.6779338983399561}, {"chunk_id": "p-9158b9f667b9", "combined": 0.24997813117887313, "overlap": 0.0, "semantic": 0.6249453279471828}]}
{"symbol_id": "b10d37679c0b1e9891a7a67344c33e46cbbc3595", "symbol_name": "RedCodec", "query_text_overlap": "config acoustic_decoder acoustic_encoder downsample rvq semantic_decoder ssl_adaptor upsample ssl ssladaptor redcodec __init__ acousticdecoder cls config_json pretrainedwhisperencoder residualdownconv residualvq upconv whisperacousticencoder", "query_text_semantic": "class RedCodec(nn.Module): def __init__( self, ssl: PretrainedWhisperEncoder, ssl_adaptor: SslAdaptor, acoustic_encoder: WhisperAcousticEncoder, downsample: ResidualDownConv, rvq: ResidualVQ, upsample: UpConv, semantic_decoder: SslAdaptor, acoustic_decoder: AcousticDecoder, ): super().__init__() self.ssl = ssl self.ssl_adaptor = ssl_adaptor self.acoustic_encoder = acoustic_encoder self.downsample = downsample self.rvq = rvq self.upsample = upsample self.semantic_decoder = semantic_decoder self.acoustic_decoder = acoustic_decoder @classmethod def from_config(cls, config_json: str) -> \"RedCodec\": with open(config_json, \"rb\") as f: config = json.load(f)[\"codec\"] ssl = PretrainedWhisperEncoder.from_pretrained() ssl_adaptor = SslAdaptor(**config[\"ssl_adaptor\"]) acoustic_encoder = WhisperAcousticEncoder(**config[\"acoustic_encoder\"]) downsample = ResidualDownConv(**config[\"downsample\"]) rvq = ResidualVQ(**config[\"rvq\"]) upsample = UpConv(**config[\"upsample\"]) semantic_decoder = SslAdaptor(**config[\"semantic_decoder\"]) acoustic_decoder = AcousticDecoder(**config[\"acoustic_decoder\"]) return cls( ssl, ssl_adaptor, acoustic_encoder, downsample, rvq, upsample, semantic_decoder, acoustic_decoder, )", "best": {"chunk_id": "p-0d66effb9582", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.3909388558277024, "overlap_score": 0.0, "semantic_score": 0.9773471395692559}, {"chunk_id": "p-021b4cb4f328", "score": 0.36952110160933094, "overlap_score": 0.0, "semantic_score": 0.9238027540233272}], "topk_raw": [{"chunk_id": "p-0d66effb9582", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3909388558277024, "overlap": 0.0, "semantic": 0.9773471395692559}, {"chunk_id": "p-021b4cb4f328", "combined": 0.36952110160933094, "overlap": 0.0, "semantic": 0.9238027540233272}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.35418585618666243, "overlap": 0.0, "semantic": 0.885464640466656}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.35144704236240626, "overlap": 0.0, "semantic": 0.8786176059060156}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.30659467501902177, "overlap": 0.0, "semantic": 0.7664866875475543}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2947181809119161, "overlap": 0.0, "semantic": 0.7367954522797903}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.29354712798481575, "overlap": 0.0, "semantic": 0.7338678199620393}, {"chunk_id": "p-88308230dda7", "combined": 0.27375655417282174, "overlap": 0.0, "semantic": 0.6843913854320544}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.2665728458359257, "overlap": 0.0, "semantic": 0.6664321145898143}]}
{"symbol_id": "332da21dcb72a699afc8c39e3ffb98350787a844", "symbol_name": "from_config", "query_text_overlap": "config acoustic_decoder acoustic_encoder downsample rvq semantic_decoder ssl_adaptor upsample cls config_json from_config ssl ssladaptor acousticdecoder from_pretrained json load open pretrainedwhisperencoder residualdownconv", "query_text_semantic": "def from_config(cls, config_json: str) -> \"RedCodec\": with open(config_json, \"rb\") as f: config = json.load(f)[\"codec\"] ssl = PretrainedWhisperEncoder.from_pretrained() ssl_adaptor = SslAdaptor(**config[\"ssl_adaptor\"]) acoustic_encoder = WhisperAcousticEncoder(**config[\"acoustic_encoder\"]) downsample = ResidualDownConv(**config[\"downsample\"]) rvq = ResidualVQ(**config[\"rvq\"]) upsample = UpConv(**config[\"upsample\"]) semantic_decoder = SslAdaptor(**config[\"semantic_decoder\"]) acoustic_decoder = AcousticDecoder(**config[\"acoustic_decoder\"]) return cls( ssl, ssl_adaptor, acoustic_encoder, downsample, rvq, upsample, semantic_decoder, acoustic_decoder, )", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3419365399912251, "overlap_score": 0.0, "semantic_score": 0.8548413499780627}, {"chunk_id": "p-62dccf79cb8d", "score": 0.3271241322581936, "overlap_score": 0.0, "semantic_score": 0.8178103306454839}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3419365399912251, "overlap": 0.0, "semantic": 0.8548413499780627}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3271241322581936, "overlap": 0.0, "semantic": 0.8178103306454839}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3115244520605075, "overlap": 0.0, "semantic": 0.7788111301512687}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3098791111991163, "overlap": 0.0, "semantic": 0.7746977779977907}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.30392134870319354, "overlap": 0.0, "semantic": 0.7598033717579837}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2962721330529525, "overlap": 0.0, "semantic": 0.7406803326323813}, {"chunk_id": "p-88308230dda7", "combined": 0.27568397075666884, "overlap": 0.0, "semantic": 0.689209926891672}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.27508556881886753, "overlap": 0.0, "semantic": 0.6877139220471689}, {"chunk_id": "p-9158b9f667b9", "combined": 0.23673595490760252, "overlap": 0.0, "semantic": 0.5918398872690063}]}
{"symbol_id": "58a99c06142877b644e956a4a7eda63f03501b75", "symbol_name": "__init__", "query_text_overlap": "__init__ acoustic_decoder acoustic_encoder downsample rvq semantic_decoder ssl ssl_adaptor upsample ssladaptor acousticdecoder pretrainedwhisperencoder residualdownconv residualvq super upconv whisperacousticencoder", "query_text_semantic": "def __init__( self, ssl: PretrainedWhisperEncoder, ssl_adaptor: SslAdaptor, acoustic_encoder: WhisperAcousticEncoder, downsample: ResidualDownConv, rvq: ResidualVQ, upsample: UpConv, semantic_decoder: SslAdaptor, acoustic_decoder: AcousticDecoder, ): super().__init__() self.ssl = ssl self.ssl_adaptor = ssl_adaptor self.acoustic_encoder = acoustic_encoder self.downsample = downsample self.rvq = rvq self.upsample = upsample self.semantic_decoder = semantic_decoder self.acoustic_decoder = acoustic_decoder", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3957367210871035, "overlap_score": 0.0, "semantic_score": 0.9893418027177587}, {"chunk_id": "p-62dccf79cb8d", "score": 0.36861370283405115, "overlap_score": 0.0, "semantic_score": 0.9215342570851278}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3957367210871035, "overlap": 0.0, "semantic": 0.9893418027177587}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.36861370283405115, "overlap": 0.0, "semantic": 0.9215342570851278}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.36482996351901975, "overlap": 0.0, "semantic": 0.9120749087975494}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3541680741709972, "overlap": 0.0, "semantic": 0.885420185427493}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3176659219724027, "overlap": 0.0, "semantic": 0.7941648049310066}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3148440500521562, "overlap": 0.0, "semantic": 0.7871101251303905}, {"chunk_id": "p-88308230dda7", "combined": 0.290376224567067, "overlap": 0.0, "semantic": 0.7259405614176675}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2896425299015199, "overlap": 0.0, "semantic": 0.7241063247537998}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2763895763637932, "overlap": 0.0, "semantic": 0.6909739409094829}]}
{"symbol_id": "755e88d631db4b280b256454a751f7739883ffd8", "symbol_name": "UpConv", "query_text_overlap": "stride embed_dim res transpose __init__ in_proj input_length int output_length tensor torch up_conv upconv bias convtranspose1d forward kernel_size linear module super", "query_text_semantic": "class UpConv(nn.Module): def __init__( self, embed_dim: int = 768, stride: int = 4, ): super().__init__() self.embed_dim = embed_dim self.stride = stride self.in_proj = nn.Linear(embed_dim, self.stride * embed_dim) # Simple transpose convolution layer to keep channel number consistent self.up_conv = nn.ConvTranspose1d( self.stride * embed_dim, embed_dim, kernel_size=stride, stride=stride, bias=False, ) def forward(self, x: torch.Tensor, input_length: torch.Tensor): x = self.in_proj(x) x = x.transpose(1, 2) res = self.up_conv(x) res = res.transpose(1, 2) output_length = input_length * self.stride return res, output_length", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.2779238238684786, "overlap_score": 0.0, "semantic_score": 0.6948095596711964}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.2658194906134927, "overlap_score": 0.0, "semantic_score": 0.6645487265337318}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2779238238684786, "overlap": 0.0, "semantic": 0.6948095596711964}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2658194906134927, "overlap": 0.0, "semantic": 0.6645487265337318}, {"chunk_id": "p-0d66effb9582", "combined": 0.18583576770133303, "overlap": 0.0, "semantic": 0.4645894192533326}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.184489790044754, "overlap": 0.0, "semantic": 0.46122447511188497}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1632474229276693, "overlap": 0.0, "semantic": 0.40811855731917324}, {"chunk_id": "p-88308230dda7", "combined": 0.16292328822757224, "overlap": 0.0, "semantic": 0.40730822056893057}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.14677662495063312, "overlap": 0.0, "semantic": 0.36694156237658276}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.14021521571938175, "overlap": 0.0, "semantic": 0.35053803929845434}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1332585994349388, "overlap": 0.0, "semantic": 0.333146498587347}]}
{"symbol_id": "19b64166b979b4826b6879317c0e05504dde194b", "symbol_name": "forward", "query_text_overlap": "res forward input_length output_length tensor torch transpose in_proj stride up_conv", "query_text_semantic": "def forward(self, x: torch.Tensor, input_length: torch.Tensor): x = self.in_proj(x) x = x.transpose(1, 2) res = self.up_conv(x) res = res.transpose(1, 2) output_length = input_length * self.stride return res, output_length", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.25375586021665597, "overlap_score": 0.0, "semantic_score": 0.6343896505416399}, {"chunk_id": "p-ae67c9c86886", "score": 0.2435853007720278, "overlap_score": 0.0, "semantic_score": 0.6089632519300695}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25375586021665597, "overlap": 0.0, "semantic": 0.6343896505416399}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2435853007720278, "overlap": 0.0, "semantic": 0.6089632519300695}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2085014827039942, "overlap": 0.0, "semantic": 0.5212537067599855}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.16329278780043738, "overlap": 0.0, "semantic": 0.4082319695010934}, {"chunk_id": "p-88308230dda7", "combined": 0.14305276666557873, "overlap": 0.0, "semantic": 0.3576319166639468}, {"chunk_id": "p-5c1af97004f2", "combined": 0.13737549330831964, "overlap": 0.0, "semantic": 0.3434387332707991}, {"chunk_id": "p-0d66effb9582", "combined": 0.13220646410692688, "overlap": 0.0, "semantic": 0.33051616026731717}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.11472973823143617, "overlap": 0.0, "semantic": 0.28682434557859043}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.09279761575332196, "overlap": 0.0, "semantic": 0.23199403938330487}]}
{"symbol_id": "06c6ef8d911d787fbd70edc765c9aee8d129b992", "symbol_name": "__init__", "query_text_overlap": "stride embed_dim __init__ int bias convtranspose1d in_proj kernel_size linear super up_conv 768 simple transpose convolution layer keep channel number consistent", "query_text_semantic": "def __init__( self, embed_dim: int = 768, stride: int = 4, ): super().__init__() self.embed_dim = embed_dim self.stride = stride self.in_proj = nn.Linear(embed_dim, self.stride * embed_dim) # Simple transpose convolution layer to keep channel number consistent self.up_conv = nn.ConvTranspose1d( self.stride * embed_dim, embed_dim, kernel_size=stride, stride=stride, bias=False, )", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9088838604022758, "overlap_score": 1.0, "semantic_score": 0.7722096510056894}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.6548913848255027, "overlap_score": 0.4897597828011568, "semantic_score": 0.9025887878620215}, {"chunk_id": "p-88308230dda7", "score": 0.4845128005210354, "overlap_score": 0.4798195906094599, "semantic_score": 0.49155261538839856}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9088838604022758, "overlap": 1.0, "semantic": 0.7722096510056894}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6548913848255027, "overlap": 0.4897597828011568, "semantic": 0.9025887878620215}, {"chunk_id": "p-88308230dda7", "combined": 0.4845128005210354, "overlap": 0.4798195906094599, "semantic": 0.49155261538839856}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.23931588621874675, "overlap": 0.0, "semantic": 0.5982897155468668}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.23469326625742037, "overlap": 0.0, "semantic": 0.5867331656435509}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.22507538237384606, "overlap": 0.0, "semantic": 0.5626884559346151}, {"chunk_id": "p-0d66effb9582", "combined": 0.2230858986890783, "overlap": 0.0, "semantic": 0.5577147467226957}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.18276285231523978, "overlap": 0.0, "semantic": 0.4569071307880994}, {"chunk_id": "p-5c1af97004f2", "combined": 0.16222163898082823, "overlap": 0.0, "semantic": 0.40555409745207055}]}
{"symbol_id": "91b4785dbdcc2383161d7cc63ae899917a12950d", "symbol_name": "ResidualDownConv", "query_text_overlap": "avg_pooler intermediate_dim embed_dim res bias linear permute __init__ act_fn batch_size conv1d down_proj gate_proj input_length layer_norm out_proj output_length residualdownconv tensor torch", "query_text_semantic": "class ResidualDownConv(nn.Module): def __init__( self, embed_dim: int = 768, avg_pooler=4, ): super().__init__() self.embed_dim = embed_dim self.avg_pooler = avg_pooler self.intermediate_dim = embed_dim * avg_pooler # Convolution layer for downsampling self.gate_proj = nn.Conv1d( embed_dim, self.intermediate_dim, avg_pooler, avg_pooler, bias=False ) self.up_proj = nn.Conv1d( embed_dim, self.intermediate_dim, avg_pooler, avg_pooler, bias=False ) # Downsampled linear projection self.down_proj = nn.Linear( self.intermediate_dim, self.intermediate_dim, bias=False ) # Activation function and layer normalization self.act_fn = nn.SiLU() self.layer_norm = nn.LayerNorm(self.intermediate_dim) # Final output projection self.out_proj = nn.Linear(self.intermediate_dim, embed_dim) def forward(self, x: torch.Tensor, input_length: torch.Tensor): output_length = input_length // self.avg_pooler batch_size, seq_len, _ = x.shape # (B, T, D) xt = x.permute(0, 2, 1) # (B, D, T) g = self.gate_proj(xt).permute(0, 2, 1) # (B, T//4, D*4) u = self.up_proj(xt).permute(0, 2, 1)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.2541334947477633, "overlap_score": 0.0, "semantic_score": 0.6353337368694082}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.25228478011032585, "overlap_score": 0.0, "semantic_score": 0.6307119502758146}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.2541334947477633, "overlap": 0.0, "semantic": 0.6353337368694082}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25228478011032585, "overlap": 0.0, "semantic": 0.6307119502758146}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24109838584970286, "overlap": 0.0, "semantic": 0.6027459646242571}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2140945170495491, "overlap": 0.0, "semantic": 0.5352362926238727}, {"chunk_id": "p-88308230dda7", "combined": 0.1709531938338872, "overlap": 0.0, "semantic": 0.427382984584718}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.16586054217902646, "overlap": 0.0, "semantic": 0.4146513554475661}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.15630936870055925, "overlap": 0.0, "semantic": 0.3907734217513981}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.12121722266536417, "overlap": 0.0, "semantic": 0.3030430566634104}, {"chunk_id": "p-5c1af97004f2", "combined": 0.11481892068374894, "overlap": 0.0, "semantic": 0.2870473017093723}]}
{"symbol_id": "b4b4d65649615471309c87731f5fd127e167d18e", "symbol_name": "forward", "query_text_overlap": "res permute batch_size forward input_length output_length tensor torch act_fn avg_pooler down_proj gate_proj intermediate_dim layer_norm out_proj reshape seq_len shape up_proj", "query_text_semantic": "def forward(self, x: torch.Tensor, input_length: torch.Tensor): output_length = input_length // self.avg_pooler batch_size, seq_len, _ = x.shape # (B, T, D) xt = x.permute(0, 2, 1) # (B, D, T) g = self.gate_proj(xt).permute(0, 2, 1) # (B, T//4, D*4) u = self.up_proj(xt).permute(0, 2, 1) # (B, T//4, D*4) x = x.reshape(batch_size, -1, self.intermediate_dim) # (B, T//4, D*4) c = self.down_proj(self.act_fn(g) * u) # (B, T//4, D*4) res = self.layer_norm(c + x) # (B, T//4, D*4) res = self.out_proj(res) return res, output_length", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.261426401120155, "overlap_score": 0.0, "semantic_score": 0.6535660028003876}, {"chunk_id": "p-ae67c9c86886", "score": 0.2094913056931537, "overlap_score": 0.0, "semantic_score": 0.5237282642328842}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.261426401120155, "overlap": 0.0, "semantic": 0.6535660028003876}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2094913056931537, "overlap": 0.0, "semantic": 0.5237282642328842}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17090638207020475, "overlap": 0.0, "semantic": 0.42726595517551186}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.16252424353202377, "overlap": 0.0, "semantic": 0.40631060883005937}, {"chunk_id": "p-0d66effb9582", "combined": 0.15321726166749305, "overlap": 0.0, "semantic": 0.3830431541687326}, {"chunk_id": "p-88308230dda7", "combined": 0.15300106494291033, "overlap": 0.0, "semantic": 0.38250266235727576}, {"chunk_id": "p-5c1af97004f2", "combined": 0.13825652211364622, "overlap": 0.0, "semantic": 0.3456413052841155}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1285875575079598, "overlap": 0.0, "semantic": 0.3214688937698995}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.12294761087220252, "overlap": 0.0, "semantic": 0.3073690271805063}]}
{"symbol_id": "7dd0339b64f3e21af5289d264de7447c019d69ac", "symbol_name": "__init__", "query_text_overlap": "avg_pooler embed_dim intermediate_dim __init__ bias linear conv1d act_fn down_proj gate_proj int layer_norm layernorm out_proj silu super up_proj layer projection 768", "query_text_semantic": "def __init__( self, embed_dim: int = 768, avg_pooler=4, ): super().__init__() self.embed_dim = embed_dim self.avg_pooler = avg_pooler self.intermediate_dim = embed_dim * avg_pooler # Convolution layer for downsampling self.gate_proj = nn.Conv1d( embed_dim, self.intermediate_dim, avg_pooler, avg_pooler, bias=False ) self.up_proj = nn.Conv1d( embed_dim, self.intermediate_dim, avg_pooler, avg_pooler, bias=False ) # Downsampled linear projection self.down_proj = nn.Linear( self.intermediate_dim, self.intermediate_dim, bias=False ) # Activation function and layer normalization self.act_fn = nn.SiLU() self.layer_norm = nn.LayerNorm(self.intermediate_dim) # Final output projection self.out_proj = nn.Linear(self.intermediate_dim, embed_dim)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8520623138914121, "overlap_score": 1.0, "semantic_score": 0.6301557847285304}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.24265574135668522, "overlap_score": 0.0, "semantic_score": 0.606639353391713}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8520623138914121, "overlap": 1.0, "semantic": 0.6301557847285304}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24265574135668522, "overlap": 0.0, "semantic": 0.606639353391713}, {"chunk_id": "p-0d66effb9582", "combined": 0.23761822297569724, "overlap": 0.0, "semantic": 0.594045557439243}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2309452564039397, "overlap": 0.0, "semantic": 0.5773631410098492}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1768506419380067, "overlap": 0.0, "semantic": 0.44212660484501676}, {"chunk_id": "p-88308230dda7", "combined": 0.16729528662544146, "overlap": 0.0, "semantic": 0.4182382165636036}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.15980885507349968, "overlap": 0.0, "semantic": 0.39952213768374917}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1368940606248183, "overlap": 0.0, "semantic": 0.3422351515620457}, {"chunk_id": "p-5c1af97004f2", "combined": 0.11797587762061364, "overlap": 0.0, "semantic": 0.2949396940515341}]}
{"symbol_id": "38f9196fced3a4951948b285fe103df8c8a6bb15", "symbol_name": "SslAdaptor", "query_text_overlap": "module hidden_states embed_dim int std data dropout in_dim weight hidden_length linear __init__ _init_weights attention_mask attn_dropout bias ffn_dim float in_proj isinstance", "query_text_semantic": "class SslAdaptor(nn.Module): def __init__( self, in_dim: int, embed_dim: int, out_dim: int, num_layers: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, ): super().__init__() self.in_dim = in_dim self.embed_dim = embed_dim self.dropout = dropout # Input Projection self.in_proj = nn.Linear(in_dim, embed_dim) # Transformer self.layers = nn.ModuleList( [ WhisperEncoderLayer( embed_dim, num_heads, ffn_dim, attn_dropout, dropout ) for _ in range(num_layers) ] ) # Output norm self.layer_norm = nn.LayerNorm(embed_dim) # Output projection self.out_proj = nn.Linear(embed_dim, out_dim) # Init weight self.apply(self._init_weights) def forward( self, hidden_states: torch.Tensor, hidden_length: torch.Tensor, ): # Downsampling hidden_states = self.in_proj(hidden_states) # Transformer attention_mask = make_nonpad_mask(hidden_length).unsqueeze(1) # (b, 1, t) for layer in self.layers: hidden_states = layer(hidden_states, attention_mask) hidden_states = self.layer_norm(hidden_states) hidden_states = self.out_proj(hidden_states) return hidden_states, hidden_length", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.8142365080918038, "overlap_score": 1.0, "semantic_score": 0.5355912702295096}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.8058459916917131, "overlap_score": 0.9188939462923675, "semantic_score": 0.6362740597907316}, {"chunk_id": "p-021b4cb4f328", "score": 0.7964922733603894, "overlap_score": 0.660820455600649, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.8142365080918038, "overlap": 1.0, "semantic": 0.5355912702295096}, {"chunk_id": "p-ae67c9c86886", "combined": 0.8058459916917131, "overlap": 0.9188939462923675, "semantic": 0.6362740597907316}, {"chunk_id": "p-021b4cb4f328", "combined": 0.7964922733603894, "overlap": 0.660820455600649, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2551089353397221, "overlap": 0.0, "semantic": 0.6377723383493052}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.21822855768555716, "overlap": 0.0, "semantic": 0.5455713942138929}, {"chunk_id": "p-0d66effb9582", "combined": 0.21211417705908278, "overlap": 0.0, "semantic": 0.5302854426477069}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.20524561026092433, "overlap": 0.0, "semantic": 0.5131140256523108}, {"chunk_id": "p-88308230dda7", "combined": 0.20275582880828213, "overlap": 0.0, "semantic": 0.5068895720207053}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18828072112479724, "overlap": 0.0, "semantic": 0.4707018028119931}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15753137320303143, "overlap": 0.0, "semantic": 0.3938284330075785}]}
{"symbol_id": "5bd41c39128be424e82c5862644b8cccda008254", "symbol_name": "_init_weights", "query_text_overlap": "module std data weight _init_weights bias isinstance mean normal_ padding_idx zero_ conv1d embedding linear not elif", "query_text_semantic": "def _init_weights(self, module): std = 0.02 if isinstance(module, (nn.Linear, nn.Conv1d)): module.weight.data.normal_(mean=0.0, std=std) if module.bias is not None: module.bias.data.zero_() elif isinstance(module, nn.Embedding): module.weight.data.normal_(mean=0.0, std=std) if module.padding_idx is not None: module.weight.data[module.padding_idx].zero_()", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.7964922733603894, "overlap_score": 0.660820455600649, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.7741108876511286, "overlap_score": 1.0, "semantic_score": 0.43527721912782147}, {"chunk_id": "p-ae67c9c86886", "score": 0.6846382420326971, "overlap_score": 0.9188939462923675, "semantic_score": 0.33325468564319144}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.7964922733603894, "overlap": 0.660820455600649, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.7741108876511286, "overlap": 1.0, "semantic": 0.43527721912782147}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6846382420326971, "overlap": 0.9188939462923675, "semantic": 0.33325468564319144}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6590788335646034, "overlap": 0.7603684063633829, "semantic": 0.5071444743664344}, {"chunk_id": "p-0d66effb9582", "combined": 0.24289546692549024, "overlap": 0.0, "semantic": 0.6072386673137256}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15670099607627883, "overlap": 0.0, "semantic": 0.391752490190697}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.12094030017575948, "overlap": 0.0, "semantic": 0.3023507504393987}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10285599141937392, "overlap": 0.0, "semantic": 0.2571399785484348}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.09559616993162608, "overlap": 0.0, "semantic": 0.23899042482906518}, {"chunk_id": "p-edce760829b6", "combined": 0.08977455903333115, "overlap": 0.0, "semantic": 0.22443639758332784}]}
{"symbol_id": "e720bc2d88e627268fdb2e3c79387042a95a089a", "symbol_name": "forward", "query_text_overlap": "hidden_states hidden_length attention_mask forward layer tensor torch in_proj layer_norm layers make_nonpad_mask out_proj unsqueeze downsampling transformer", "query_text_semantic": "def forward( self, hidden_states: torch.Tensor, hidden_length: torch.Tensor, ): # Downsampling hidden_states = self.in_proj(hidden_states) # Transformer attention_mask = make_nonpad_mask(hidden_length).unsqueeze(1) # (b, 1, t) for layer in self.layers: hidden_states = layer(hidden_states, attention_mask) hidden_states = self.layer_norm(hidden_states) hidden_states = self.out_proj(hidden_states) return hidden_states, hidden_length", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8434427539403171, "overlap_score": 1.0, "semantic_score": 0.6086068848507926}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.5019648321478409, "overlap_score": 0.16994138691306815, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.29443755101122326, "overlap_score": 0.247605095597753, "semantic_score": 0.3646862341314286}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8434427539403171, "overlap": 1.0, "semantic": 0.6086068848507926}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5019648321478409, "overlap": 0.16994138691306815, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.29443755101122326, "overlap": 0.247605095597753, "semantic": 0.3646862341314286}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2182205049397295, "overlap": 0.14200495905131522, "semantic": 0.332543823772351}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1925286222927235, "overlap": 0.0, "semantic": 0.4813215557318087}, {"chunk_id": "p-88308230dda7", "combined": 0.18008699064339517, "overlap": 0.10032477100086556, "semantic": 0.2997303201071896}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1337063262838174, "overlap": 0.0, "semantic": 0.3342658157095435}, {"chunk_id": "p-0d66effb9582", "combined": 0.11418358282321257, "overlap": 0.0, "semantic": 0.2854589570580314}, {"chunk_id": "p-5c1af97004f2", "combined": 0.10557952008141153, "overlap": 0.0, "semantic": 0.2639488002035288}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.09157346055007538, "overlap": 0.0, "semantic": 0.22893365137518845}]}
{"symbol_id": "cb815d8d66eb5e239e3705b5aa1d92815a53eec3", "symbol_name": "__init__", "query_text_overlap": "embed_dim int dropout in_dim __init__ attn_dropout ffn_dim float linear num_heads num_layers out_dim _init_weights apply in_proj layer_norm layernorm layers modulelist out_proj", "query_text_semantic": "def __init__( self, in_dim: int, embed_dim: int, out_dim: int, num_layers: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, ): super().__init__() self.in_dim = in_dim self.embed_dim = embed_dim self.dropout = dropout # Input Projection self.in_proj = nn.Linear(in_dim, embed_dim) # Transformer self.layers = nn.ModuleList( [ WhisperEncoderLayer( embed_dim, num_heads, ffn_dim, attn_dropout, dropout ) for _ in range(num_layers) ] ) # Output norm self.layer_norm = nn.LayerNorm(embed_dim) # Output projection self.out_proj = nn.Linear(embed_dim, out_dim) # Init weight self.apply(self._init_weights)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8927035913859422, "overlap_score": 1.0, "semantic_score": 0.7317589784648555}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.3179668653191796, "overlap_score": 0.0, "semantic_score": 0.794917163297949}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8927035913859422, "overlap": 1.0, "semantic": 0.7317589784648555}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3179668653191796, "overlap": 0.0, "semantic": 0.794917163297949}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2537194715373099, "overlap": 0.0, "semantic": 0.6342986788432747}, {"chunk_id": "p-0d66effb9582", "combined": 0.23953989830317993, "overlap": 0.0, "semantic": 0.5988497457579498}, {"chunk_id": "p-88308230dda7", "combined": 0.22457274916060932, "overlap": 0.0, "semantic": 0.5614318729015233}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.21835881361106746, "overlap": 0.0, "semantic": 0.5458970340276686}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2098282206349269, "overlap": 0.0, "semantic": 0.5245705515873172}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.20114189344203326, "overlap": 0.0, "semantic": 0.5028547336050831}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1936718479050219, "overlap": 0.0, "semantic": 0.4841796197625547}]}
{"symbol_id": "3f314b7d3a919bb44187a870165f6802f99fdc6c", "symbol_name": "AcousticDecoder", "query_text_overlap": "embed_dim x_lens causal hop_length num_heads num_layers int backbone dropout init padding shape tensor torch __init__ _init_weights acousticdecoder convtranspose1d gelu isift", "query_text_semantic": "UpsampleConv(50->100Hz) + VocosBackbone + ISTFTHead", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8505141721839673, "overlap_score": 1.0, "semantic_score": 0.6262854304599184}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.7870389243150331, "overlap_score": 0.6460223193891534, "semantic_score": 0.9985638317038524}, {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8505141721839673, "overlap": 1.0, "semantic": 0.6262854304599184}, {"chunk_id": "p-021b4cb4f328", "combined": 0.7870389243150331, "overlap": 0.6460223193891534, "semantic": 0.9985638317038524}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.30036045575494374, "overlap": 0.0, "semantic": 0.7509011393873594}, {"chunk_id": "p-ae67c9c86886", "combined": 0.29012593201023323, "overlap": 0.0, "semantic": 0.7253148300255831}, {"chunk_id": "p-88308230dda7", "combined": 0.22420939730903539, "overlap": 0.0, "semantic": 0.5605234932725884}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1933990964540675, "overlap": 0.0, "semantic": 0.4834977411351687}, {"chunk_id": "p-0d66effb9582", "combined": 0.18401086127753097, "overlap": 0.0, "semantic": 0.46002715319382737}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.12096674207174872, "overlap": 0.0, "semantic": 0.3024168551793718}, {"chunk_id": "p-9158b9f667b9", "combined": 0.09035699979827103, "overlap": 0.0, "semantic": 0.22589249949567755}]}
{"symbol_id": "bf880e9ced996bc9962f7463fcfe52528e42f3a0", "symbol_name": "forward_chunk", "query_text_overlap": "tensor torch forward_chunk backbone cache bb_conv_cache1 bb_conv_cache2 bb_kv_cache causal is_cache last_chunk new_bb_conv_cache1 new_bb_conv_cache2 new_bb_kv_cache new_is_cache new_up_conv_cache transpose up_conv_cache bool forward_upsample_conv_chunk", "query_text_semantic": "Args:\n            x: input sequence at 50Hz, length should be multiples of 4", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8978252764720831, "overlap_score": 1.0, "semantic_score": 0.7445631911802078}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.5785535788881755, "overlap_score": 0.6460223193891534, "semantic_score": 0.47735046813670845}, {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8978252764720831, "overlap": 1.0, "semantic": 0.7445631911802078}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5785535788881755, "overlap": 0.6460223193891534, "semantic": 0.47735046813670845}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3722383783879159, "overlap": 0.0, "semantic": 0.9305959459697897}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2799547571346766, "overlap": 0.0, "semantic": 0.6998868928366915}, {"chunk_id": "p-88308230dda7", "combined": 0.2048459865861687, "overlap": 0.0, "semantic": 0.5121149664654218}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18707058634011023, "overlap": 0.0, "semantic": 0.46767646585027556}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.1844947860943267, "overlap": 0.0, "semantic": 0.46123696523581675}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.18177336266725758, "overlap": 0.0, "semantic": 0.4544334066681439}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.03555485640133611, "overlap": 0.0, "semantic": 0.08888714100334028}]}
{"symbol_id": "b47817ead8b8cc83fdf2af1f1580fc7462953495", "symbol_name": "forward_upsample_conv_chunk", "query_text_overlap": "cache conv torch upsample_conv cache1 cache2 dim cat shape 1st not remove forward_upsample_conv_chunk new_cache new_cache1 new_cache2 tensor split stream forward", "query_text_semantic": "Stream forward upsample_conv module with previous block cache.\n\n        Args:\n            x: shape (B, C, T)\n            cache: shape (B, C, 3), where 3 denotes 1 history state for 1st conv and 2 for the rest conv.", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.35735065341917, "overlap_score": 0.0, "semantic_score": 0.893376633547925}, {"chunk_id": "p-ae67c9c86886", "score": 0.3365069753700762, "overlap_score": 0.0, "semantic_score": 0.8412674384251904}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.35735065341917, "overlap": 0.0, "semantic": 0.893376633547925}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3365069753700762, "overlap": 0.0, "semantic": 0.8412674384251904}, {"chunk_id": "p-88308230dda7", "combined": 0.2717528830133554, "overlap": 0.0, "semantic": 0.6793822075333884}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26644880706230983, "overlap": 0.0, "semantic": 0.6661220176557746}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.22323853100559937, "overlap": 0.0, "semantic": 0.5580963275139984}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2093736412729602, "overlap": 0.0, "semantic": 0.5234341031824005}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1949136960061243, "overlap": 0.0, "semantic": 0.48728424001531073}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1634780933055642, "overlap": 0.0, "semantic": 0.4086952332639105}, {"chunk_id": "p-9158b9f667b9", "combined": 0.09648005766684065, "overlap": 0.0, "semantic": 0.24120014416710162}]}
{"symbol_id": "40a98c151e7b7a59fa897017ca92e0dc403b060b", "symbol_name": "forward", "query_text_overlap": "x_lens shape backbone forward target_length tensor torch transpose y_lens isift upsample_conv upsample note strict upsampling trim last elements istft", "query_text_semantic": "Args:\n            x: shape (b, t, c)\n            x_lens: shape (b,)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.7876133916334921, "overlap_score": 0.6460223193891534, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.7102847528159126, "overlap_score": 1.0, "semantic_score": 0.2757118820397815}, {"chunk_id": "p-88308230dda7", "score": 0.3024754686554667, "overlap_score": 0.0, "semantic_score": 0.7561886716386667}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.7876133916334921, "overlap": 0.6460223193891534, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.7102847528159126, "overlap": 1.0, "semantic": 0.2757118820397815}, {"chunk_id": "p-88308230dda7", "combined": 0.3024754686554667, "overlap": 0.0, "semantic": 0.7561886716386667}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2850104961411183, "overlap": 0.0, "semantic": 0.7125262403527957}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.25005897120145076, "overlap": 0.0, "semantic": 0.6251474280036269}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17768472698323623, "overlap": 0.0, "semantic": 0.4442118174580905}, {"chunk_id": "p-edce760829b6", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.0538426537141225, "overlap": 0.0, "semantic": 0.13460663428530625}, {"chunk_id": "p-9158b9f667b9", "combined": 0.01291218599756874, "overlap": 0.0, "semantic": 0.03228046499392185}]}
{"symbol_id": "f17df20d852b9bf33285af0d46bd67a2034a5e3a", "symbol_name": "_init_weights", "query_text_overlap": "_init_weights init bias constant_ conv1d isinstance std trunc_normal_ weight", "query_text_semantic": "def _init_weights(self, m): if isinstance(m, nn.Conv1d): nn.init.trunc_normal_(m.weight, std=0.02) nn.init.constant_(m.bias, 0)", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.8330107580595207, "overlap_score": 1.0, "semantic_score": 0.582526895148802}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-62dccf79cb8d", "score": 0.23473091315399264, "overlap_score": 0.0, "semantic_score": 0.5868272828849815}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.8330107580595207, "overlap": 1.0, "semantic": 0.582526895148802}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.23473091315399264, "overlap": 0.0, "semantic": 0.5868272828849815}, {"chunk_id": "p-0d66effb9582", "combined": 0.22823837057343122, "overlap": 0.0, "semantic": 0.570595926433578}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.20859554163015492, "overlap": 0.0, "semantic": 0.5214888540753873}, {"chunk_id": "p-ae67c9c86886", "combined": 0.18715879393454413, "overlap": 0.0, "semantic": 0.4678969848363603}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.14601858980825252, "overlap": 0.0, "semantic": 0.36504647452063127}, {"chunk_id": "p-88308230dda7", "combined": 0.13200412648494964, "overlap": 0.0, "semantic": 0.3300103162123741}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11394925300116054, "overlap": 0.0, "semantic": 0.28487313250290136}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10982530762519889, "overlap": 0.0, "semantic": 0.2745632690629972}]}
{"symbol_id": "81bfbb43b4e05b9e37c5d14c78ae234768ce56c8", "symbol_name": "__init__", "query_text_overlap": "embed_dim causal hop_length num_heads num_layers int __init__ dropout padding convtranspose1d gelu kernel_size stride _init_weights apply backbone bool causalvocosbackbone float isift", "query_text_semantic": "def __init__( self, # Transformer embed_dim: int, num_layers: int, num_heads: int, dropout: float = 0.0, # iSTFT hop_length: int = 240, # Causal causal: bool = False, ): super().__init__() self.embed_dim = embed_dim self.num_layers = num_layers self.num_heads = num_heads self.hop_length = hop_length self.causal = causal # Output upsample self.upsample_conv = nn.Sequential( nn.ConvTranspose1d( embed_dim, embed_dim, kernel_size=3, stride=2, padding=0, # Do not fill input side output_padding=0, # Can be adjusted to precisely control length ), nn.GELU(), nn.ConvTranspose1d( embed_dim, embed_dim, kernel_size=3, stride=1, padding=0, # Do not fill input side ), nn.GELU(), ) self.backbone = ( CausalVocosBackbone(embed_dim, num_layers, num_heads, dropout) if causal else VocosBackbone(embed_dim, num_layers, num_heads, dropout) ) self.isift = ISTFTHead(embed_dim, hop_length * 4, hop_length, padding=\"same\") # Init weights self.apply(self._init_weights)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8535809645190687, "overlap_score": 1.0, "semantic_score": 0.6339524112976719}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.7876133916334921, "overlap_score": 0.6460223193891534, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.2801542517595865, "overlap_score": 0.0, "semantic_score": 0.7003856293989663}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8535809645190687, "overlap": 1.0, "semantic": 0.6339524112976719}, {"chunk_id": "p-021b4cb4f328", "combined": 0.7876133916334921, "overlap": 0.6460223193891534, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2801542517595865, "overlap": 0.0, "semantic": 0.7003856293989663}, {"chunk_id": "p-88308230dda7", "combined": 0.21409455696755908, "overlap": 0.0, "semantic": 0.5352363924188976}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.19738659788614224, "overlap": 0.0, "semantic": 0.4934664947153556}, {"chunk_id": "p-0d66effb9582", "combined": 0.19266503374572505, "overlap": 0.0, "semantic": 0.4816625843643126}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18783833998607802, "overlap": 0.0, "semantic": 0.469595849965195}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.14080894530737698, "overlap": 0.0, "semantic": 0.35202236326844244}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.13152848209811985, "overlap": 0.0, "semantic": 0.3288212052452996}, {"chunk_id": "p-5c1af97004f2", "combined": 0.11903100420014057, "overlap": 0.0, "semantic": 0.2975775105003514}]}
{"symbol_id": "cf5fc8b9ab04b88947ab3b61d7a78e3172411dd4", "symbol_name": "ISTFTHead", "query_text_overlap": "int torch hop_length n_fft padding tensor dim mag istft module x_pred same istfthead str __init__ forward out out_dim dimension model", "query_text_semantic": "ISTFT Head module for predicting STFT complex coefficients.\n\n    Args:\n        dim (int): Hidden dimension of the model.\n        n_fft (int): Size of Fourier transform.\n        hop_length (int): The distance between neighboring sliding window frames, which should align with\n                          the resolution of the input features.\n        padding (str, optional): Type of padding. Options are \"center\" or \"same\". Defaults to \"same\".", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8883511767326343, "overlap_score": 1.0, "semantic_score": 0.7208779418315858}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.6511145736481434, "overlap_score": 0.4185242894135724, "semantic_score": 1.0}, {"chunk_id": "p-88308230dda7", "score": 0.5712976139162913, "overlap_score": 0.3220700177374364, "semantic_score": 0.9451390081845736}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8883511767326343, "overlap": 1.0, "semantic": 0.7208779418315858}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6511145736481434, "overlap": 0.4185242894135724, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.5712976139162913, "overlap": 0.3220700177374364, "semantic": 0.9451390081845736}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5495357176310407, "overlap": 0.3469495005891114, "semantic": 0.8534150431939345}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5367024461177803, "overlap": 0.35560442305500023, "semantic": 0.8083494807119502}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.4686916654730766, "overlap": 0.2564691236808823, "semantic": 0.787025478161368}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.42622371379570045, "overlap": 0.2415129728687504, "semantic": 0.7032898251861255}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3015412133026254, "overlap": 0.0, "semantic": 0.7538530332565635}, {"chunk_id": "p-edce760829b6", "combined": 0.2532077901942344, "overlap": 0.0, "semantic": 0.633019475485586}, {"chunk_id": "p-0d66effb9582", "combined": 0.23843381224687074, "overlap": 0.0, "semantic": 0.5960845306171768}]}
{"symbol_id": "0b46a9eee310c7ba7f4155652966d5d66d5829f9", "symbol_name": "forward_chunk", "query_text_overlap": "cache mag torch shape audio x_pred forward_chunk istft last_chunk new_cache tensor bool chunk clip cos dim exp max out sin", "query_text_semantic": "ISTFTHead can be adapted in streaming inference without retraining.\n\n        Args:\n            x: shape (B, T, C)\n            cache: shape (B, N, T=3), istft cache\n        Returns:\n            audio: shape (B, t)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.39474437752064795, "overlap_score": 0.0, "semantic_score": 0.9868609438016198}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.37955171613652794, "overlap_score": 0.0, "semantic_score": 0.9488792903413198}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.39474437752064795, "overlap": 0.0, "semantic": 0.9868609438016198}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.37955171613652794, "overlap": 0.0, "semantic": 0.9488792903413198}, {"chunk_id": "p-88308230dda7", "combined": 0.36998399514211006, "overlap": 0.0, "semantic": 0.9249599878552751}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.31509156953080364, "overlap": 0.0, "semantic": 0.7877289238270091}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.31197717599448005, "overlap": 0.0, "semantic": 0.7799429399862001}, {"chunk_id": "p-5c1af97004f2", "combined": 0.30012487286892625, "overlap": 0.0, "semantic": 0.7503121821723155}, {"chunk_id": "p-9158b9f667b9", "combined": 0.28295209486587886, "overlap": 0.0, "semantic": 0.7073802371646971}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2708871508774726, "overlap": 0.0, "semantic": 0.6772178771936815}, {"chunk_id": "p-021b4cb4f328", "combined": 0.26135177494901685, "overlap": 0.0, "semantic": 0.6533794373725421}]}
{"symbol_id": "6aad161c8228237d5a85c748f87df1e02117935d", "symbol_name": "forward", "query_text_overlap": "tensor torch mag audio forward x_pred shape length signal audio_length exp x_len time produce phase chunk clip cos dim hop_length", "query_text_semantic": "Forward pass of the ISTFTHead module.\n\n        Args:\n            x (Tensor): Input tensor of shape (B, L, H), where B is the batch size,\n                        L is the sequence length, and H denotes the model dimension.\n\n        Returns:\n            Tensor: Reconstructed time-domain audio signal of shape (B, T), where T is the length of the output signal.", "best": {"chunk_id": "p-7b0c753f4b1a", "score": 0.8794894388988135, "overlap_score": 1.0, "semantic_score": 0.6987235972470339}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.7809803754067353, "overlap_score": 0.8693610360039846, "semantic_score": 0.648409384510861}, {"chunk_id": "p-0212d69b9ec4", "score": 0.40919899525537257, "overlap_score": 0.681998325425621, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-7b0c753f4b1a", "combined": 0.8794894388988135, "overlap": 1.0, "semantic": 0.6987235972470339}, {"chunk_id": "p-0d66effb9582", "combined": 0.7809803754067353, "overlap": 0.8693610360039846, "semantic": 0.648409384510861}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.40919899525537257, "overlap": 0.681998325425621, "semantic": 0.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.36510293268196353, "overlap": 0.0, "semantic": 0.9127573317049088}, {"chunk_id": "p-ae67c9c86886", "combined": 0.327529749549371, "overlap": 0.0, "semantic": 0.8188243738734274}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3236436714189167, "overlap": 0.0, "semantic": 0.8091091785472917}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.29345885772800845, "overlap": 0.0, "semantic": 0.7336471443200211}, {"chunk_id": "p-021b4cb4f328", "combined": 0.29221546985495056, "overlap": 0.0, "semantic": 0.7305386746373764}, {"chunk_id": "p-5c1af97004f2", "combined": 0.22166893878319904, "overlap": 0.0, "semantic": 0.5541723469579976}]}
{"symbol_id": "a7e6d5faca2fd84b8a97f99b5cf189796d03fcf3", "symbol_name": "__init__", "query_text_overlap": "hop_length n_fft __init__ int padding dim istft out_dim linear out str super torch win_length same", "query_text_semantic": "def __init__(self, dim: int, n_fft: int, hop_length: int, padding: str = \"same\"): super().__init__() self.hop_length = hop_length out_dim = n_fft + 2 self.out = torch.nn.Linear(dim, out_dim) self.istft = ISTFT( n_fft=n_fft, hop_length=hop_length, win_length=n_fft, padding=padding )", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8054854234198293, "overlap_score": 1.0, "semantic_score": 0.5137135585495732}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.22481736049982023, "overlap_score": 0.0, "semantic_score": 0.5620434012495505}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8054854234198293, "overlap": 1.0, "semantic": 0.5137135585495732}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.22481736049982023, "overlap": 0.0, "semantic": 0.5620434012495505}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.22245971026935699, "overlap": 0.0, "semantic": 0.5561492756733925}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1982921559363481, "overlap": 0.0, "semantic": 0.49573038984087026}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18163028832006628, "overlap": 0.0, "semantic": 0.45407572080016567}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.17003925110660767, "overlap": 0.0, "semantic": 0.4250981277665191}, {"chunk_id": "p-88308230dda7", "combined": 0.16606590419691175, "overlap": 0.0, "semantic": 0.41516476049227935}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.10079711981146999, "overlap": 0.0, "semantic": 0.251992799528675}, {"chunk_id": "p-0d66effb9582", "combined": 0.08024061392457635, "overlap": 0.0, "semantic": 0.20060153481144086}]}
{"symbol_id": "71a21c5957e675fed49cd77ec512713f19975dbe", "symbol_name": "ISTFT", "query_text_overlap": "padding int same istft window center win_length hop_length n_fft torch tensor size str custom nola pytorch __init__ spec fourier transform", "query_text_semantic": "Custom implementation of ISTFT since torch.istft doesn't allow custom padding (other than `center=True`) with\n    windowing. This is because the NOLA (Nonzero Overlap Add) check fails at the edges.\n    See issue: https://github.com/pytorch/pytorch/issues/62323\n    Specifically, in the context of neural vocoding we are interested in \"same\" padding analogous to CNNs.\n    The NOLA constraint is met as we trim padded samples anyway.\n\n    Args:\n        n_fft (int): Size of Fourier transform.\n        hop_length (int): The distance between neighboring sliding window frames.\n        win_length (int): The size of window frame and STFT filter.\n        padding (str, optional): Type of padding. Options are \"center\" or \"same\". Defaults to \"same\".", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.914691302783598, "overlap_score": 1.0, "semantic_score": 0.786728256958995}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-021b4cb4f328", "score": 0.39197990252202763, "overlap_score": 0.0, "semantic_score": 0.979949756305069}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.914691302783598, "overlap": 1.0, "semantic": 0.786728256958995}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.39197990252202763, "overlap": 0.0, "semantic": 0.979949756305069}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3547607909111068, "overlap": 0.0, "semantic": 0.886901977277767}, {"chunk_id": "p-0d66effb9582", "combined": 0.3023419150755975, "overlap": 0.0, "semantic": 0.7558547876889937}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2885154238300607, "overlap": 0.0, "semantic": 0.7212885595751517}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2693965156376571, "overlap": 0.0, "semantic": 0.6734912890941427}, {"chunk_id": "p-88308230dda7", "combined": 0.26614320527847296, "overlap": 0.0, "semantic": 0.6653580131961824}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2656465948328529, "overlap": 0.0, "semantic": 0.6641164870821322}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.24778903983744624, "overlap": 0.0, "semantic": 0.6194725995936156}]}
{"symbol_id": "fcf6c4cfd70727f02f2a8900bf1ea833d8a5ce24", "symbol_name": "forward_chunk", "query_text_overlap": "ifft shape cache hop_length win_length torch last_chunk output_size spec window window_envelope frame last dim fft fold forward_chunk functional kernel_size new_cache_t", "query_text_semantic": "Forward only one frame.\n\n        Args:\n            spec: shape (B, N, T=chunk_size)\n            cache: previous chunk's last ifft frame, shape (B, N, T=3)\n            last_chunk: if last_chunk, will not trim the last (win-hop) segment\n        Returns:\n            y: shape (B, T=effective_length)", "best": {"chunk_id": "p-ebeeda9fc683", "score": 0.6414141534343516, "overlap_score": 0.8975013881177124, "semantic_score": 0.2572833014093105}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.6038107842744871, "overlap_score": 0.47701115504928293, "semantic_score": 0.7940102281122933}, {"chunk_id": "p-0d66effb9582", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-ebeeda9fc683", "combined": 0.6414141534343516, "overlap": 0.8975013881177124, "semantic": 0.2572833014093105}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6038107842744871, "overlap": 0.47701115504928293, "semantic": 0.7940102281122933}, {"chunk_id": "p-0d66effb9582", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.5597170420272413, "overlap": 0.5933049478784319, "semantic": 0.5093351832504551}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.43787504719142845, "overlap": 0.4511303377058332, "semantic": 0.41799211141982134}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3636179723046941, "overlap": 0.0, "semantic": 0.9090449307617352}, {"chunk_id": "p-021b4cb4f328", "combined": 0.357492498411418, "overlap": 0.0, "semantic": 0.8937312460285449}, {"chunk_id": "p-88308230dda7", "combined": 0.3461321060254996, "overlap": 0.0, "semantic": 0.865330265063749}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28301143814235596, "overlap": 0.0, "semantic": 0.7075285953558899}]}
{"symbol_id": "0a2cf892bd912cd651e6c229b533e08f04417ef1", "symbol_name": "forward", "query_text_overlap": "spec tensor torch hop_length output_size pad shape win_length time ifft window center istft padding window_envelope complex spectrogram number signal dim", "query_text_semantic": "Compute the Inverse Short Time Fourier Transform (ISTFT) of a complex spectrogram.\n\n        Args:\n            spec (Tensor): Input complex spectrogram of shape (B, N, T), where B is the batch size,\n                            N is the number of frequency bins, and T is the number of time frames.\n\n        Returns:\n            Tensor: Reconstructed time-domain signal of shape (B, L), where L is the length of the output signal.", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.38730959269839765, "overlap_score": 0.0, "semantic_score": 0.9682739817459941}, {"chunk_id": "p-88308230dda7", "score": 0.3706151661288231, "overlap_score": 0.0, "semantic_score": 0.9265379153220578}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.38730959269839765, "overlap": 0.0, "semantic": 0.9682739817459941}, {"chunk_id": "p-88308230dda7", "combined": 0.3706151661288231, "overlap": 0.0, "semantic": 0.9265379153220578}, {"chunk_id": "p-0d66effb9582", "combined": 0.34586262718326954, "overlap": 0.0, "semantic": 0.8646565679581738}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2936033719096504, "overlap": 0.0, "semantic": 0.7340084297741261}, {"chunk_id": "p-5c1af97004f2", "combined": 0.28398141052256437, "overlap": 0.0, "semantic": 0.709953526306411}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.27886963824700317, "overlap": 0.0, "semantic": 0.6971740956175079}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.24465956251322463, "overlap": 0.0, "semantic": 0.6116489062830616}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24090910741201751, "overlap": 0.0, "semantic": 0.6022727685300437}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.23948490748611173, "overlap": 0.0, "semantic": 0.5987122687152793}]}
{"symbol_id": "2cdf0dc7cfd5760656ac498bc2f41d562aba552d", "symbol_name": "__init__", "query_text_overlap": "padding win_length __init__ hop_length int n_fft window same hann_window register_buffer str super torch center assert must", "query_text_semantic": "def __init__( self, n_fft: int, hop_length: int, win_length: int, padding: str = \"same\" ): super().__init__() assert padding in [\"center\", \"same\"], \"Padding must be 'center' or 'same'.\" self.padding = padding self.n_fft = n_fft self.hop_length = hop_length self.win_length = win_length window = torch.hann_window(win_length) self.register_buffer(\"window\", window)", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.9078146296340691, "overlap_score": 1.0, "semantic_score": 0.7695365740851728}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.28742485870574835, "overlap_score": 0.0, "semantic_score": 0.7185621467643709}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.9078146296340691, "overlap": 1.0, "semantic": 0.7695365740851728}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28742485870574835, "overlap": 0.0, "semantic": 0.7185621467643709}, {"chunk_id": "p-0d66effb9582", "combined": 0.2781501684395487, "overlap": 0.0, "semantic": 0.6953754210988717}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.27299565123018077, "overlap": 0.0, "semantic": 0.6824891280754519}, {"chunk_id": "p-021b4cb4f328", "combined": 0.2707093457718662, "overlap": 0.0, "semantic": 0.6767733644296655}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.24411821361888633, "overlap": 0.0, "semantic": 0.6102955340472158}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1958968875666581, "overlap": 0.0, "semantic": 0.4897422189166452}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18385148967634127, "overlap": 0.0, "semantic": 0.45962872419085316}, {"chunk_id": "p-88308230dda7", "combined": 0.18234215073911936, "overlap": 0.0, "semantic": 0.45585537684779837}]}
{"symbol_id": "3ea3b7929d83d3d9d66a535e7c74eb2ef0901cc8", "symbol_name": "CausalVocosBackbone", "query_text_overlap": "embed_dim dropout tensor torch causalresnetblock transpose int x_lens __init__ attention_mask causalvocosbackbone conv_cache1 final_norm in_proj layer num_heads num_layers post_net prior_net sequential", "query_text_semantic": "Streaming Vocos backbone based on Transformer layers", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9074857782824073, "overlap_score": 1.0, "semantic_score": 0.7687144457060181}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.25550340334744703, "overlap_score": 0.0, "semantic_score": 0.6387585083686176}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9074857782824073, "overlap": 1.0, "semantic": 0.7687144457060181}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.25550340334744703, "overlap": 0.0, "semantic": 0.6387585083686176}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2111321280254395, "overlap": 0.0, "semantic": 0.5278303200635988}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18268944720507707, "overlap": 0.0, "semantic": 0.4567236180126927}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.17657129427785012, "overlap": 0.0, "semantic": 0.44142823569462525}, {"chunk_id": "p-88308230dda7", "combined": 0.16892172204158296, "overlap": 0.0, "semantic": 0.42230430510395733}, {"chunk_id": "p-9158b9f667b9", "combined": 0.14660512465400752, "overlap": 0.0, "semantic": 0.3665128116350188}, {"chunk_id": "p-5c1af97004f2", "combined": 0.10365745245081637, "overlap": 0.0, "semantic": 0.2591436311270409}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.07192243675421815, "overlap": 0.0, "semantic": 0.1798060918855454}]}
{"symbol_id": "4882f70dde4022ed6d489451748d4e85da84057f", "symbol_name": "forward_chunk", "query_text_overlap": "forward_chunk torch new_kv_cache shape kv_cache tensor transpose embed_dim cache1 cache2 cache3 cache4 cache5 conv_cache2 dim conv_cache1 idx kv_cache_i layer new_cache1", "query_text_semantic": "def forward_chunk( self, x: torch.Tensor, conv_cache1: torch.Tensor = None, conv_cache2: torch.Tensor = None, kv_cache: torch.Tensor = None, ): # Unpack cache cache1 = conv_cache1 cache2, cache3, cache4, cache5 = ( (None, None, None, None) if conv_cache2 is None else conv_cache2.chunk(4, dim=1) ) # cache1: shape (b, c=embed_dim, t=6) x = x.transpose(1, 2) x, new_cache1 = self.in_proj.forward_chunk(x, cache1) # cache2: shape (b, c=embed_dim*2, t=2) x, new_cache2 = self.prior_net[0].forward_chunk(x, cache2) # cache3: shape (b, c=embed_dim*2, t=2) x, new_cache3 = self.prior_net[1].forward_chunk(x, cache3) x = x.transpose(1, 2) # k,v-cache: shape (b, nlayer, nh, t, c*2) new_kv_cache = [] for idx, layer in enumerate(self.transformers): kv_cache_i = None if kv_cache is None else kv_cache[:, idx] x, new_kv_cache_i = layer.forward_chunk(x, kv_cache=kv_cache_i) new_kv_cache.append(new_kv_cache_i) new_kv_cache = torch.stack(new_kv_cache, dim=1) x", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9009367643036024, "overlap_score": 1.0, "semantic_score": 0.752341910759006}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.24089735115301744, "overlap_score": 0.0, "semantic_score": 0.6022433778825436}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9009367643036024, "overlap": 1.0, "semantic": 0.752341910759006}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24089735115301744, "overlap": 0.0, "semantic": 0.6022433778825436}, {"chunk_id": "p-88308230dda7", "combined": 0.22275748303290183, "overlap": 0.0, "semantic": 0.5568937075822545}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.20733503491431554, "overlap": 0.0, "semantic": 0.5183375872857888}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.16013143838927046, "overlap": 0.0, "semantic": 0.40032859597317616}, {"chunk_id": "p-5c1af97004f2", "combined": 0.15948491296453893, "overlap": 0.0, "semantic": 0.3987122824113473}, {"chunk_id": "p-edce760829b6", "combined": 0.1495925971514383, "overlap": 0.0, "semantic": 0.3739814928785957}, {"chunk_id": "p-0d66effb9582", "combined": 0.14904298873110247, "overlap": 0.0, "semantic": 0.37260747182775616}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1308364990003668, "overlap": 0.0, "semantic": 0.327091247500917}]}
{"symbol_id": "323fd0267a5398870333904799cd5c2f9c989ed5", "symbol_name": "forward", "query_text_overlap": "transpose x_lens shape attention_mask forward layer tensor torch chunk_size final_norm in_proj make_block_causal_mask post_net prior_net transformers attention latents causal note sfy", "query_text_semantic": "Args:\n            x: shape (b, t, c)\n            x_lens: shape (b,)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.7102847528159126, "overlap_score": 1.0, "semantic_score": 0.2757118820397815}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.36552250941999986, "overlap_score": 0.3130629707279394, "semantic_score": 0.4442118174580905}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.7102847528159126, "overlap": 1.0, "semantic": 0.2757118820397815}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.36552250941999986, "overlap": 0.3130629707279394, "semantic": 0.4442118174580905}, {"chunk_id": "p-88308230dda7", "combined": 0.3024754686554667, "overlap": 0.0, "semantic": 0.7561886716386667}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2850104961411183, "overlap": 0.0, "semantic": 0.7125262403527957}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.25005897120145076, "overlap": 0.0, "semantic": 0.6251474280036269}, {"chunk_id": "p-edce760829b6", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.0538426537141225, "overlap": 0.0, "semantic": 0.13460663428530625}, {"chunk_id": "p-9158b9f667b9", "combined": 0.01291218599756874, "overlap": 0.0, "semantic": 0.03228046499392185}]}
{"symbol_id": "7184e72be0e3d6700e894f91d78032ce0331d9da", "symbol_name": "__init__", "query_text_overlap": "embed_dim dropout causalresnetblock __init__ int num_heads num_layers sequential causalconv1d eps final_norm float in_proj kernel_size layernorm modulelist post_net prior_net range super", "query_text_semantic": "def __init__( self, embed_dim: int = 1024, num_layers: int = 12, num_heads: int = 16, dropout: float = 0.1, ): super().__init__() self.in_proj = CausalConv1d(embed_dim, embed_dim, kernel_size=7) self.prior_net = nn.Sequential( CausalResnetBlock(embed_dim, embed_dim, dropout=dropout), CausalResnetBlock(embed_dim, embed_dim, dropout=dropout), ) self.transformers = nn.ModuleList( [WhisperEncoderLayer(embed_dim, num_heads) for _ in range(num_layers)] ) self.post_net = nn.Sequential( CausalResnetBlock(embed_dim, embed_dim, dropout=dropout), CausalResnetBlock(embed_dim, embed_dim, dropout=dropout), ) self.final_norm = nn.LayerNorm(embed_dim, eps=1e-6)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.34190002454185536, "overlap_score": 0.0, "semantic_score": 0.8547500613546384}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.33756532343969997, "overlap_score": 0.0, "semantic_score": 0.8439133085992498}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.34190002454185536, "overlap": 0.0, "semantic": 0.8547500613546384}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.33756532343969997, "overlap": 0.0, "semantic": 0.8439133085992498}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28872198534107446, "overlap": 0.0, "semantic": 0.7218049633526861}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2719230362174218, "overlap": 0.0, "semantic": 0.6798075905435546}, {"chunk_id": "p-88308230dda7", "combined": 0.266333423877161, "overlap": 0.0, "semantic": 0.6658335596929025}, {"chunk_id": "p-0d66effb9582", "combined": 0.24131845793267145, "overlap": 0.0, "semantic": 0.6032961448316786}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.22231555845499684, "overlap": 0.0, "semantic": 0.555788896137492}, {"chunk_id": "p-5c1af97004f2", "combined": 0.22215713406176885, "overlap": 0.0, "semantic": 0.5553928351544221}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.21193502535609446, "overlap": 0.0, "semantic": 0.5298375633902361}]}
{"symbol_id": "01164d5a72c962b3fa1639ff8024163074ea675e", "symbol_name": "VocosBackbone", "query_text_overlap": "embed_dim dropout resnetblock transpose int x_lens __init__ attention_mask final_norm in_proj layer num_heads num_layers post_net prior_net sequential tensor torch transformers vocosbackbone", "query_text_semantic": "Nonstreaming Vocos backbone based on Transformer layers", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.9333796617049654, "overlap_score": 1.0, "semantic_score": 0.8334491542624136}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.23788198969610216, "overlap_score": 0.0, "semantic_score": 0.5947049742402554}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.9333796617049654, "overlap": 1.0, "semantic": 0.8334491542624136}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.23788198969610216, "overlap": 0.0, "semantic": 0.5947049742402554}, {"chunk_id": "p-ae67c9c86886", "combined": 0.20615586171534261, "overlap": 0.0, "semantic": 0.5153896542883565}, {"chunk_id": "p-88308230dda7", "combined": 0.1900786259740022, "overlap": 0.0, "semantic": 0.4751965649350055}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1821309130669662, "overlap": 0.0, "semantic": 0.45532728266741546}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.17895193854286529, "overlap": 0.0, "semantic": 0.44737984635716316}, {"chunk_id": "p-9158b9f667b9", "combined": 0.13501162088004323, "overlap": 0.0, "semantic": 0.33752905220010804}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.10917121493515809, "overlap": 0.0, "semantic": 0.2729280373378952}, {"chunk_id": "p-5c1af97004f2", "combined": 0.09629581587276397, "overlap": 0.0, "semantic": 0.2407395396819099}]}
{"symbol_id": "2d6b0f95b3a7bf2c27aa91a6c7ebdcd6572e05ea", "symbol_name": "forward", "query_text_overlap": "transpose x_lens shape attention_mask forward layer tensor torch final_norm in_proj make_nonpad_mask post_net prior_net transformers unsqueeze note sfy think positional embedding", "query_text_semantic": "Args:\n            x: shape (b, t, c)\n            x_lens: shape (b,)", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.7102847528159126, "overlap_score": 1.0, "semantic_score": 0.2757118820397815}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-88308230dda7", "score": 0.3024754686554667, "overlap_score": 0.0, "semantic_score": 0.7561886716386667}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.7102847528159126, "overlap": 1.0, "semantic": 0.2757118820397815}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.3024754686554667, "overlap": 0.0, "semantic": 0.7561886716386667}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2850104961411183, "overlap": 0.0, "semantic": 0.7125262403527957}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.25005897120145076, "overlap": 0.0, "semantic": 0.6251474280036269}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17768472698323623, "overlap": 0.0, "semantic": 0.4442118174580905}, {"chunk_id": "p-edce760829b6", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1578477386422788, "overlap": 0.0, "semantic": 0.394619346605697}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.0538426537141225, "overlap": 0.0, "semantic": 0.13460663428530625}, {"chunk_id": "p-9158b9f667b9", "combined": 0.01291218599756874, "overlap": 0.0, "semantic": 0.03228046499392185}]}
{"symbol_id": "0fa3617f8c84dac2376f544d68c74624c4e2a20a", "symbol_name": "__init__", "query_text_overlap": "embed_dim dropout resnetblock __init__ int num_heads num_layers sequential conv1d eps final_norm float in_proj kernel_size layernorm modulelist padding post_net prior_net range", "query_text_semantic": "def __init__( self, embed_dim: int = 1024, num_layers: int = 12, num_heads: int = 16, dropout: float = 0.1, ): super().__init__() self.in_proj = nn.Conv1d(embed_dim, embed_dim, kernel_size=7, padding=3) self.prior_net = nn.Sequential( ResnetBlock(embed_dim, embed_dim, dropout=dropout), ResnetBlock(embed_dim, embed_dim, dropout=dropout), ) self.transformers = nn.ModuleList( [WhisperEncoderLayer(embed_dim, num_heads) for _ in range(num_layers)] ) self.post_net = nn.Sequential( ResnetBlock(embed_dim, embed_dim, dropout=dropout), ResnetBlock(embed_dim, embed_dim, dropout=dropout), ) self.final_norm = nn.LayerNorm(embed_dim, eps=1e-6)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.38087309396386226, "overlap_score": 0.0, "semantic_score": 0.9521827349096557}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.35425275231414494, "overlap_score": 0.0, "semantic_score": 0.8856318807853623}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.38087309396386226, "overlap": 0.0, "semantic": 0.9521827349096557}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.35425275231414494, "overlap": 0.0, "semantic": 0.8856318807853623}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.29997344083085037, "overlap": 0.0, "semantic": 0.7499336020771259}, {"chunk_id": "p-88308230dda7", "combined": 0.2685612805139012, "overlap": 0.0, "semantic": 0.671403201284753}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24824506499170537, "overlap": 0.0, "semantic": 0.6206126624792634}, {"chunk_id": "p-0d66effb9582", "combined": 0.23967496402936345, "overlap": 0.0, "semantic": 0.5991874100734086}, {"chunk_id": "p-5c1af97004f2", "combined": 0.23151278842744125, "overlap": 0.0, "semantic": 0.5787819710686031}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.22580082253534906, "overlap": 0.0, "semantic": 0.5645020563383726}, {"chunk_id": "p-9158b9f667b9", "combined": 0.20558619705794842, "overlap": 0.0, "semantic": 0.513965492644871}]}
{"symbol_id": "c03e8287d4a95761b92f9d5b3a623adac5bde60f", "symbol_name": "CausalResnetBlock", "query_text_overlap": "out_channels in_channels block1 block2 torch cache transpose dropout forward_chunk kernel_size nin_shortcut tensor __init__ cache1 cache2 causalconv1d causalresnetblock dim int layernorm", "query_text_semantic": "A causal variant of ResnetBlock", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.31282820548106605, "overlap_score": 0.0, "semantic_score": 0.7820705137026651}, {"chunk_id": "p-3c728ae39fa1", "score": 0.295514887531004, "overlap_score": 0.0, "semantic_score": 0.73878721882751}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.31282820548106605, "overlap": 0.0, "semantic": 0.7820705137026651}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.295514887531004, "overlap": 0.0, "semantic": 0.73878721882751}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.20823064019495377, "overlap": 0.0, "semantic": 0.5205766004873844}, {"chunk_id": "p-88308230dda7", "combined": 0.17407854071722742, "overlap": 0.0, "semantic": 0.43519635179306854}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17096728266370803, "overlap": 0.0, "semantic": 0.42741820665927005}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.16467062916285274, "overlap": 0.0, "semantic": 0.41167657290713183}, {"chunk_id": "p-9158b9f667b9", "combined": 0.11527715679383087, "overlap": 0.0, "semantic": 0.28819289198457715}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1037492298371509, "overlap": 0.0, "semantic": 0.25937307459287723}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.09722156079104505, "overlap": 0.0, "semantic": 0.2430539019776126}]}
{"symbol_id": "211653064e6cb0a0ef347dee1eb25d350fe84198", "symbol_name": "forward_chunk", "query_text_overlap": "cache forward_chunk block1 block2 torch shape cache1 cache2 dim in_channels new_cache new_cache1 new_cache2 out_channels tensor cat nin_shortcut split c_in c_out", "query_text_semantic": "Args:\n            x: shape (b, c, t)\n            cache: shape (b, c_in+c_out, t=2)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.2791985448555849, "overlap_score": 0.0, "semantic_score": 0.6979963621389622}, {"chunk_id": "p-ae67c9c86886", "score": 0.274416362127236, "overlap_score": 0.0, "semantic_score": 0.68604090531809}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2791985448555849, "overlap": 0.0, "semantic": 0.6979963621389622}, {"chunk_id": "p-ae67c9c86886", "combined": 0.274416362127236, "overlap": 0.0, "semantic": 0.68604090531809}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.18043429189232293, "overlap": 0.0, "semantic": 0.4510857297308073}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17016137023102393, "overlap": 0.0, "semantic": 0.4254034255775598}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.1552492083342861, "overlap": 0.0, "semantic": 0.3881230208357152}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.12844695346238807, "overlap": 0.0, "semantic": 0.3211173836559702}, {"chunk_id": "p-88308230dda7", "combined": 0.08651748778470993, "overlap": 0.0, "semantic": 0.2162937194617748}, {"chunk_id": "p-0d66effb9582", "combined": 0.07873371302799458, "overlap": 0.0, "semantic": 0.19683428256998642}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.048586141613913385, "overlap": 0.0, "semantic": 0.12146535403478345}]}
{"symbol_id": "578240bcba75f57915e357d39e832d933ac63263", "symbol_name": "forward", "query_text_overlap": "forward block1 block2 in_channels nin_shortcut out_channels tensor torch shape", "query_text_semantic": "Args:\n            x: shape (b, c, t)", "best": {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.30355833864728266, "overlap_score": 0.0, "semantic_score": 0.7588958466182066}, {"chunk_id": "p-62dccf79cb8d", "score": 0.2635818573266494, "overlap_score": 0.0, "semantic_score": 0.6589546433166235}], "topk_raw": [{"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.30355833864728266, "overlap": 0.0, "semantic": 0.7588958466182066}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2635818573266494, "overlap": 0.0, "semantic": 0.6589546433166235}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.18308708413986063, "overlap": 0.0, "semantic": 0.45771771034965153}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17678117609833394, "overlap": 0.0, "semantic": 0.4419529402458348}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1535452750592281, "overlap": 0.0, "semantic": 0.38386318764807026}, {"chunk_id": "p-edce760829b6", "combined": 0.13479685245365666, "overlap": 0.0, "semantic": 0.33699213113414167}, {"chunk_id": "p-9158b9f667b9", "combined": 0.13479685245365666, "overlap": 0.0, "semantic": 0.33699213113414167}, {"chunk_id": "p-021b4cb4f328", "combined": 0.11190721160462747, "overlap": 0.0, "semantic": 0.27976802901156866}, {"chunk_id": "p-88308230dda7", "combined": 0.06722923891955598, "overlap": 0.0, "semantic": 0.16807309729888995}]}
{"symbol_id": "e0e9039313caaa455016910cac6ce11732898e8a", "symbol_name": "__init__", "query_text_overlap": "out_channels in_channels transpose __init__ dropout kernel_size causalconv1d int layernorm sequential silu block1 block2 conv1d float nin_shortcut padding stride super torch", "query_text_semantic": "def __init__( self, in_channels: int, out_channels: int = None, dropout: float = 0.0, ): super().__init__() self.in_channels = in_channels out_channels = in_channels if out_channels is None else out_channels self.out_channels = out_channels self.block1 = nn.Sequential( Transpose(1, 2), nn.LayerNorm(in_channels), Transpose(1, 2), nn.SiLU(), CausalConv1d(in_channels, out_channels, kernel_size=3), ) self.block2 = nn.Sequential( Transpose(1, 2), nn.LayerNorm(out_channels), Transpose(1, 2), nn.SiLU(), nn.Dropout(dropout), CausalConv1d(out_channels, out_channels, kernel_size=3), ) if self.in_channels != self.out_channels: self.nin_shortcut = torch.nn.Conv1d( in_channels, out_channels, kernel_size=1, stride=1, padding=0 )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.29758642766032073, "overlap_score": 0.0, "semantic_score": 0.7439660691508018}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.2862444862099005, "overlap_score": 0.0, "semantic_score": 0.7156112155247513}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.29758642766032073, "overlap": 0.0, "semantic": 0.7439660691508018}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2862444862099005, "overlap": 0.0, "semantic": 0.7156112155247513}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24444107140501609, "overlap": 0.0, "semantic": 0.6111026785125402}, {"chunk_id": "p-0d66effb9582", "combined": 0.22449625312540716, "overlap": 0.0, "semantic": 0.5612406328135179}, {"chunk_id": "p-88308230dda7", "combined": 0.17417297440097984, "overlap": 0.0, "semantic": 0.4354324360024496}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.17162147486510404, "overlap": 0.0, "semantic": 0.42905368716276004}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.16049662464160705, "overlap": 0.0, "semantic": 0.4012415616040176}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.15534377084244733, "overlap": 0.0, "semantic": 0.3883594271061183}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.14131623346901986, "overlap": 0.0, "semantic": 0.3532905836725497}]}
{"symbol_id": "509d4e3707888a358d2c9cb6a62db215f712a0f7", "symbol_name": "CausalConv1d", "query_text_overlap": "causalconv1d torch causal_padding cnn_cache forward in_channels int kernel_size super tensor __init__ conv1d new_cnn_cache out_channels cat dim forward_chunk new_zeros pad shape", "query_text_semantic": "A causal variant of Conv1d", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.2779436522417288, "overlap_score": 0.0, "semantic_score": 0.6948591306043219}, {"chunk_id": "p-021b4cb4f328", "score": 0.22153662683256023, "overlap_score": 0.0, "semantic_score": 0.5538415670814005}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2779436522417288, "overlap": 0.0, "semantic": 0.6948591306043219}, {"chunk_id": "p-021b4cb4f328", "combined": 0.22153662683256023, "overlap": 0.0, "semantic": 0.5538415670814005}, {"chunk_id": "p-ae67c9c86886", "combined": 0.21870356777822844, "overlap": 0.0, "semantic": 0.5467589194455711}, {"chunk_id": "p-88308230dda7", "combined": 0.18136781692295315, "overlap": 0.0, "semantic": 0.45341954230738285}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.15663980516047535, "overlap": 0.0, "semantic": 0.39159951290118833}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.10899095961706323, "overlap": 0.0, "semantic": 0.27247739904265805}, {"chunk_id": "p-9158b9f667b9", "combined": 0.0957230311716826, "overlap": 0.0, "semantic": 0.23930757792920648}, {"chunk_id": "p-5c1af97004f2", "combined": 0.07998987298479138, "overlap": 0.0, "semantic": 0.19997468246197841}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.06696019761703353, "overlap": 0.0, "semantic": 0.16740049404258384}]}
{"symbol_id": "33c8424102f12e1bf3b0c5d54b7dcc9a0e3689c7", "symbol_name": "forward_chunk", "query_text_overlap": "cnn_cache torch causal_padding forward_chunk new_cnn_cache tensor cat causalconv1d dim forward in_channels new_zeros shape super", "query_text_semantic": "def forward_chunk(self, x: torch.Tensor, cnn_cache: torch.Tensor = None): if cnn_cache is None: cnn_cache = x.new_zeros( (x.shape[0], self.in_channels, self.causal_padding[0]) ) x = torch.cat([cnn_cache, x], dim=2) new_cnn_cache = x[..., -self.causal_padding[0] :] x = super(CausalConv1d, self).forward(x) return x, new_cnn_cache", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.30671993663593833, "overlap_score": 0.0, "semantic_score": 0.7667998415898458}, {"chunk_id": "p-ae67c9c86886", "score": 0.2848760960912688, "overlap_score": 0.0, "semantic_score": 0.7121902402281719}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.30671993663593833, "overlap": 0.0, "semantic": 0.7667998415898458}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2848760960912688, "overlap": 0.0, "semantic": 0.7121902402281719}, {"chunk_id": "p-5c1af97004f2", "combined": 0.20954704558709025, "overlap": 0.0, "semantic": 0.5238676139677256}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.20580641589361715, "overlap": 0.0, "semantic": 0.5145160397340428}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.20152167737273108, "overlap": 0.0, "semantic": 0.5038041934318277}, {"chunk_id": "p-88308230dda7", "combined": 0.17860535127411362, "overlap": 0.0, "semantic": 0.446513378185284}, {"chunk_id": "p-0d66effb9582", "combined": 0.1784805432738159, "overlap": 0.0, "semantic": 0.44620135818453976}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.13351868302953068, "overlap": 0.0, "semantic": 0.3337967075738267}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1329393584993835, "overlap": 0.0, "semantic": 0.3323483962484587}]}
{"symbol_id": "ffdbb2bcc0deaa801fc1bd1ed39d479e9d225186", "symbol_name": "forward", "query_text_overlap": "forward causal_padding causalconv1d pad super tensor torch", "query_text_semantic": "def forward(self, x: torch.Tensor): x = F.pad(x, self.causal_padding) x = super(CausalConv1d, self).forward(x) return x", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.24751568416277583, "overlap_score": 0.0, "semantic_score": 0.6187892104069396}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.23045279955017106, "overlap_score": 0.0, "semantic_score": 0.5761319988754277}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.24751568416277583, "overlap": 0.0, "semantic": 0.6187892104069396}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.23045279955017106, "overlap": 0.0, "semantic": 0.5761319988754277}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18699481744945232, "overlap": 0.0, "semantic": 0.46748704362363075}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18308093526611224, "overlap": 0.0, "semantic": 0.4577023381652806}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17491997329221812, "overlap": 0.0, "semantic": 0.4372999332305453}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1346759228956537, "overlap": 0.0, "semantic": 0.3366898072391342}, {"chunk_id": "p-edce760829b6", "combined": 0.11317956922901014, "overlap": 0.0, "semantic": 0.28294892307252534}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.08740923146587296, "overlap": 0.0, "semantic": 0.21852307866468237}, {"chunk_id": "p-88308230dda7", "combined": 0.08631820623234633, "overlap": 0.0, "semantic": 0.21579551558086582}]}
{"symbol_id": "d53d96ec9b317c5d44c9f3f3e5c6324a1eda7cc7", "symbol_name": "__init__", "query_text_overlap": "__init__ int kernel_size in_channels out_channels causal_padding causalconv1d super", "query_text_semantic": "def __init__( self, in_channels: int, out_channels: int, kernel_size: int, ) -> None: super(CausalConv1d, self).__init__(in_channels, out_channels, kernel_size) self.causal_padding = (kernel_size - 1, 0)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.28222207030462204, "overlap_score": 0.0, "semantic_score": 0.705555175761555}, {"chunk_id": "p-ae67c9c86886", "score": 0.2508243581105659, "overlap_score": 0.0, "semantic_score": 0.6270608952764147}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.28222207030462204, "overlap": 0.0, "semantic": 0.705555175761555}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2508243581105659, "overlap": 0.0, "semantic": 0.6270608952764147}, {"chunk_id": "p-0d66effb9582", "combined": 0.2156558642285598, "overlap": 0.0, "semantic": 0.5391396605713995}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.20910496608480195, "overlap": 0.0, "semantic": 0.5227624152120048}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1786357588278038, "overlap": 0.0, "semantic": 0.4465893970695095}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1759147318193323, "overlap": 0.0, "semantic": 0.4397868295483307}, {"chunk_id": "p-5c1af97004f2", "combined": 0.15121039535580585, "overlap": 0.0, "semantic": 0.3780259883895146}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.13617351410877845, "overlap": 0.0, "semantic": 0.3404337852719461}, {"chunk_id": "p-88308230dda7", "combined": 0.12629282994827207, "overlap": 0.0, "semantic": 0.31573207487068017}]}
{"symbol_id": "7c38fd6697196b89c6a89c77ed4e8e64c44a274e", "symbol_name": "Transpose", "query_text_overlap": "dim0 dim1 torch transpose __init__ int forward module super tensor", "query_text_semantic": "class Transpose(torch.nn.Module): def __init__(self, dim0: int, dim1: int): super().__init__() self.dim0 = dim0 self.dim1 = dim1 def forward(self, x: torch.Tensor): x = torch.transpose(x, self.dim0, self.dim1) return x", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.22076865880191876, "overlap_score": 0.0, "semantic_score": 0.5519216470047968}, {"chunk_id": "p-ae67c9c86886", "score": 0.17508250519842286, "overlap_score": 0.0, "semantic_score": 0.43770626299605714}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.22076865880191876, "overlap": 0.0, "semantic": 0.5519216470047968}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17508250519842286, "overlap": 0.0, "semantic": 0.43770626299605714}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.17464018097035527, "overlap": 0.0, "semantic": 0.4366004524258882}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1659415328759748, "overlap": 0.0, "semantic": 0.41485383218993693}, {"chunk_id": "p-0d66effb9582", "combined": 0.14302963851452874, "overlap": 0.0, "semantic": 0.3575740962863218}, {"chunk_id": "p-88308230dda7", "combined": 0.12158899778572052, "overlap": 0.0, "semantic": 0.3039724944643013}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.11127387361781987, "overlap": 0.0, "semantic": 0.27818468404454966}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.091937064220529, "overlap": 0.0, "semantic": 0.22984266055132246}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.07272183472731444, "overlap": 0.0, "semantic": 0.1818045868182861}]}
{"symbol_id": "f7da6fd816ac7b4586e317196d1c5b2d204604b5", "symbol_name": "forward", "query_text_overlap": "forward torch dim0 dim1 tensor transpose", "query_text_semantic": "def forward(self, x: torch.Tensor): x = torch.transpose(x, self.dim0, self.dim1) return x", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.23734377189310357, "overlap_score": 0.0, "semantic_score": 0.5933594297327589}, {"chunk_id": "p-ae67c9c86886", "score": 0.1902818488900102, "overlap_score": 0.0, "semantic_score": 0.4757046222250255}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.23734377189310357, "overlap": 0.0, "semantic": 0.5933594297327589}, {"chunk_id": "p-ae67c9c86886", "combined": 0.1902818488900102, "overlap": 0.0, "semantic": 0.4757046222250255}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18072761749895921, "overlap": 0.0, "semantic": 0.451819043747398}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.14290965493336721, "overlap": 0.0, "semantic": 0.357274137333418}, {"chunk_id": "p-88308230dda7", "combined": 0.1326476872314416, "overlap": 0.0, "semantic": 0.331619218078604}, {"chunk_id": "p-0d66effb9582", "combined": 0.12311724529621833, "overlap": 0.0, "semantic": 0.3077931132405458}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.11175331601541592, "overlap": 0.0, "semantic": 0.2793832900385398}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.06979070319010554, "overlap": 0.0, "semantic": 0.17447675797526385}, {"chunk_id": "p-edce760829b6", "combined": 0.06448541693397404, "overlap": 0.0, "semantic": 0.1612135423349351}]}
{"symbol_id": "bb2fd6868506bf07ff0591a317caff4c3f71c36b", "symbol_name": "__init__", "query_text_overlap": "__init__ dim0 dim1 int super", "query_text_semantic": "def __init__(self, dim0: int, dim1: int): super().__init__() self.dim0 = dim0 self.dim1 = dim1", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.3794059224479253, "overlap_score": 0.0, "semantic_score": 0.9485148061198132}, {"chunk_id": "p-3c728ae39fa1", "score": 0.3434252328606914, "overlap_score": 0.0, "semantic_score": 0.8585630821517284}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.3794059224479253, "overlap": 0.0, "semantic": 0.9485148061198132}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3434252328606914, "overlap": 0.0, "semantic": 0.8585630821517284}, {"chunk_id": "p-ae67c9c86886", "combined": 0.30958623735037955, "overlap": 0.0, "semantic": 0.7739655933759488}, {"chunk_id": "p-88308230dda7", "combined": 0.2859589885687351, "overlap": 0.0, "semantic": 0.7148974714218377}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28221653939488006, "overlap": 0.0, "semantic": 0.7055413484872002}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2652155869326535, "overlap": 0.0, "semantic": 0.6630389673316338}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.260873779568282, "overlap": 0.0, "semantic": 0.652184448920705}, {"chunk_id": "p-0d66effb9582", "combined": 0.24504029493682997, "overlap": 0.0, "semantic": 0.6126007373420749}, {"chunk_id": "p-edce760829b6", "combined": 0.19515892602581558, "overlap": 0.0, "semantic": 0.48789731506453893}]}
{"symbol_id": "6b66043268c99545b3062246f801439f5bae3d0c", "symbol_name": "ResnetBlock", "query_text_overlap": "out_channels in_channels conv1d conv_shortcut kernel_size padding stride dropout torch use_conv_shortcut __init__ affine block1 block2 eps groupnorm int nin_shortcut num_channels num_groups", "query_text_semantic": "class ResnetBlock(nn.Module): def __init__( self, in_channels: int, out_channels: int = None, conv_shortcut: bool = False, dropout: float = 0.0, ): super().__init__() self.in_channels = in_channels out_channels = in_channels if out_channels is None else out_channels self.out_channels = out_channels self.use_conv_shortcut = conv_shortcut self.block1 = nn.Sequential( nn.GroupNorm( num_groups=32, num_channels=in_channels, eps=1e-6, affine=True ), nn.SiLU(), nn.Conv1d(in_channels, out_channels, kernel_size=3, stride=1, padding=1), ) self.block2 = nn.Sequential( nn.GroupNorm( num_groups=32, num_channels=out_channels, eps=1e-6, affine=True ), nn.SiLU(), nn.Dropout(dropout), nn.Conv1d(out_channels, out_channels, kernel_size=3, stride=1, padding=1), ) if self.in_channels != self.out_channels: if self.use_conv_shortcut: self.conv_shortcut = torch.nn.Conv1d( in_channels, out_channels, kernel_size=3, stride=1, padding=1 ) else: self.nin_shortcut = torch.nn.Conv1d( in_channels, out_channels, kernel_size=1, stride=1, padding=0 ) def forward(self, x: torch.Tensor): \"\"\" Args: x: shape (b, c, t) \"\"\" h = x h = self.block1(h) h = self.block2(h) if self.in_channels", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.32559624543250854, "overlap_score": 0.0, "semantic_score": 0.8139906135812713}, {"chunk_id": "p-3c728ae39fa1", "score": 0.26190025159151875, "overlap_score": 0.0, "semantic_score": 0.6547506289787969}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.32559624543250854, "overlap": 0.0, "semantic": 0.8139906135812713}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.26190025159151875, "overlap": 0.0, "semantic": 0.6547506289787969}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2402521519949059, "overlap": 0.0, "semantic": 0.6006303799872648}, {"chunk_id": "p-88308230dda7", "combined": 0.20338582088738946, "overlap": 0.0, "semantic": 0.5084645522184736}, {"chunk_id": "p-0d66effb9582", "combined": 0.20136654984890498, "overlap": 0.0, "semantic": 0.5034163746222624}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.19418276348996047, "overlap": 0.0, "semantic": 0.48545690872490116}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15724910713034654, "overlap": 0.0, "semantic": 0.3931227678258663}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1377008470195902, "overlap": 0.0, "semantic": 0.3442521175489755}, {"chunk_id": "p-5c1af97004f2", "combined": 0.13520690327582746, "overlap": 0.0, "semantic": 0.3380172581895686}]}
{"symbol_id": "dc7a898d17cfbb9febbf1715c02ebeb9fa6dd960", "symbol_name": "forward", "query_text_overlap": "forward block1 block2 conv_shortcut in_channels nin_shortcut out_channels tensor torch use_conv_shortcut shape else", "query_text_semantic": "Args:\n            x: shape (b, c, t)", "best": {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.30355833864728266, "overlap_score": 0.0, "semantic_score": 0.7588958466182066}, {"chunk_id": "p-62dccf79cb8d", "score": 0.2635818573266494, "overlap_score": 0.0, "semantic_score": 0.6589546433166235}], "topk_raw": [{"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.30355833864728266, "overlap": 0.0, "semantic": 0.7588958466182066}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2635818573266494, "overlap": 0.0, "semantic": 0.6589546433166235}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.18308708413986063, "overlap": 0.0, "semantic": 0.45771771034965153}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17678117609833394, "overlap": 0.0, "semantic": 0.4419529402458348}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1535452750592281, "overlap": 0.0, "semantic": 0.38386318764807026}, {"chunk_id": "p-edce760829b6", "combined": 0.13479685245365666, "overlap": 0.0, "semantic": 0.33699213113414167}, {"chunk_id": "p-9158b9f667b9", "combined": 0.13479685245365666, "overlap": 0.0, "semantic": 0.33699213113414167}, {"chunk_id": "p-021b4cb4f328", "combined": 0.11190721160462747, "overlap": 0.0, "semantic": 0.27976802901156866}, {"chunk_id": "p-88308230dda7", "combined": 0.06722923891955598, "overlap": 0.0, "semantic": 0.16807309729888995}]}
{"symbol_id": "1f4c5dfe2c8a00de601ae3a4087fe5e1e24def74", "symbol_name": "__init__", "query_text_overlap": "out_channels in_channels conv1d kernel_size padding stride __init__ conv_shortcut dropout affine eps groupnorm int num_channels num_groups sequential silu torch use_conv_shortcut block1", "query_text_semantic": "def __init__( self, in_channels: int, out_channels: int = None, conv_shortcut: bool = False, dropout: float = 0.0, ): super().__init__() self.in_channels = in_channels out_channels = in_channels if out_channels is None else out_channels self.out_channels = out_channels self.use_conv_shortcut = conv_shortcut self.block1 = nn.Sequential( nn.GroupNorm( num_groups=32, num_channels=in_channels, eps=1e-6, affine=True ), nn.SiLU(), nn.Conv1d(in_channels, out_channels, kernel_size=3, stride=1, padding=1), ) self.block2 = nn.Sequential( nn.GroupNorm( num_groups=32, num_channels=out_channels, eps=1e-6, affine=True ), nn.SiLU(), nn.Dropout(dropout), nn.Conv1d(out_channels, out_channels, kernel_size=3, stride=1, padding=1), ) if self.in_channels != self.out_channels: if self.use_conv_shortcut: self.conv_shortcut = torch.nn.Conv1d( in_channels, out_channels, kernel_size=3, stride=1, padding=1 ) else: self.nin_shortcut = torch.nn.Conv1d( in_channels, out_channels, kernel_size=1, stride=1, padding=0 )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.29728433201078025, "overlap_score": 0.0, "semantic_score": 0.7432108300269505}, {"chunk_id": "p-3c728ae39fa1", "score": 0.279729599752857, "overlap_score": 0.0, "semantic_score": 0.6993239993821425}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.29728433201078025, "overlap": 0.0, "semantic": 0.7432108300269505}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.279729599752857, "overlap": 0.0, "semantic": 0.6993239993821425}, {"chunk_id": "p-ae67c9c86886", "combined": 0.24560948180663367, "overlap": 0.0, "semantic": 0.6140237045165842}, {"chunk_id": "p-0d66effb9582", "combined": 0.21763894530808725, "overlap": 0.0, "semantic": 0.5440973632702181}, {"chunk_id": "p-88308230dda7", "combined": 0.21046552793384313, "overlap": 0.0, "semantic": 0.5261638198346078}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.186103334355411, "overlap": 0.0, "semantic": 0.46525833588852744}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.18415228803223926, "overlap": 0.0, "semantic": 0.4603807200805981}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.14227475752552696, "overlap": 0.0, "semantic": 0.3556868938138174}, {"chunk_id": "p-5c1af97004f2", "combined": 0.1346580504752661, "overlap": 0.0, "semantic": 0.3366451261881653}]}
{"symbol_id": "ab6f5f04aa8223055609f397b5761cb65706b62b", "symbol_name": "make_block_causal_mask", "query_text_overlap": "attn_mask shape torch block_mask chunk_size diag_mask mask int lengths logical_and make_block_causal_mask max_len num_blocks tensor unsqueeze block_diag ceil fill_value logical_or make_nonpad_mask", "query_text_semantic": "def make_block_causal_mask( lengths: torch.Tensor, max_len: int = 0, chunk_size: int = 4 ) -> torch.Tensor: mask = make_nonpad_mask(lengths, max_len) # (b, t) attn_mask = torch.logical_and(mask.unsqueeze(1), mask.unsqueeze(2)) # (b, t, t) num_blocks = math.ceil(attn_mask.shape[1] / chunk_size) block_mask = torch.block_diag( *[torch.ones(chunk_size, chunk_size) for _ in range(num_blocks)] ) block_mask = block_mask[: attn_mask.shape[1], : attn_mask.shape[1]].to( attn_mask ) # (t, t) diag_mask = attn_mask.new_full( (1, attn_mask.shape[1], attn_mask.shape[2]), fill_value=True ).tril() # (1, t, t) diag_mask = diag_mask.logical_or(block_mask) attn_mask = attn_mask.logical_and(diag_mask) return attn_mask", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.26745261334640535, "overlap_score": 0.0, "semantic_score": 0.6686315333660133}, {"chunk_id": "p-62dccf79cb8d", "score": 0.2075646605560634, "overlap_score": 0.0, "semantic_score": 0.5189116513901585}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.26745261334640535, "overlap": 0.0, "semantic": 0.6686315333660133}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2075646605560634, "overlap": 0.0, "semantic": 0.5189116513901585}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.18951046560886092, "overlap": 0.0, "semantic": 0.4737761640221523}, {"chunk_id": "p-ae67c9c86886", "combined": 0.18605099657520585, "overlap": 0.0, "semantic": 0.4651274914380146}, {"chunk_id": "p-0d66effb9582", "combined": 0.1844218242511614, "overlap": 0.0, "semantic": 0.4610545606279035}, {"chunk_id": "p-88308230dda7", "combined": 0.16425581690247862, "overlap": 0.0, "semantic": 0.41063954225619653}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.13455615282556319, "overlap": 0.0, "semantic": 0.336390382063908}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11833643488507486, "overlap": 0.0, "semantic": 0.29584108721268715}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.11327046115665391, "overlap": 0.0, "semantic": 0.2831761528916348}]}
{"symbol_id": "bfda720de90a0c239ea02ad25272a4923fb8574d", "symbol_name": "make_nonpad_mask", "query_text_overlap": "lengths make_nonpad_mask max_len tensor torch int make_pad_mask", "query_text_semantic": "def make_nonpad_mask(lengths: torch.Tensor, max_len: int = 0) -> torch.Tensor: return ~make_pad_mask(lengths, max_len)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.21393613391894584, "overlap_score": 0.0, "semantic_score": 0.5348403347973646}, {"chunk_id": "p-0d66effb9582", "score": 0.21051372123526338, "overlap_score": 0.0, "semantic_score": 0.5262843030881584}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.21393613391894584, "overlap": 0.0, "semantic": 0.5348403347973646}, {"chunk_id": "p-0d66effb9582", "combined": 0.21051372123526338, "overlap": 0.0, "semantic": 0.5262843030881584}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.18495532466765296, "overlap": 0.0, "semantic": 0.4623883116691324}, {"chunk_id": "p-ae67c9c86886", "combined": 0.17727633018946704, "overlap": 0.0, "semantic": 0.44319082547366756}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1542904291664373, "overlap": 0.0, "semantic": 0.3857260729160932}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1414321981028458, "overlap": 0.0, "semantic": 0.3535804952571145}, {"chunk_id": "p-5c1af97004f2", "combined": 0.12037359985294581, "overlap": 0.0, "semantic": 0.3009339996323645}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.08583884077634105, "overlap": 0.0, "semantic": 0.2145971019408526}, {"chunk_id": "p-88308230dda7", "combined": 0.0800568235682514, "overlap": 0.0, "semantic": 0.2001420589206285}]}
{"symbol_id": "0f12f42f9edd13c72cb15d025d17a1e983041e96", "symbol_name": "make_pad_mask", "query_text_overlap": "max_len lengths torch batch_size device make_pad_mask mask seq_length_expand seq_range seq_range_expand tensor unsqueeze arange dtype expand int int64 item max size", "query_text_semantic": "def make_pad_mask(lengths: torch.Tensor, max_len: int = 0) -> torch.Tensor: batch_size = lengths.size(0) max_len = max_len if max_len > 0 else lengths.max().item() seq_range = torch.arange(0, max_len, dtype=torch.int64, device=lengths.device) seq_range_expand = seq_range.unsqueeze(0).expand(batch_size, max_len) seq_length_expand = lengths.unsqueeze(-1) mask = seq_range_expand >= seq_length_expand return mask # (b, t)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.30511979567118797, "overlap_score": 0.0, "semantic_score": 0.7627994891779699}, {"chunk_id": "p-ae67c9c86886", "score": 0.22452964807244544, "overlap_score": 0.0, "semantic_score": 0.5613241201811136}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.30511979567118797, "overlap": 0.0, "semantic": 0.7627994891779699}, {"chunk_id": "p-ae67c9c86886", "combined": 0.22452964807244544, "overlap": 0.0, "semantic": 0.5613241201811136}, {"chunk_id": "p-0d66effb9582", "combined": 0.20138346512808802, "overlap": 0.0, "semantic": 0.50345866282022}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.18972389448155988, "overlap": 0.0, "semantic": 0.47430973620389966}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1787149510628032, "overlap": 0.0, "semantic": 0.44678737765700793}, {"chunk_id": "p-5c1af97004f2", "combined": 0.15491144572878923, "overlap": 0.0, "semantic": 0.387278614321973}, {"chunk_id": "p-88308230dda7", "combined": 0.118556044487603, "overlap": 0.0, "semantic": 0.2963901112190075}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.11538099168253856, "overlap": 0.0, "semantic": 0.28845247920634637}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1135018156929486, "overlap": 0.0, "semantic": 0.2837545392323715}]}
{"symbol_id": "f9e4dafa0aa8671eeb36d34b9beac4a7ba0a14cc", "symbol_name": "WhisperAcousticEncoder", "query_text_overlap": "int float mel num_mels attn_dropout dropout embed_dim ffn_dim fmax fmin forward hop_length max_positions n_fft num_heads num_layers sampling_rate torch __init__ audio16k", "query_text_semantic": "class WhisperAcousticEncoder(WhisperEncoder): def __init__( self, # Mel extraction params num_mels: int = 128, sampling_rate: int = 16000, hop_length: int = 160, n_fft: int = 400, fmin: float = 0.0, fmax: float = 8000, # Encoder params embed_dim: int = 768, num_layers: int = 12, num_heads: int = 8, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, max_positions: int = 1500, # 50Hz * 30s ): super().__init__( in_dim=num_mels, embed_dim=embed_dim, num_layers=num_layers, num_heads=num_heads, ffn_dim=ffn_dim, attn_dropout=attn_dropout, dropout=dropout, max_positions=max_positions, ) self.feature_extractor = WhisperMelExtractor( num_mels=num_mels, sampling_rate=sampling_rate, hop_length=hop_length, n_fft=n_fft, fmin=fmin, fmax=fmax, ) def forward(self, audio16k: torch.Tensor, audio16k_length: torch.Tensor): # Extract mel with torch.no_grad(): mel, mel_length = self.feature_extractor(audio16k, audio16k_length) # Forward model hidden_states, hidden_length = super().forward( mel, mel_length, apply_position=True ) return hidden_states, hidden_length", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.32785620519478487, "overlap_score": 0.0, "semantic_score": 0.8196405129869622}, {"chunk_id": "p-0d66effb9582", "score": 0.32644677809029704, "overlap_score": 0.0, "semantic_score": 0.8161169452257425}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.32785620519478487, "overlap": 0.0, "semantic": 0.8196405129869622}, {"chunk_id": "p-0d66effb9582", "combined": 0.32644677809029704, "overlap": 0.0, "semantic": 0.8161169452257425}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.31827152398203196, "overlap": 0.0, "semantic": 0.7956788099550799}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3126725779000017, "overlap": 0.0, "semantic": 0.7816814447500042}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2952559818237336, "overlap": 0.0, "semantic": 0.7381399545593339}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2924723735941957, "overlap": 0.0, "semantic": 0.7311809339854892}, {"chunk_id": "p-88308230dda7", "combined": 0.2911547014166933, "overlap": 0.0, "semantic": 0.7278867535417333}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.27566306327120327, "overlap": 0.0, "semantic": 0.6891576581780081}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.27536148075969236, "overlap": 0.0, "semantic": 0.6884037018992308}]}
{"symbol_id": "f266c9c94014524f4aedd44a35b873681d4f4506", "symbol_name": "forward", "query_text_overlap": "forward mel torch audio16k audio16k_length hidden_length hidden_states mel_length tensor apply_position feature_extractor no_grad super extract model", "query_text_semantic": "def forward(self, audio16k: torch.Tensor, audio16k_length: torch.Tensor): # Extract mel with torch.no_grad(): mel, mel_length = self.feature_extractor(audio16k, audio16k_length) # Forward model hidden_states, hidden_length = super().forward( mel, mel_length, apply_position=True ) return hidden_states, hidden_length", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.9500306440795518, "overlap_score": 1.0, "semantic_score": 0.8750766101988795}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.6081697003534668, "overlap_score": 0.3469495005891114, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.5919627712718696, "overlap_score": 0.35560442305500023, "semantic_score": 0.9465002935971735}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.9500306440795518, "overlap": 1.0, "semantic": 0.8750766101988795}, {"chunk_id": "p-021b4cb4f328", "combined": 0.6081697003534668, "overlap": 0.3469495005891114, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5919627712718696, "overlap": 0.35560442305500023, "semantic": 0.9465002935971735}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5435522891049208, "overlap": 0.4185242894135724, "semantic": 0.7310942886419435}, {"chunk_id": "p-88308230dda7", "combined": 0.4946962297522463, "overlap": 0.3220700177374364, "semantic": 0.7536355477744612}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4771659638305826, "overlap": 0.3065453461988772, "semantic": 0.7330968902781406}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.41638864130595094, "overlap": 0.2415129728687504, "semantic": 0.6787021439617517}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.4003333032005178, "overlap": 0.2564691236808823, "semantic": 0.616129572479971}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3825975251693374, "overlap": 0.2556359267530445, "semantic": 0.5730399227937768}, {"chunk_id": "p-0d66effb9582", "combined": 0.3119465753485137, "overlap": 0.0, "semantic": 0.7798664383712842}]}
{"symbol_id": "047bf2f75f68f6a89e771241b3233cefd7b48016", "symbol_name": "__init__", "query_text_overlap": "int float num_mels __init__ attn_dropout dropout embed_dim ffn_dim fmax fmin hop_length max_positions n_fft num_heads num_layers sampling_rate feature_extractor in_dim super whispermelextractor", "query_text_semantic": "def __init__( self, # Mel extraction params num_mels: int = 128, sampling_rate: int = 16000, hop_length: int = 160, n_fft: int = 400, fmin: float = 0.0, fmax: float = 8000, # Encoder params embed_dim: int = 768, num_layers: int = 12, num_heads: int = 8, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, max_positions: int = 1500, # 50Hz * 30s ): super().__init__( in_dim=num_mels, embed_dim=embed_dim, num_layers=num_layers, num_heads=num_heads, ffn_dim=ffn_dim, attn_dropout=attn_dropout, dropout=dropout, max_positions=max_positions, ) self.feature_extractor = WhisperMelExtractor( num_mels=num_mels, sampling_rate=sampling_rate, hop_length=hop_length, n_fft=n_fft, fmin=fmin, fmax=fmax, )", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3840080450374071, "overlap_score": 0.0, "semantic_score": 0.9600201125935177}, {"chunk_id": "p-0d66effb9582", "score": 0.3063164519703596, "overlap_score": 0.0, "semantic_score": 0.765791129925899}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3840080450374071, "overlap": 0.0, "semantic": 0.9600201125935177}, {"chunk_id": "p-0d66effb9582", "combined": 0.3063164519703596, "overlap": 0.0, "semantic": 0.765791129925899}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2895784663752233, "overlap": 0.0, "semantic": 0.7239461659380582}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.28538977985278974, "overlap": 0.0, "semantic": 0.7134744496319743}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.27344915799173347, "overlap": 0.0, "semantic": 0.6836228949793337}, {"chunk_id": "p-88308230dda7", "combined": 0.26985939418087485, "overlap": 0.0, "semantic": 0.6746484854521871}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26679186438765856, "overlap": 0.0, "semantic": 0.6669796609691464}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.21809659164653716, "overlap": 0.0, "semantic": 0.5452414791163429}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.20854188816762076, "overlap": 0.0, "semantic": 0.5213547204190518}]}
{"symbol_id": "558503717a90093eb69d872cc3cb8b0a9ecd9921", "symbol_name": "PretrainedWhisperEncoder", "query_text_overlap": "encoder mel torch forward pretrained_path audio16k audio16k_length ckpt cls feature_extractor mel_length pretrainedwhisperencoder semantic_feats semantic_length tensor apply_position attn_dropout classmethod embed_dim eval", "query_text_semantic": "Pretrained encoder from whisper-large-v3", "best": {"chunk_id": "p-ae67c9c86886", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.30595133768502447, "overlap_score": 0.0, "semantic_score": 0.7648783442125611}, {"chunk_id": "p-62dccf79cb8d", "score": 0.29326940534997964, "overlap_score": 0.0, "semantic_score": 0.7331735133749491}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.30595133768502447, "overlap": 0.0, "semantic": 0.7648783442125611}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.29326940534997964, "overlap": 0.0, "semantic": 0.7331735133749491}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2882516909795868, "overlap": 0.0, "semantic": 0.720629227448967}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2880451579928762, "overlap": 0.0, "semantic": 0.7201128949821906}, {"chunk_id": "p-021b4cb4f328", "combined": 0.26737132643207134, "overlap": 0.0, "semantic": 0.6684283160801784}, {"chunk_id": "p-88308230dda7", "combined": 0.25673858494379387, "overlap": 0.0, "semantic": 0.6418464623594846}, {"chunk_id": "p-9158b9f667b9", "combined": 0.25516813574352565, "overlap": 0.0, "semantic": 0.6379203393588141}, {"chunk_id": "p-0d66effb9582", "combined": 0.24179983030791835, "overlap": 0.0, "semantic": 0.6044995757697958}, {"chunk_id": "p-5c1af97004f2", "combined": 0.24098493652707084, "overlap": 0.0, "semantic": 0.6024623413176771}]}
{"symbol_id": "dbec98a561cac4d93d50c96a58595996ad27279a", "symbol_name": "forward", "query_text_overlap": "forward mel audio16k audio16k_length mel_length semantic_feats semantic_length tensor torch apply_position feature_extractor super extract model", "query_text_semantic": "def forward(self, audio16k: torch.Tensor, audio16k_length: torch.Tensor): # Extract mel mel, mel_length = self.feature_extractor(audio16k, audio16k_length) # Forward model semantic_feats, semantic_length = super().forward( mel, mel_length, apply_position=True ) return semantic_feats, semantic_length", "best": {"chunk_id": "p-ae67c9c86886", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.6059499731136317, "overlap_score": 0.35560442305500023, "semantic_score": 0.981468298201579}, {"chunk_id": "p-ebeeda9fc683", "score": 0.5866203012344572, "overlap_score": 0.4185242894135724, "semantic_score": 0.8387643189657843}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6059499731136317, "overlap": 0.35560442305500023, "semantic": 0.981468298201579}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5866203012344572, "overlap": 0.4185242894135724, "semantic": 0.8387643189657843}, {"chunk_id": "p-021b4cb4f328", "combined": 0.5815035638262285, "overlap": 0.3469495005891114, "semantic": 0.9333346586819039}, {"chunk_id": "p-88308230dda7", "combined": 0.5362270315837399, "overlap": 0.3220700177374364, "semantic": 0.8574625523531949}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5009642954415283, "overlap": 0.3065453461988772, "semantic": 0.792592719305505}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.44747387739041455, "overlap": 0.2415129728687504, "semantic": 0.7564152341729108}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.443318128634215, "overlap": 0.2564691236808823, "semantic": 0.7235916360642141}, {"chunk_id": "p-5c1af97004f2", "combined": 0.4171218222527104, "overlap": 0.2556359267530445, "semantic": 0.6593506655022092}, {"chunk_id": "p-0d66effb9582", "combined": 0.35611399785386, "overlap": 0.0, "semantic": 0.8902849946346499}]}
{"symbol_id": "65ba14174149f7d675e79f2ff5b9da092e268fd9", "symbol_name": "from_pretrained", "query_text_overlap": "encoder pretrained_path ckpt cls from_pretrained attn_dropout embed_dim eval feature_extractor ffn_dim fmax fmin hop_length in_dim load load_state_dict map_location max_positions n_fft num_heads", "query_text_semantic": "def from_pretrained(cls, pretrained_path: str = None): encoder = cls( in_dim=128, embed_dim=1280, num_layers=32, num_heads=20, ffn_dim=5120, attn_dropout=0.0, max_positions=1500, ) if pretrained_path is not None: ckpt = torch.load(pretrained_path, map_location=\"cpu\") encoder.load_state_dict(ckpt) encoder.eval() # Disable grad for p in encoder.parameters(): p.requires_grad_(False) # Add Mel extractor encoder.feature_extractor = WhisperMelExtractor( num_mels=128, sampling_rate=16000, hop_length=160, n_fft=400, fmin=0, fmax=8000, ) return encoder", "best": {"chunk_id": "p-ae67c9c86886", "score": 1.0, "overlap_score": 1.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3824102044254789, "overlap_score": 0.0, "semantic_score": 0.9560255110636972}, {"chunk_id": "p-3c728ae39fa1", "score": 0.34561824330248175, "overlap_score": 0.0, "semantic_score": 0.8640456082562044}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 1.0, "overlap": 1.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3824102044254789, "overlap": 0.0, "semantic": 0.9560255110636972}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.34561824330248175, "overlap": 0.0, "semantic": 0.8640456082562044}, {"chunk_id": "p-0d66effb9582", "combined": 0.3243276137502096, "overlap": 0.0, "semantic": 0.8108190343755238}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.29636177386109597, "overlap": 0.0, "semantic": 0.7409044346527399}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2948497661756894, "overlap": 0.0, "semantic": 0.7371244154392235}, {"chunk_id": "p-88308230dda7", "combined": 0.25812857029227126, "overlap": 0.0, "semantic": 0.6453214257306782}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2541260903746822, "overlap": 0.0, "semantic": 0.6353152259367055}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23175534642227671, "overlap": 0.0, "semantic": 0.5793883660556918}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.20137713527164358, "overlap": 0.0, "semantic": 0.503442838179109}]}
{"symbol_id": "0edb2dae6f9c5bd45a24b3a1192e59b73ecff797", "symbol_name": "WhisperMelExtractor", "query_text_overlap": "torch log_spec n_fft audio hop_length sampling_rate device fmax fmin int mel mel_filters num_mels padding_value stft tensor window __init__ audio16k audio16k_length", "query_text_semantic": "class WhisperMelExtractor(nn.Module): def __init__( self, num_mels: int = 128, sampling_rate: int = 16000, hop_length: int = 160, n_fft: int = 400, fmin: float = 0, fmax: float = 8000, padding_value=0.0, ): super().__init__() self.num_mels = num_mels self.sampling_rate = sampling_rate self.hop_length = hop_length self.n_fft = n_fft self.fmin = fmin self.fmax = fmax self.padding_value = padding_value self.mel_filters = mel_filter_bank( num_frequency_bins=(1 + n_fft // 2), num_mel_filters=num_mels, min_frequency=fmin, max_frequency=fmax, sampling_rate=sampling_rate, norm=\"slaney\", mel_scale=\"slaney\", ) def extract_fbank(self, audio: torch.Tensor): \"\"\" Args: audio: batched audio of shape (b, t) \"\"\" device = audio.device # compute on cuda if input is on cuda # Mel window = torch.hann_window(self.n_fft).to(device) stft = torch.stft( audio, self.n_fft, self.hop_length, window=window, return_complex=True ) magnitudes = stft[..., :-1].abs() ** 2 mel_filters = torch.from_numpy(self.mel_filters).type(torch.float32).to(device) mel_spec = mel_filters.T", "best": {"chunk_id": "p-0d66effb9582", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3910789177729127, "overlap_score": 0.0, "semantic_score": 0.9776972944322817}, {"chunk_id": "p-ae67c9c86886", "score": 0.38467854627981163, "overlap_score": 0.0, "semantic_score": 0.961696365699529}], "topk_raw": [{"chunk_id": "p-0d66effb9582", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3910789177729127, "overlap": 0.0, "semantic": 0.9776972944322817}, {"chunk_id": "p-ae67c9c86886", "combined": 0.38467854627981163, "overlap": 0.0, "semantic": 0.961696365699529}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3796822814980526, "overlap": 0.0, "semantic": 0.9492057037451315}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3416829300494388, "overlap": 0.0, "semantic": 0.8542073251235969}, {"chunk_id": "p-88308230dda7", "combined": 0.3226366128952674, "overlap": 0.0, "semantic": 0.8065915322381685}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3158210763585101, "overlap": 0.0, "semantic": 0.7895526908962751}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3134982973126204, "overlap": 0.0, "semantic": 0.783745743281551}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3032224377020443, "overlap": 0.0, "semantic": 0.7580560942551108}, {"chunk_id": "p-edce760829b6", "combined": 0.2530268387254167, "overlap": 0.0, "semantic": 0.6325670968135417}]}
{"symbol_id": "e8a9bba9358ec8cd7cbce3e760644a8d1fe73028", "symbol_name": "__call__", "query_text_overlap": "mel __call__ audio16k audio16k_length mel_length tensor torch extract_fbank hop_length transpose 128", "query_text_semantic": "def __call__(self, audio16k: torch.Tensor, audio16k_length: torch.Tensor): mel = self.extract_fbank(audio16k).transpose(1, 2) mel_length = audio16k_length // self.hop_length # mel: (b, t, c=128) return mel, mel_length", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.39554713745271125, "overlap_score": 0.0, "semantic_score": 0.988867843631778}, {"chunk_id": "p-021b4cb4f328", "score": 0.33933255989911726, "overlap_score": 0.0, "semantic_score": 0.8483313997477931}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.39554713745271125, "overlap": 0.0, "semantic": 0.988867843631778}, {"chunk_id": "p-021b4cb4f328", "combined": 0.33933255989911726, "overlap": 0.0, "semantic": 0.8483313997477931}, {"chunk_id": "p-0d66effb9582", "combined": 0.3287694661622531, "overlap": 0.0, "semantic": 0.8219236654056327}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.31139520807061793, "overlap": 0.0, "semantic": 0.7784880201765447}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.30986717108028583, "overlap": 0.0, "semantic": 0.7746679277007146}, {"chunk_id": "p-88308230dda7", "combined": 0.2995377553593947, "overlap": 0.0, "semantic": 0.7488443883984868}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2879611265237495, "overlap": 0.0, "semantic": 0.7199028163093737}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.25375172761664566, "overlap": 0.0, "semantic": 0.6343793190416142}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24169286254728878, "overlap": 0.0, "semantic": 0.6042321563682219}]}
{"symbol_id": "a02f245c977cb8a23c2b026943ad3e5b6fe65000", "symbol_name": "extract_fbank", "query_text_overlap": "audio log_spec torch device mel_filters stft window dim extract_fbank keepdim magnitudes max max_val mel_spec n_fft abs clamp float32 from_numpy hann_window", "query_text_semantic": "Args:\n            audio: batched audio of shape (b, t)", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.3695612115502508, "overlap_score": 0.0, "semantic_score": 0.9239030288756269}, {"chunk_id": "p-ae67c9c86886", "score": 0.3505884508991778, "overlap_score": 0.0, "semantic_score": 0.8764711272479444}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.3695612115502508, "overlap": 0.0, "semantic": 0.9239030288756269}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3505884508991778, "overlap": 0.0, "semantic": 0.8764711272479444}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.34971073280319637, "overlap": 0.0, "semantic": 0.8742768320079909}, {"chunk_id": "p-5c1af97004f2", "combined": 0.29244283671303617, "overlap": 0.0, "semantic": 0.7311070917825904}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2828978088998763, "overlap": 0.0, "semantic": 0.7072445222496908}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.28010971694544845, "overlap": 0.0, "semantic": 0.7002742923636212}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2597737551983414, "overlap": 0.0, "semantic": 0.6494343879958535}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.2575453544573946, "overlap": 0.0, "semantic": 0.6438633861434866}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2541700598098113, "overlap": 0.0, "semantic": 0.6354251495245281}]}
{"symbol_id": "4b55ff12cb2c731ee82ce2ef059572322e53d68f", "symbol_name": "__init__", "query_text_overlap": "sampling_rate fmax fmin int n_fft num_mels __init__ hop_length padding_value float max_frequency mel_filter_bank mel_filters mel_scale min_frequency norm num_frequency_bins num_mel_filters super slaney", "query_text_semantic": "def __init__( self, num_mels: int = 128, sampling_rate: int = 16000, hop_length: int = 160, n_fft: int = 400, fmin: float = 0, fmax: float = 8000, padding_value=0.0, ): super().__init__() self.num_mels = num_mels self.sampling_rate = sampling_rate self.hop_length = hop_length self.n_fft = n_fft self.fmin = fmin self.fmax = fmax self.padding_value = padding_value self.mel_filters = mel_filter_bank( num_frequency_bins=(1 + n_fft // 2), num_mel_filters=num_mels, min_frequency=fmin, max_frequency=fmax, sampling_rate=sampling_rate, norm=\"slaney\", mel_scale=\"slaney\", )", "best": {"chunk_id": "p-0d66effb9582", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3834587611220678, "overlap_score": 0.0, "semantic_score": 0.9586469028051694}, {"chunk_id": "p-0212d69b9ec4", "score": 0.3672249690161892, "overlap_score": 0.0, "semantic_score": 0.9180624225404729}], "topk_raw": [{"chunk_id": "p-0d66effb9582", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3834587611220678, "overlap": 0.0, "semantic": 0.9586469028051694}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.3672249690161892, "overlap": 0.0, "semantic": 0.9180624225404729}, {"chunk_id": "p-ae67c9c86886", "combined": 0.34468449611906826, "overlap": 0.0, "semantic": 0.8617112402976705}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.3443325516613386, "overlap": 0.0, "semantic": 0.8608313791533464}, {"chunk_id": "p-88308230dda7", "combined": 0.29388633582873364, "overlap": 0.0, "semantic": 0.7347158395718341}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.23936112530640175, "overlap": 0.0, "semantic": 0.5984028132660043}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.20672398593216365, "overlap": 0.0, "semantic": 0.5168099648304091}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.20330489463244783, "overlap": 0.0, "semantic": 0.5082622365811196}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18936163370074555, "overlap": 0.0, "semantic": 0.4734040842518638}]}
{"symbol_id": "909ed2176abadf6c1a6b38099c53847689068ab2", "symbol_name": "WhisperEncoder", "query_text_overlap": "hidden_states embed_dim dropout int embed_positions hidden_length in_dim max_positions module weight conv1d embedding std torch __init__ _init_weights apply_position attention_mask attn_dropout conv1", "query_text_semantic": "class WhisperEncoder(nn.Module): def __init__( self, in_dim: int, embed_dim: int, num_layers: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, max_positions: int = 1500, ): super().__init__() self.in_dim = in_dim self.embed_dim = embed_dim self.dropout = dropout # Input downsampling self.conv1 = nn.Conv1d(in_dim, embed_dim, kernel_size=3, padding=1) self.conv2 = nn.Conv1d(embed_dim, embed_dim, kernel_size=3, stride=2, padding=1) # Fixed positional embedding self.max_positions = max_positions self.embed_positions = nn.Embedding(self.max_positions, embed_dim) self.embed_positions.requires_grad_(False) # Transformer self.layers = nn.ModuleList( [ WhisperEncoderLayer( embed_dim, num_heads, ffn_dim, attn_dropout, dropout ) for _ in range(num_layers) ] ) # Output norm self.layer_norm = nn.LayerNorm(embed_dim) # Init weight self.apply(self._init_weights) # Init position embedding self.embed_positions.weight.copy_(sinusoids(*self.embed_positions.weight.shape)) def forward( self, hidden_states: torch.Tensor, hidden_length: torch.Tensor, apply_position: bool = True, ): # Downsampling hidden_states = hidden_states.transpose(1, 2)", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.8582386011332159, "overlap_score": 1.0, "semantic_score": 0.6455965028330399}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-021b4cb4f328", "score": 0.33468388213005795, "overlap_score": 0.0, "semantic_score": 0.8367097053251448}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.8582386011332159, "overlap": 1.0, "semantic": 0.6455965028330399}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.33468388213005795, "overlap": 0.0, "semantic": 0.8367097053251448}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.322709944625646, "overlap": 0.0, "semantic": 0.8067748615641149}, {"chunk_id": "p-0d66effb9582", "combined": 0.2860337086644497, "overlap": 0.0, "semantic": 0.7150842716611243}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26849131936069154, "overlap": 0.0, "semantic": 0.6712282984017288}, {"chunk_id": "p-88308230dda7", "combined": 0.26780397091654, "overlap": 0.0, "semantic": 0.66950992729135}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.24905872864931222, "overlap": 0.0, "semantic": 0.6226468216232806}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23784101343489705, "overlap": 0.0, "semantic": 0.5946025335872426}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.23269354518241486, "overlap": 0.0, "semantic": 0.5817338629560371}]}
{"symbol_id": "48f40f12643f3628a44764c66028ef9b3d2779e4", "symbol_name": "_init_weights", "query_text_overlap": "module std data weight _init_weights bias isinstance mean normal_ padding_idx zero_ conv1d embedding linear not elif", "query_text_semantic": "def _init_weights(self, module): std = 0.02 if isinstance(module, (nn.Linear, nn.Conv1d)): module.weight.data.normal_(mean=0.0, std=std) if module.bias is not None: module.bias.data.zero_() elif isinstance(module, nn.Embedding): module.weight.data.normal_(mean=0.0, std=std) if module.padding_idx is not None: module.weight.data[module.padding_idx].zero_()", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.7964922733603894, "overlap_score": 0.660820455600649, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.7741108876511286, "overlap_score": 1.0, "semantic_score": 0.43527721912782147}, {"chunk_id": "p-ae67c9c86886", "score": 0.6846382420326971, "overlap_score": 0.9188939462923675, "semantic_score": 0.33325468564319144}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.7964922733603894, "overlap": 0.660820455600649, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.7741108876511286, "overlap": 1.0, "semantic": 0.43527721912782147}, {"chunk_id": "p-ae67c9c86886", "combined": 0.6846382420326971, "overlap": 0.9188939462923675, "semantic": 0.33325468564319144}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6590788335646034, "overlap": 0.7603684063633829, "semantic": 0.5071444743664344}, {"chunk_id": "p-0d66effb9582", "combined": 0.24289546692549024, "overlap": 0.0, "semantic": 0.6072386673137256}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15670099607627883, "overlap": 0.0, "semantic": 0.391752490190697}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.12094030017575948, "overlap": 0.0, "semantic": 0.3023507504393987}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.10285599141937392, "overlap": 0.0, "semantic": 0.2571399785484348}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.09559616993162608, "overlap": 0.0, "semantic": 0.23899042482906518}, {"chunk_id": "p-edce760829b6", "combined": 0.08977455903333115, "overlap": 0.0, "semantic": 0.22443639758332784}]}
{"symbol_id": "f67e1eacb7d34f25e0ba36646c77fd260033e3eb", "symbol_name": "forward", "query_text_overlap": "hidden_states hidden_length torch apply_position attention_mask device dropout forward gelu layer pos_embed tensor training transpose arange bool conv1 conv2 embed_positions functional", "query_text_semantic": "def forward( self, hidden_states: torch.Tensor, hidden_length: torch.Tensor, apply_position: bool = True, ): # Downsampling hidden_states = hidden_states.transpose(1, 2) hidden_states = F.gelu(self.conv1(hidden_states)) hidden_states = F.gelu(self.conv2(hidden_states)) hidden_states = hidden_states.transpose(1, 2) hidden_length = hidden_length // 2 # from 100Hz -> 50Hz # Pos encoding if apply_position: pos_embed = self.embed_positions( torch.arange(0, hidden_states.shape[1], device=hidden_states.device) ) hidden_states = hidden_states + pos_embed hidden_states = nn.functional.dropout( hidden_states, p=self.dropout, training=self.training ) # Transformer attention_mask = make_nonpad_mask(hidden_length).unsqueeze(1) # (b, 1, t) for layer in self.layers: hidden_states = layer(hidden_states, attention_mask) hidden_states = self.layer_norm(hidden_states) return hidden_states, hidden_length", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.8288866427125023, "overlap_score": 1.0, "semantic_score": 0.5722166067812557}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.48157295411982426, "overlap_score": 0.13595492353304045, "semantic_score": 1.0}, {"chunk_id": "p-0d66effb9582", "score": 0.2319506989007905, "overlap_score": 0.0987641804333696, "semantic_score": 0.4317304766019218}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.8288866427125023, "overlap": 1.0, "semantic": 0.5722166067812557}, {"chunk_id": "p-021b4cb4f328", "combined": 0.48157295411982426, "overlap": 0.13595492353304045, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.2319506989007905, "overlap": 0.0987641804333696, "semantic": 0.4317304766019218}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.21533701247482168, "overlap": 0.11360548304227994, "semantic": 0.3679343066236343}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.203751422061429, "overlap": 0.10189632886584761, "semantic": 0.3565340618548011}, {"chunk_id": "p-ae67c9c86886", "combined": 0.1890744403446474, "overlap": 0.0, "semantic": 0.4726861008616185}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18647156336562415, "overlap": 0.0, "semantic": 0.46617890841406034}, {"chunk_id": "p-5c1af97004f2", "combined": 0.17614018720740493, "overlap": 0.12024879076588203, "semantic": 0.25997728186968927}, {"chunk_id": "p-88308230dda7", "combined": 0.14626103849618835, "overlap": 0.08026088769576593, "semantic": 0.24526126469682197}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.11191854230831451, "overlap": 0.0, "semantic": 0.27979635577078626}]}
{"symbol_id": "89a07e6c908816772be14019712324c710394d94", "symbol_name": "__init__", "query_text_overlap": "embed_dim int dropout embed_positions in_dim max_positions __init__ embedding weight attn_dropout conv1d ffn_dim float kernel_size num_heads num_layers padding _init_weights apply conv1", "query_text_semantic": "def __init__( self, in_dim: int, embed_dim: int, num_layers: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, max_positions: int = 1500, ): super().__init__() self.in_dim = in_dim self.embed_dim = embed_dim self.dropout = dropout # Input downsampling self.conv1 = nn.Conv1d(in_dim, embed_dim, kernel_size=3, padding=1) self.conv2 = nn.Conv1d(embed_dim, embed_dim, kernel_size=3, stride=2, padding=1) # Fixed positional embedding self.max_positions = max_positions self.embed_positions = nn.Embedding(self.max_positions, embed_dim) self.embed_positions.requires_grad_(False) # Transformer self.layers = nn.ModuleList( [ WhisperEncoderLayer( embed_dim, num_heads, ffn_dim, attn_dropout, dropout ) for _ in range(num_layers) ] ) # Output norm self.layer_norm = nn.LayerNorm(embed_dim) # Init weight self.apply(self._init_weights) # Init position embedding self.embed_positions.weight.copy_(sinusoids(*self.embed_positions.weight.shape))", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.7541835249863623, "overlap_score": 1.0, "semantic_score": 0.38545881246590585}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.29133746063567917, "overlap_score": 0.0, "semantic_score": 0.7283436515891979}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.7541835249863623, "overlap": 1.0, "semantic": 0.38545881246590585}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.29133746063567917, "overlap": 0.0, "semantic": 0.7283436515891979}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.26304835968838025, "overlap": 0.0, "semantic": 0.6576208992209506}, {"chunk_id": "p-88308230dda7", "combined": 0.22444039705813418, "overlap": 0.0, "semantic": 0.5611009926453354}, {"chunk_id": "p-0d66effb9582", "combined": 0.22122657878581953, "overlap": 0.0, "semantic": 0.5530664469645488}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2027031314119835, "overlap": 0.0, "semantic": 0.5067578285299588}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.17277304854593256, "overlap": 0.0, "semantic": 0.43193262136483135}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.1561398083556684, "overlap": 0.0, "semantic": 0.39034952088917096}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.14379075946495926, "overlap": 0.0, "semantic": 0.3594768986623981}]}
{"symbol_id": "0c8b56bb4cac9e728fdf0a8c97ca1010079df1a0", "symbol_name": "WhisperEncoderLayer", "query_text_overlap": "hidden_states dropout training embed_dim residual ffn_dim tensor torch fc1 fc2 final_layer_norm int kv_cache self_attn self_attn_layer_norm attention __init__ attention_mask attn_dropout float", "query_text_semantic": "class WhisperEncoderLayer(nn.Module): def __init__( self, embed_dim: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, ): super().__init__() self.dropout = dropout # Attention self.self_attn = WhisperSdpaAttention(embed_dim, num_heads, attn_dropout) self.self_attn_layer_norm = nn.LayerNorm(embed_dim) # FFN ffn_dim = ffn_dim if ffn_dim is not None else embed_dim * 4 self.fc1 = nn.Linear(embed_dim, ffn_dim) self.fc2 = nn.Linear(ffn_dim, embed_dim) # Output norm self.final_layer_norm = nn.LayerNorm(embed_dim) def forward( self, hidden_states: torch.Tensor, attention_mask: torch.Tensor, ): # Attention residual = hidden_states hidden_states = self.self_attn_layer_norm(hidden_states) hidden_states = self.self_attn(hidden_states, attention_mask) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states = residual + hidden_states # FFN residual = hidden_states hidden_states = self.final_layer_norm(hidden_states) hidden_states = F.gelu(self.fc1(hidden_states)) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states = self.fc2(hidden_states) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states =", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.9817116597692902, "overlap_score": 1.0, "semantic_score": 0.9542791494232256}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.48327853468620047, "overlap_score": 0.1387975578103341, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.3715388429257922, "overlap_score": 0.0, "semantic_score": 0.9288471073144804}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.9817116597692902, "overlap": 1.0, "semantic": 0.9542791494232256}, {"chunk_id": "p-021b4cb4f328", "combined": 0.48327853468620047, "overlap": 0.1387975578103341, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3715388429257922, "overlap": 0.0, "semantic": 0.9288471073144804}, {"chunk_id": "p-0d66effb9582", "combined": 0.3638903031115695, "overlap": 0.1008292063800061, "semantic": 0.7584819482089146}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.36330355948654874, "overlap": 0.11598082063059467, "semantic": 0.7342876677704798}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.35740679784053575, "overlap": 0.10402684381622417, "semantic": 0.7374767288770031}, {"chunk_id": "p-88308230dda7", "combined": 0.3481667586735783, "overlap": 0.08193903472097869, "semantic": 0.7475083446024777}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2836308038035158, "overlap": 0.0, "semantic": 0.7090770095087895}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.28255232047311385, "overlap": 0.0, "semantic": 0.7063808011827846}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.280893284987636, "overlap": 0.0, "semantic": 0.70223321246909}]}
{"symbol_id": "cca13abfe71add43b57f39f397a42f24dcf691e0", "symbol_name": "forward_chunk", "query_text_overlap": "hidden_states dropout training kv_cache residual forward_chunk shape new_kv_cache tensor torch attention fc1 fc2 final_layer_norm gelu self_attn self_attn_layer_norm forward cache ffn", "query_text_semantic": "Forward self-attention with kv cache.\n\n        Args:\n            hidden_states: shape (b, t, c)\n            kv_cache: shape (b, nh, t, c*2)", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8271062621520746, "overlap_score": 1.0, "semantic_score": 0.5677656553801865}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.48327853468620047, "overlap_score": 0.1387975578103341, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.3402031290030754, "overlap_score": 0.0, "semantic_score": 0.8505078225076885}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8271062621520746, "overlap": 1.0, "semantic": 0.5677656553801865}, {"chunk_id": "p-021b4cb4f328", "combined": 0.48327853468620047, "overlap": 0.1387975578103341, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3402031290030754, "overlap": 0.0, "semantic": 0.8505078225076885}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.31816776758264614, "overlap": 0.10402684381622417, "semantic": 0.6393791532322791}, {"chunk_id": "p-88308230dda7", "combined": 0.2752658166449916, "overlap": 0.08193903472097869, "semantic": 0.565255989531011}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2623666758896991, "overlap": 0.11598082063059467, "semantic": 0.4819454587783557}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2584287137708353, "overlap": 0.12276303096808504, "semantic": 0.46192723797496077}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.24250722081721474, "overlap": 0.0, "semantic": 0.6062680520430368}, {"chunk_id": "p-edce760829b6", "combined": 0.22360066037124093, "overlap": 0.0, "semantic": 0.5590016509281023}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.22320988048045942, "overlap": 0.0, "semantic": 0.5580247012011486}]}
{"symbol_id": "56eba88959e8198f353efc344a1f77b0e4a852f4", "symbol_name": "forward", "query_text_overlap": "hidden_states dropout training residual attention_mask forward tensor torch fc1 fc2 final_layer_norm gelu self_attn self_attn_layer_norm attention ffn", "query_text_semantic": "def forward( self, hidden_states: torch.Tensor, attention_mask: torch.Tensor, ): # Attention residual = hidden_states hidden_states = self.self_attn_layer_norm(hidden_states) hidden_states = self.self_attn(hidden_states, attention_mask) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states = residual + hidden_states # FFN residual = hidden_states hidden_states = self.final_layer_norm(hidden_states) hidden_states = F.gelu(self.fc1(hidden_states)) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states = self.fc2(hidden_states) hidden_states = F.dropout(hidden_states, p=self.dropout, training=self.training) hidden_states = residual + hidden_states return hidden_states", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8351464238838602, "overlap_score": 1.0, "semantic_score": 0.5878660597096506}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.48327853468620047, "overlap_score": 0.1387975578103341, "semantic_score": 1.0}, {"chunk_id": "p-0d66effb9582", "score": 0.2773718649921594, "overlap_score": 0.1008292063800061, "semantic_score": 0.5421858529103892}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8351464238838602, "overlap": 1.0, "semantic": 0.5878660597096506}, {"chunk_id": "p-021b4cb4f328", "combined": 0.48327853468620047, "overlap": 0.1387975578103341, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.2773718649921594, "overlap": 0.1008292063800061, "semantic": 0.5421858529103892}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2642228196020954, "overlap": 0.0, "semantic": 0.6605570490052385}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.25179304194199825, "overlap": 0.11598082063059467, "semantic": 0.45551137390910357}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2517924594637838, "overlap": 0.10402684381622417, "semantic": 0.4734408829351232}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.22789271559421193, "overlap": 0.0, "semantic": 0.5697317889855298}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2248214498201134, "overlap": 0.12276303096808504, "semantic": 0.37790907809815594}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.17998377322189518, "overlap": 0.0, "semantic": 0.4499594330547379}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.16340864888613493, "overlap": 0.0, "semantic": 0.4085216222153373}]}
{"symbol_id": "dfda2b6ca49fb7462867c31c9456708454fc101a", "symbol_name": "__init__", "query_text_overlap": "embed_dim ffn_dim __init__ dropout int attn_dropout float layernorm linear num_heads fc1 fc2 final_layer_norm self_attn self_attn_layer_norm super whispersdpaattention attention ffn not", "query_text_semantic": "def __init__( self, embed_dim: int, num_heads: int, ffn_dim: int = None, attn_dropout: float = 0.0, dropout: float = 0.0, ): super().__init__() self.dropout = dropout # Attention self.self_attn = WhisperSdpaAttention(embed_dim, num_heads, attn_dropout) self.self_attn_layer_norm = nn.LayerNorm(embed_dim) # FFN ffn_dim = ffn_dim if ffn_dim is not None else embed_dim * 4 self.fc1 = nn.Linear(embed_dim, ffn_dim) self.fc2 = nn.Linear(ffn_dim, embed_dim) # Output norm self.final_layer_norm = nn.LayerNorm(embed_dim)", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.965625426601993, "overlap_score": 1.0, "semantic_score": 0.9140635665049827}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.34490875253369185, "overlap_score": 0.0, "semantic_score": 0.8622718813342296}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.965625426601993, "overlap": 1.0, "semantic": 0.9140635665049827}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.34490875253369185, "overlap": 0.0, "semantic": 0.8622718813342296}, {"chunk_id": "p-88308230dda7", "combined": 0.29793036473066403, "overlap": 0.0, "semantic": 0.74482591182666}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.29644566019412444, "overlap": 0.0, "semantic": 0.741114150485311}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.28519406394666674, "overlap": 0.0, "semantic": 0.7129851598666669}, {"chunk_id": "p-0d66effb9582", "combined": 0.28394101617242756, "overlap": 0.0, "semantic": 0.7098525404310689}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26075807714173643, "overlap": 0.0, "semantic": 0.651895192854341}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.25565571858351727, "overlap": 0.0, "semantic": 0.6391392964587931}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.23061874785078995, "overlap": 0.0, "semantic": 0.5765468696269749}]}
{"symbol_id": "7934ec092992f225bc0ac4eb957660ff6a0e9b17", "symbol_name": "WhisperSdpaAttention", "query_text_overlap": "embed_dim bias attention_mask attn_output bsz hidden_states tensor num_heads tgt_len torch _shape dropout int linear bool float mask __init__ forward head_dim", "query_text_semantic": "class WhisperSdpaAttention(nn.Module): def __init__( self, embed_dim: int, num_heads: int, dropout: float = 0.0, bias: bool = True, ): super().__init__() self.embed_dim = embed_dim self.num_heads = num_heads self.dropout = dropout self.head_dim = embed_dim // num_heads self.bias = bias self.k_proj = nn.Linear(embed_dim, embed_dim, bias=False) self.v_proj = nn.Linear(embed_dim, embed_dim, bias=bias) self.q_proj = nn.Linear(embed_dim, embed_dim, bias=bias) self.out_proj = nn.Linear(embed_dim, embed_dim, bias=bias) def _shape(self, tensor: torch.Tensor, seq_len: int, bsz: int): return ( tensor.view(bsz, seq_len, self.num_heads, self.head_dim) .transpose(1, 2) .contiguous() ) def forward( self, hidden_states: torch.Tensor, attention_mask: Optional[torch.Tensor] = None, ): \"\"\" Args: attention_mask: Bool mask or float mask. Bool mask, True indicates should attend. Float mask is added to the attention score. \"\"\" bsz, tgt_len, _ = hidden_states.size() query_states = self._shape(self.q_proj(hidden_states), tgt_len, bsz) key_states = self._shape(self.k_proj(hidden_states),", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.31148355943785655, "overlap_score": 0.0, "semantic_score": 0.7787088985946413}, {"chunk_id": "p-0d66effb9582", "score": 0.3040846755023759, "overlap_score": 0.0, "semantic_score": 0.7602116887559397}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.31148355943785655, "overlap": 0.0, "semantic": 0.7787088985946413}, {"chunk_id": "p-0d66effb9582", "combined": 0.3040846755023759, "overlap": 0.0, "semantic": 0.7602116887559397}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2703307001872277, "overlap": 0.0, "semantic": 0.6758267504680693}, {"chunk_id": "p-88308230dda7", "combined": 0.2599131403065011, "overlap": 0.0, "semantic": 0.6497828507662526}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25890663455990376, "overlap": 0.0, "semantic": 0.6472665863997593}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.25442351878586916, "overlap": 0.0, "semantic": 0.6360587969646728}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2527667399756977, "overlap": 0.0, "semantic": 0.6319168499392442}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.23908148096412357, "overlap": 0.0, "semantic": 0.5977037024103089}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2370819301836641, "overlap": 0.0, "semantic": 0.5927048254591603}]}
{"symbol_id": "f6a3a790429aed20e8b4051f9c4da223bb783d25", "symbol_name": "forward_chunk", "query_text_overlap": "attn_output hidden_states bsz key_states kv_cache tgt_len torch value_states dim shape _shape cat forward_chunk k_cache new_kv_cache query_states tensor v_cache attention cache", "query_text_semantic": "Forward self-attention with kv cache.\n\n        Args:\n            hidden_states: shape (b, t, c)\n            kv_cache: shape (b, nh, t, c*2)", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8271062621520746, "overlap_score": 1.0, "semantic_score": 0.5677656553801865}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.3402031290030754, "overlap_score": 0.0, "semantic_score": 0.8505078225076885}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8271062621520746, "overlap": 1.0, "semantic": 0.5677656553801865}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3402031290030754, "overlap": 0.0, "semantic": 0.8505078225076885}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.25575166129291166, "overlap": 0.0, "semantic": 0.6393791532322791}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.24250722081721474, "overlap": 0.0, "semantic": 0.6062680520430368}, {"chunk_id": "p-88308230dda7", "combined": 0.2261023958124044, "overlap": 0.0, "semantic": 0.565255989531011}, {"chunk_id": "p-edce760829b6", "combined": 0.22360066037124093, "overlap": 0.0, "semantic": 0.5590016509281023}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.22320988048045942, "overlap": 0.0, "semantic": 0.5580247012011486}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1927781835113423, "overlap": 0.0, "semantic": 0.4819454587783557}, {"chunk_id": "p-5c1af97004f2", "combined": 0.18477089518998432, "overlap": 0.0, "semantic": 0.46192723797496077}]}
{"symbol_id": "4ad3a808e9b5244593d152213f52bd972c2f9096", "symbol_name": "forward", "query_text_overlap": "attention_mask attn_output mask bsz hidden_states tgt_len _shape bool float forward key_states query_states tensor torch value_states attn_mask dropout dropout_p embed_dim k_proj", "query_text_semantic": "Args:\n            attention_mask: Bool mask or float mask. Bool mask, True indicates should attend. Float mask is added to the attention score.", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-edce760829b6", "score": 0.31715932093106436, "overlap_score": 0.0, "semantic_score": 0.7928983023276608}, {"chunk_id": "p-5c1af97004f2", "score": 0.2960784560160174, "overlap_score": 0.0, "semantic_score": 0.7401961400400434}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-edce760829b6", "combined": 0.31715932093106436, "overlap": 0.0, "semantic": 0.7928983023276608}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2960784560160174, "overlap": 0.0, "semantic": 0.7401961400400434}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2885676464930799, "overlap": 0.0, "semantic": 0.7214191162326997}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2653055938286221, "overlap": 0.0, "semantic": 0.6632639845715553}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.231439836953744, "overlap": 0.0, "semantic": 0.57859959238436}, {"chunk_id": "p-88308230dda7", "combined": 0.21728029853351016, "overlap": 0.0, "semantic": 0.5432007463337754}, {"chunk_id": "p-9158b9f667b9", "combined": 0.21649793600743272, "overlap": 0.0, "semantic": 0.5412448400185818}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.20935591246761154, "overlap": 0.0, "semantic": 0.5233897811690288}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.20642108943520926, "overlap": 0.0, "semantic": 0.5160527235880231}]}
{"symbol_id": "81f4ae64866807395c8d5341ca04a85fbdd856d5", "symbol_name": "_shape", "query_text_overlap": "tensor _shape bsz int seq_len contiguous head_dim num_heads torch transpose view", "query_text_semantic": "def _shape(self, tensor: torch.Tensor, seq_len: int, bsz: int): return ( tensor.view(bsz, seq_len, self.num_heads, self.head_dim) .transpose(1, 2) .contiguous() )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.22224669784455378, "overlap_score": 0.0, "semantic_score": 0.5556167446113844}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.20479142059796188, "overlap_score": 0.0, "semantic_score": 0.5119785514949047}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.22224669784455378, "overlap": 0.0, "semantic": 0.5556167446113844}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.20479142059796188, "overlap": 0.0, "semantic": 0.5119785514949047}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.16962861195955514, "overlap": 0.0, "semantic": 0.4240715298988878}, {"chunk_id": "p-88308230dda7", "combined": 0.1539874329889528, "overlap": 0.0, "semantic": 0.3849685824723819}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.14838244031173653, "overlap": 0.0, "semantic": 0.3709561007793413}, {"chunk_id": "p-5c1af97004f2", "combined": 0.10637691355484309, "overlap": 0.0, "semantic": 0.2659422838871077}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.09739227169339747, "overlap": 0.0, "semantic": 0.24348067923349365}, {"chunk_id": "p-0d66effb9582", "combined": 0.07185967783340859, "overlap": 0.0, "semantic": 0.17964919458352147}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.07070588984851706, "overlap": 0.0, "semantic": 0.17676472462129264}]}
{"symbol_id": "47203a64293cf5e25b6fce7db241698e16304a03", "symbol_name": "__init__", "query_text_overlap": "embed_dim bias linear num_heads __init__ dropout int bool float head_dim k_proj out_proj q_proj super v_proj", "query_text_semantic": "def __init__( self, embed_dim: int, num_heads: int, dropout: float = 0.0, bias: bool = True, ): super().__init__() self.embed_dim = embed_dim self.num_heads = num_heads self.dropout = dropout self.head_dim = embed_dim // num_heads self.bias = bias self.k_proj = nn.Linear(embed_dim, embed_dim, bias=False) self.v_proj = nn.Linear(embed_dim, embed_dim, bias=bias) self.q_proj = nn.Linear(embed_dim, embed_dim, bias=bias) self.out_proj = nn.Linear(embed_dim, embed_dim, bias=bias)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.2696253329987959, "overlap_score": 0.0, "semantic_score": 0.6740633324969897}, {"chunk_id": "p-0d66effb9582", "score": 0.26863459363534425, "overlap_score": 0.0, "semantic_score": 0.6715864840883606}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2696253329987959, "overlap": 0.0, "semantic": 0.6740633324969897}, {"chunk_id": "p-0d66effb9582", "combined": 0.26863459363534425, "overlap": 0.0, "semantic": 0.6715864840883606}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.24857937769820052, "overlap": 0.0, "semantic": 0.6214484442455013}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.24017621197066608, "overlap": 0.0, "semantic": 0.6004405299266652}, {"chunk_id": "p-88308230dda7", "combined": 0.21298801428663627, "overlap": 0.0, "semantic": 0.5324700357165907}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2088373799366565, "overlap": 0.0, "semantic": 0.5220934498416412}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2002279525375552, "overlap": 0.0, "semantic": 0.500569881343888}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18658441508690327, "overlap": 0.0, "semantic": 0.4664610377172581}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.16348804310425458, "overlap": 0.0, "semantic": 0.4087201077606364}]}
{"symbol_id": "78010d7176bd419fb63cf12e2b619926a359188b", "symbol_name": "sinusoids", "query_text_overlap": "channels torch sinusoids scaled_time arange int inv_timescales length log_timescale_increment max_timescale view positional cat cos dim exp float log math sin", "query_text_semantic": "Returns sinusoids for positional embedding", "best": {"chunk_id": "p-88308230dda7", "score": 0.8548867238220881, "overlap_score": 1.0, "semantic_score": 0.6372168095552204}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ebeeda9fc683", "score": 0.3341061195006551, "overlap_score": 0.0, "semantic_score": 0.8352652987516377}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.8548867238220881, "overlap": 1.0, "semantic": 0.6372168095552204}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3341061195006551, "overlap": 0.0, "semantic": 0.8352652987516377}, {"chunk_id": "p-ae67c9c86886", "combined": 0.32624494551097893, "overlap": 0.0, "semantic": 0.8156123637774473}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2927033078311125, "overlap": 0.0, "semantic": 0.7317582695777811}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.27391773496026134, "overlap": 0.0, "semantic": 0.6847943374006533}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2669045702919697, "overlap": 0.0, "semantic": 0.6672614257299242}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.24795682542265263, "overlap": 0.0, "semantic": 0.6198920635566315}, {"chunk_id": "p-0d66effb9582", "combined": 0.217180647896009, "overlap": 0.0, "semantic": 0.5429516197400225}, {"chunk_id": "p-edce760829b6", "combined": 0.19362757266037425, "overlap": 0.0, "semantic": 0.4840689316509356}]}
{"symbol_id": "5d472f0d50e24c982de248b45f490fa5a58f2a89", "symbol_name": "ResidualVQ", "query_text_overlap": "rvq_dim input_dim codebook_dim all_indices codebook_size int output_dim num_quantizers residual codes quantizers dimension __init__ identity indices_i input_proj kernel_size quantizer residualvq torch", "query_text_semantic": "class ResidualVQ(nn.Module): def __init__( self, input_dim: int = 768, # Input dimension, unrelated to RVQ rvq_dim=None, # RVQ dimension. If different from input_dim/output_dim, will add input_dim->rvq_dim/rvq_dim->output_dim projection output_dim: int = None, # Output dimension, unrelated to RVQ num_quantizers: int = 8, codebook_size: int = 1024, codebook_dim: int = 256, # Dimension of each codebook. If different from rvq_dim, will add rvq_dim->codebook_dim and codebook_dim->rvq_dim projections ): super().__init__() self.input_dim = input_dim self.num_quantizers = num_quantizers self.codebook_size = codebook_size self.codebook_dim = codebook_dim self.rvq_dim = rvq_dim self.input_proj = ( WNConv1d(input_dim, rvq_dim, kernel_size=1) if input_dim != rvq_dim else nn.Identity() ) self.output_proj = ( WNConv1d(rvq_dim, output_dim, kernel_size=1) if rvq_dim != output_dim else nn.Identity() ) self.quantizers = nn.ModuleList( [ VectorQuantize( input_dim=rvq_dim, codebook_size=self.codebook_size, codebook_dim=codebook_dim, ) for i in range(num_quantizers)", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8708919671394003, "overlap_score": 1.0, "semantic_score": 0.6772299178485008}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.5909288243275825, "overlap_score": 0.5140378983115924, "semantic_score": 0.7062652133515677}, {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8708919671394003, "overlap": 1.0, "semantic": 0.6772299178485008}, {"chunk_id": "p-0d66effb9582", "combined": 0.5909288243275825, "overlap": 0.5140378983115924, "semantic": 0.7062652133515677}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2550563012080347, "overlap": 0.0, "semantic": 0.6376407530200867}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.19461415588847988, "overlap": 0.0, "semantic": 0.4865353897211997}, {"chunk_id": "p-88308230dda7", "combined": 0.19369897896312874, "overlap": 0.0, "semantic": 0.48424744740782183}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.17578988119309213, "overlap": 0.0, "semantic": 0.43947470298273034}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15553928301583184, "overlap": 0.0, "semantic": 0.38884820753957955}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.15103953047628155, "overlap": 0.0, "semantic": 0.37759882619070384}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.11585211214997725, "overlap": 0.0, "semantic": 0.2896302803749431}]}
{"symbol_id": "58e70bd18ad0dbd51caaf12effc6b17fbb2598c4", "symbol_name": "decode_codes", "query_text_overlap": "codes emb quantizer shape device embeddings quantizers tensor code_i decode_codes quantized_i torch decode_code dtype enumerate float32 out_project output_proj rvq_dim zeros", "query_text_semantic": "Decode codes from multiple quantizers to embeddings.\n\n        Args:\n            codes: Tensor of shape (nq, B, T) containing code indices for each quantizer.\n\n        Returns:\n            emb: Tensor of shape (B, D, T) representing the decoded embeddings.", "best": {"chunk_id": "p-0d66effb9582", "score": 0.8351612843271358, "overlap_score": 1.0, "semantic_score": 0.5879032108178395}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.8075241923311034, "overlap_score": 0.8294871038186861, "semantic_score": 0.7745798250997293}, {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-0d66effb9582", "combined": 0.8351612843271358, "overlap": 1.0, "semantic": 0.5879032108178395}, {"chunk_id": "p-ae67c9c86886", "combined": 0.8075241923311034, "overlap": 0.8294871038186861, "semantic": 0.7745798250997293}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2739975152109337, "overlap": 0.0, "semantic": 0.6849937880273341}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.24475826383584667, "overlap": 0.0, "semantic": 0.6118956595896167}, {"chunk_id": "p-88308230dda7", "combined": 0.23917915822409067, "overlap": 0.0, "semantic": 0.5979478955602266}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2336199252061335, "overlap": 0.0, "semantic": 0.5840498130153338}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.22351674855771791, "overlap": 0.0, "semantic": 0.5587918713942948}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2187074915032152, "overlap": 0.0, "semantic": 0.546768728758038}, {"chunk_id": "p-edce760829b6", "combined": 0.2037571354585333, "overlap": 0.0, "semantic": 0.5093928386463332}]}
{"symbol_id": "e6fd53ca807b9683f87df3eb8b617fb795831a31", "symbol_name": "encode_codes", "query_text_overlap": "all_indices residual encode_codes indices_i quantizer torch z_q_i append clone encode_code enumerate float input_proj quantizers stack tensor ensure fp32 quantize tokens", "query_text_semantic": "def encode_codes(self, z: torch.Tensor): z = self.input_proj(z) residual = z.clone().float() # (B, D, T), ensure fp32 all_indices = [] # Quantize to tokens for i, quantizer in enumerate(self.quantizers): # (B, D, T), (B), scalar, (B, T), (B, D', T), ensure fp32 z_q_i, indices_i = quantizer.encode_code(residual) residual = residual - z_q_i all_indices.append(indices_i) # (B, T) all_indices = torch.stack(all_indices) # (N, B, T) return all_indices", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8983696627392732, "overlap_score": 1.0, "semantic_score": 0.7459241568481833}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.5685196207715666, "overlap_score": 0.5140378983115924, "semantic_score": 0.650242204461528}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.5420753215015721, "overlap_score": 0.48438311657536165, "semantic_score": 0.6286136288908877}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8983696627392732, "overlap": 1.0, "semantic": 0.7459241568481833}, {"chunk_id": "p-0d66effb9582", "combined": 0.5685196207715666, "overlap": 0.5140378983115924, "semantic": 0.650242204461528}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5420753215015721, "overlap": 0.48438311657536165, "semantic": 0.6286136288908877}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5166947947851475, "overlap": 0.5460414483551626, "semantic": 0.47267481443012477}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.47694010161979095, "overlap": 0.46429607269751083, "semantic": 0.495906145003211}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.37256132937787123, "overlap": 0.35903627524272896, "semantic": 0.3928489105805846}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.20022228571469602, "overlap": 0.0, "semantic": 0.5005557142867401}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.18810222493957954, "overlap": 0.0, "semantic": 0.47025556234894883}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.14408847258676982, "overlap": 0.0, "semantic": 0.36022118146692456}]}
{"symbol_id": "081b405bbb7738841b02b35cf7996c7cbbf31bf2", "symbol_name": "__init__", "query_text_overlap": "rvq_dim input_dim codebook_dim codebook_size int output_dim num_quantizers __init__ dimension identity kernel_size wnconv1d rvq input_proj modulelist output_proj quantizers range super vectorquantize", "query_text_semantic": "def __init__( self, input_dim: int = 768, # Input dimension, unrelated to RVQ rvq_dim=None, # RVQ dimension. If different from input_dim/output_dim, will add input_dim->rvq_dim/rvq_dim->output_dim projection output_dim: int = None, # Output dimension, unrelated to RVQ num_quantizers: int = 8, codebook_size: int = 1024, codebook_dim: int = 256, # Dimension of each codebook. If different from rvq_dim, will add rvq_dim->codebook_dim and codebook_dim->rvq_dim projections ): super().__init__() self.input_dim = input_dim self.num_quantizers = num_quantizers self.codebook_size = codebook_size self.codebook_dim = codebook_dim self.rvq_dim = rvq_dim self.input_proj = ( WNConv1d(input_dim, rvq_dim, kernel_size=1) if input_dim != rvq_dim else nn.Identity() ) self.output_proj = ( WNConv1d(rvq_dim, output_dim, kernel_size=1) if rvq_dim != output_dim else nn.Identity() ) self.quantizers = nn.ModuleList( [ VectorQuantize( input_dim=rvq_dim, codebook_size=self.codebook_size, codebook_dim=codebook_dim, ) for i in range(num_quantizers) ] )", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.2840247812470972, "overlap_score": 0.0, "semantic_score": 0.7100619531177429}, {"chunk_id": "p-0d66effb9582", "score": 0.28160915595804475, "overlap_score": 0.0, "semantic_score": 0.7040228898951119}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2840247812470972, "overlap": 0.0, "semantic": 0.7100619531177429}, {"chunk_id": "p-0d66effb9582", "combined": 0.28160915595804475, "overlap": 0.0, "semantic": 0.7040228898951119}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2630514429990098, "overlap": 0.0, "semantic": 0.6576286074975244}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.19831699256495533, "overlap": 0.0, "semantic": 0.4957924814123883}, {"chunk_id": "p-88308230dda7", "combined": 0.17569912475172308, "overlap": 0.0, "semantic": 0.43924781187930767}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.17202540525519744, "overlap": 0.0, "semantic": 0.43006351313799357}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.16325322008099089, "overlap": 0.0, "semantic": 0.4081330502024772}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.14442310510296233, "overlap": 0.0, "semantic": 0.3610577627574058}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.1107097362421893, "overlap": 0.0, "semantic": 0.27677434060547323}]}
{"symbol_id": "8b5a04d481c0367d5f24bba18192411302d2a779", "symbol_name": "VectorQuantize", "query_text_overlap": "codebook_dim codebook_size float input_dim ensure fp32 codebook torch register_buffer embed_id int __init__ embed encodings identity in_project kernel_size rearrange tensor vectorquantize", "query_text_semantic": "class VectorQuantize(nn.Module): def __init__( self, input_dim: int, codebook_size: int, codebook_dim: int, ): super().__init__() self.input_dim = input_dim self.codebook_size = codebook_size self.codebook_dim = codebook_dim self.in_project = ( WNConv1d( self.input_dim, self.codebook_dim, kernel_size=1 ) # (B, D, T) -> (B, D', T) if self.input_dim != self.codebook_dim else nn.Identity() ) self.out_project = ( WNConv1d( self.codebook_dim, self.input_dim, kernel_size=1 ) # (B, D', T) -> (B, D, T) if self.input_dim != self.codebook_dim else nn.Identity() ) # Initialize codebook and EMA buffers self.register_buffer( \"codebook\", torch.zeros(codebook_size, codebook_dim).float() ) # (codebook_size, D'), ensure fp32 # Place holder, not used in inference self.register_buffer(\"inited\", torch.tensor([True], dtype=torch.bool)) # (1) self.register_buffer( \"cluster_size\", torch.zeros(codebook_size).float() ) # (codebook_size), ensure fp32 self.register_buffer( \"embed_avg\", self.codebook.clone().float() ) # (codebook_size, D'), ensure fp32 def decode_code(self, embed_id): # embed_id: (B, T)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.2907126845219994, "overlap_score": 0.0, "semantic_score": 0.7267817113049985}, {"chunk_id": "p-ae67c9c86886", "score": 0.2374861448937975, "overlap_score": 0.0, "semantic_score": 0.5937153622344937}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.2907126845219994, "overlap": 0.0, "semantic": 0.7267817113049985}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2374861448937975, "overlap": 0.0, "semantic": 0.5937153622344937}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2294868741931505, "overlap": 0.0, "semantic": 0.5737171854828762}, {"chunk_id": "p-88308230dda7", "combined": 0.18017634223388823, "overlap": 0.0, "semantic": 0.4504408555847205}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.15813654526287538, "overlap": 0.0, "semantic": 0.39534136315718843}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.126407165930966, "overlap": 0.0, "semantic": 0.316017914827415}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1157036812446709, "overlap": 0.0, "semantic": 0.28925920311167724}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.0814492949428467, "overlap": 0.0, "semantic": 0.20362323735711674}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.06630797963745598, "overlap": 0.0, "semantic": 0.16576994909363996}]}
{"symbol_id": "b3873dbe6e1b3d1246cb87df78abd92fec3573aa", "symbol_name": "encode_code", "query_text_overlap": "float z_q indices z_e ensure fp32 codebook dist encodings rearrange encode_code keepdim pow sum codebook_size decode_code detach in_project max out_project", "query_text_semantic": "def encode_code(self, z: torch.Tensor): # z: (B, D, T) # logging.info(f\"{self.cluster_size = }, {self.codebook = }, {self.embed_avg = }, {self.inited = }\") z = z.float() # Ensure fp32 z_e = self.in_project(z).float() # (B, D', T), ensure fp32 # Rearrange for quantization encodings = rearrange(z_e, \"b d t -> (b t) d\").float() # (B*T, D'), ensure fp32 # Quantization dist = ( encodings.pow(2).sum(1, keepdim=True) # (B*T, 1) - 2 * encodings @ self.codebook.float().t() # (B*T, codebook_size) + self.codebook.float().pow(2).sum(1, keepdim=True).t() ) # (1, codebook_size) # dist: (B*T, codebook_size) indices = (-dist).max(1)[1] # (B*T) indices = rearrange(indices, \"(b t) -> b t\", b=z.size(0)) # (B, T) # Get quantized vectors z_q = self.decode_code(indices).float() # (B, D', T), ensure fp32 # Straight-through estimator z_q", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.24300420043053783, "overlap_score": 0.0, "semantic_score": 0.6075105010763445}, {"chunk_id": "p-ae67c9c86886", "score": 0.22941060173232147, "overlap_score": 0.0, "semantic_score": 0.5735265043308037}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.24300420043053783, "overlap": 0.0, "semantic": 0.6075105010763445}, {"chunk_id": "p-ae67c9c86886", "combined": 0.22941060173232147, "overlap": 0.0, "semantic": 0.5735265043308037}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1999714802054666, "overlap": 0.0, "semantic": 0.49992870051366645}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.19334888674345277, "overlap": 0.0, "semantic": 0.4833722168586319}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.18862664638880905, "overlap": 0.0, "semantic": 0.4715666159720226}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.1670221879529474, "overlap": 0.0, "semantic": 0.41755546988236847}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.15367942495900372, "overlap": 0.0, "semantic": 0.38419856239750927}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.1266314364736724, "overlap": 0.0, "semantic": 0.31657859118418097}, {"chunk_id": "p-edce760829b6", "combined": 0.12270672613459771, "overlap": 0.0, "semantic": 0.30676681533649425}]}
{"symbol_id": "fb0596ca3c93c240b743500c4c9bde018e410a47", "symbol_name": "decode_code", "query_text_overlap": "embed_id decode_code embed codebook embedding float transpose ensure fp32", "query_text_semantic": "def decode_code(self, embed_id): # embed_id: (B, T) embed = ( F.embedding(embed_id, self.codebook).transpose(1, 2).float() ) # (B, D', T), ensure fp32 return embed", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.23876561511495942, "overlap_score": 0.0, "semantic_score": 0.5969140377873985}, {"chunk_id": "p-0d66effb9582", "score": 0.22308611617429586, "overlap_score": 0.0, "semantic_score": 0.5577152904357396}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.23876561511495942, "overlap": 0.0, "semantic": 0.5969140377873985}, {"chunk_id": "p-0d66effb9582", "combined": 0.22308611617429586, "overlap": 0.0, "semantic": 0.5577152904357396}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.21015699294015652, "overlap": 0.0, "semantic": 0.5253924823503913}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.18905642276201684, "overlap": 0.0, "semantic": 0.47264105690504205}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.18358364438927596, "overlap": 0.0, "semantic": 0.45895911097318987}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.17037904969243653, "overlap": 0.0, "semantic": 0.4259476242310913}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.16197434078401296, "overlap": 0.0, "semantic": 0.40493585196003234}, {"chunk_id": "p-88308230dda7", "combined": 0.1591404058670203, "overlap": 0.0, "semantic": 0.39785101466755074}, {"chunk_id": "p-9158b9f667b9", "combined": 0.13144903547997258, "overlap": 0.0, "semantic": 0.32862258869993144}]}
{"symbol_id": "6406e7f720502d7c238ae2b1decc08ab1f16a5ef", "symbol_name": "__init__", "query_text_overlap": "codebook_dim codebook_size input_dim register_buffer torch __init__ codebook float int identity kernel_size wnconv1d zeros ensure fp32 bool clone dtype in_project out_project", "query_text_semantic": "def __init__( self, input_dim: int, codebook_size: int, codebook_dim: int, ): super().__init__() self.input_dim = input_dim self.codebook_size = codebook_size self.codebook_dim = codebook_dim self.in_project = ( WNConv1d( self.input_dim, self.codebook_dim, kernel_size=1 ) # (B, D, T) -> (B, D', T) if self.input_dim != self.codebook_dim else nn.Identity() ) self.out_project = ( WNConv1d( self.codebook_dim, self.input_dim, kernel_size=1 ) # (B, D', T) -> (B, D, T) if self.input_dim != self.codebook_dim else nn.Identity() ) # Initialize codebook and EMA buffers self.register_buffer( \"codebook\", torch.zeros(codebook_size, codebook_dim).float() ) # (codebook_size, D'), ensure fp32 # Place holder, not used in inference self.register_buffer(\"inited\", torch.tensor([True], dtype=torch.bool)) # (1) self.register_buffer( \"cluster_size\", torch.zeros(codebook_size).float() ) # (codebook_size), ensure fp32 self.register_buffer( \"embed_avg\", self.codebook.clone().float() ) # (codebook_size, D'), ensure fp32", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.30222572463199016, "overlap_score": 0.0, "semantic_score": 0.7555643115799754}, {"chunk_id": "p-0d66effb9582", "score": 0.25666284856725835, "overlap_score": 0.0, "semantic_score": 0.6416571214181459}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.30222572463199016, "overlap": 0.0, "semantic": 0.7555643115799754}, {"chunk_id": "p-0d66effb9582", "combined": 0.25666284856725835, "overlap": 0.0, "semantic": 0.6416571214181459}, {"chunk_id": "p-ae67c9c86886", "combined": 0.21762319633573798, "overlap": 0.0, "semantic": 0.5440579908393449}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.1948080873190918, "overlap": 0.0, "semantic": 0.48702021829772946}, {"chunk_id": "p-88308230dda7", "combined": 0.18017555436835042, "overlap": 0.0, "semantic": 0.45043888592087605}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.15011945395545093, "overlap": 0.0, "semantic": 0.3752986348886273}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.12485515114365034, "overlap": 0.0, "semantic": 0.31213787785912583}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.12100051435982483, "overlap": 0.0, "semantic": 0.30250128589956204}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.11093808932921077, "overlap": 0.0, "semantic": 0.2773452233230269}]}
{"symbol_id": "c92e1c53176dce6fb04e7fd1f5d8824668891ef7", "symbol_name": "WNConvTranspose1d", "query_text_overlap": "wnconvtranspose1d convtranspose1d weight_norm", "query_text_semantic": "def WNConvTranspose1d(*args, **kwargs): return weight_norm(nn.ConvTranspose1d(*args, **kwargs))", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.34338707103235705, "overlap_score": 0.0, "semantic_score": 0.8584676775808926}, {"chunk_id": "p-ae67c9c86886", "score": 0.25757852740111814, "overlap_score": 0.0, "semantic_score": 0.6439463185027954}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.34338707103235705, "overlap": 0.0, "semantic": 0.8584676775808926}, {"chunk_id": "p-ae67c9c86886", "combined": 0.25757852740111814, "overlap": 0.0, "semantic": 0.6439463185027954}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.24304379209323088, "overlap": 0.0, "semantic": 0.6076094802330771}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.22341793970922794, "overlap": 0.0, "semantic": 0.5585448492730698}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.1703310203479621, "overlap": 0.0, "semantic": 0.42582755086990526}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1490898774864322, "overlap": 0.0, "semantic": 0.3727246937160805}, {"chunk_id": "p-88308230dda7", "combined": 0.14276730571875162, "overlap": 0.0, "semantic": 0.35691826429687906}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.12503641922167175, "overlap": 0.0, "semantic": 0.31259104805417937}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1136668970350686, "overlap": 0.0, "semantic": 0.2841672425876715}]}
{"symbol_id": "5e641b9931bebfb0938d860cd0d6577d9f6969f4", "symbol_name": "WNConv1d", "query_text_overlap": "wnconv1d conv1d weight_norm", "query_text_semantic": "def WNConv1d(*args, **kwargs): return weight_norm(nn.Conv1d(*args, **kwargs))", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3881002909716126, "overlap_score": 0.0, "semantic_score": 0.9702507274290314}, {"chunk_id": "p-0212d69b9ec4", "score": 0.34244332078972206, "overlap_score": 0.0, "semantic_score": 0.8561083019743051}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3881002909716126, "overlap": 0.0, "semantic": 0.9702507274290314}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.34244332078972206, "overlap": 0.0, "semantic": 0.8561083019743051}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3117152681976365, "overlap": 0.0, "semantic": 0.7792881704940913}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2513514801157721, "overlap": 0.0, "semantic": 0.6283787002894302}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.17829501004353016, "overlap": 0.0, "semantic": 0.44573752510882536}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.15016382479487309, "overlap": 0.0, "semantic": 0.37540956198718267}, {"chunk_id": "p-88308230dda7", "combined": 0.14225738236248212, "overlap": 0.0, "semantic": 0.3556434559062053}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.1314759225019215, "overlap": 0.0, "semantic": 0.3286898062548037}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.11458225465516046, "overlap": 0.0, "semantic": 0.28645563663790113}]}
{"symbol_id": "a9b62df6b345454490fb2f1b3c77d53583922902", "symbol_name": "train", "query_text_overlap": "config train device model accelerator optimizer scheduler trainloader tokens tokens_mask total_steps trial batch_size cuda current_gpu logs_folder prepare print state_dict torch", "query_text_semantic": "trial is only used when we are sweeping hyperparameters.", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.5998787956620302, "overlap_score": 0.6348739065980186, "semantic_score": 0.5473861292580475}, {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5998787956620302, "overlap": 0.6348739065980186, "semantic": 0.5473861292580475}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3670804722743946, "overlap": 0.611800787123991, "semantic": 0.0}, {"chunk_id": "p-88308230dda7", "combined": 0.3662416031077907, "overlap": 0.4874636667732129, "semantic": 0.18440850760965746}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.31722517322749394, "overlap": 0.5287086220458233, "semantic": 0.0}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.27583789082695054, "overlap": 0.1565872608873183, "semantic": 0.45471383573639884}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.21290385598579492, "overlap": 0.24317054385579015, "semantic": 0.16750382418080212}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2008124988648629, "overlap": 0.149013421359806, "semantic": 0.27851111512244825}, {"chunk_id": "p-021b4cb4f328", "combined": 0.1884804516558679, "overlap": 0.20158423509173995, "semantic": 0.16882477650205982}]}
{"symbol_id": "54bbaf8717886f3dd07d514bc487075263e9c8f4", "symbol_name": "create_dataloaders", "query_text_overlap": "batch_size device collate_fn num_workers create_dataloaders dataloader dataset_dir int pin_memory shuffle str tokenizeddataset train_datasets trainloader trainset validation_datasets valloader valset bool infinite_train", "query_text_semantic": "def create_dataloaders( train_datasets: str, validation_datasets: str, batch_size: int, device, # for debug infinite_train: bool = False, num_workers: int = 0, ): trainset = TokenizedDataset(dataset_dir=train_datasets, device=device) valset = TokenizedDataset(dataset_dir=validation_datasets, device=device) trainloader = DataLoader( trainset, # batch_sampler=trainsampler, batch_size=batch_size, collate_fn=collate_fn, num_workers=12, pin_memory=True, shuffle=True, ) valloader = DataLoader( valset, # batch_sampler=valsampler, batch_size=batch_size, collate_fn=collate_fn, num_workers=num_workers, pin_memory=True, shuffle=False, ) return trainloader, valloader", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3716917193711419, "overlap_score": 0.0, "semantic_score": 0.9292292984278547}, {"chunk_id": "p-0d66effb9582", "score": 0.36321713999697564, "overlap_score": 0.0, "semantic_score": 0.908042849992439}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3716917193711419, "overlap": 0.0, "semantic": 0.9292292984278547}, {"chunk_id": "p-0d66effb9582", "combined": 0.36321713999697564, "overlap": 0.0, "semantic": 0.908042849992439}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3508463777901212, "overlap": 0.0, "semantic": 0.8771159444753029}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.28466037056741417, "overlap": 0.0, "semantic": 0.7116509264185354}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2819479010174987, "overlap": 0.0, "semantic": 0.7048697525437468}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.27024088016992365, "overlap": 0.0, "semantic": 0.6756022004248091}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26564922893959925, "overlap": 0.0, "semantic": 0.6641230723489981}, {"chunk_id": "p-88308230dda7", "combined": 0.25775935709632974, "overlap": 0.0, "semantic": 0.6443983927408243}, {"chunk_id": "p-5c1af97004f2", "combined": 0.25477483688860464, "overlap": 0.0, "semantic": 0.6369370922215115}]}
{"symbol_id": "30116e70c6352bd74cf61c064122f8a3b1c0a2b6", "symbol_name": "BucketSampler", "query_text_overlap": "bins current_bin int batch_size lengths shuffle epoch is_infinite list random_seed append rng _create_bins _shuffle_bins bin_ bin_indices bool bucketsampler idx indices_with_lengths", "query_text_semantic": "Groups samples of similar lengths into bins to minimize padding.", "best": {"chunk_id": "p-0212d69b9ec4", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.3730843261950695, "overlap_score": 0.0, "semantic_score": 0.9327108154876737}, {"chunk_id": "p-5c1af97004f2", "score": 0.36203871918412456, "overlap_score": 0.0, "semantic_score": 0.9050967979603114}], "topk_raw": [{"chunk_id": "p-0212d69b9ec4", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3730843261950695, "overlap": 0.0, "semantic": 0.9327108154876737}, {"chunk_id": "p-5c1af97004f2", "combined": 0.36203871918412456, "overlap": 0.0, "semantic": 0.9050967979603114}, {"chunk_id": "p-88308230dda7", "combined": 0.3463193266313147, "overlap": 0.0, "semantic": 0.8657983165782867}, {"chunk_id": "p-0d66effb9582", "combined": 0.3300982278750982, "overlap": 0.0, "semantic": 0.8252455696877454}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3243160160150456, "overlap": 0.0, "semantic": 0.810790040037614}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.31794354017818194, "overlap": 0.0, "semantic": 0.7948588504454548}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.2401873915445988, "overlap": 0.0, "semantic": 0.600468478861497}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.20852238907254272, "overlap": 0.0, "semantic": 0.5213059726813568}, {"chunk_id": "p-ae67c9c86886", "combined": 0.19711815216232198, "overlap": 0.0, "semantic": 0.49279538040580495}]}
{"symbol_id": "4bc2fc88f2ca40cd60ec00d253574fb73f7f3df1", "symbol_name": "__len__", "query_text_overlap": "__len__ bins len", "query_text_semantic": "def __len__(self): return len(self.bins)", "best": {"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.31000020568348174, "overlap_score": 0.0, "semantic_score": 0.7750005142087043}, {"chunk_id": "p-0d66effb9582", "score": 0.266446638997767, "overlap_score": 0.0, "semantic_score": 0.6661165974944174}], "topk_raw": [{"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.31000020568348174, "overlap": 0.0, "semantic": 0.7750005142087043}, {"chunk_id": "p-0d66effb9582", "combined": 0.266446638997767, "overlap": 0.0, "semantic": 0.6661165974944174}, {"chunk_id": "p-5c1af97004f2", "combined": 0.22583302257242074, "overlap": 0.0, "semantic": 0.5645825564310518}, {"chunk_id": "p-ae67c9c86886", "combined": 0.22436540833089647, "overlap": 0.0, "semantic": 0.5609135208272411}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2044051678421925, "overlap": 0.0, "semantic": 0.5110129196054812}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.19474736255648473, "overlap": 0.0, "semantic": 0.48686840639121176}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1939761210420462, "overlap": 0.0, "semantic": 0.48494030260511545}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.19174790717057333, "overlap": 0.0, "semantic": 0.47936976792643327}, {"chunk_id": "p-88308230dda7", "combined": 0.17990155809708797, "overlap": 0.0, "semantic": 0.4497538952427199}]}
{"symbol_id": "09075ef6a31f9eef922e60a6f32b349385a1d45e", "symbol_name": "__iter__", "query_text_overlap": "epoch __iter__ bin_indices _shuffle_bins bins is_infinite local_step shuffle yield not break", "query_text_semantic": "def __iter__(self): epoch = 0 while True: if self.shuffle: self._shuffle_bins(epoch) for bin_indices in self.bins: yield bin_indices self.local_step += 1 if not self.is_infinite: break epoch += 1", "best": {"chunk_id": "p-88308230dda7", "score": 0.7688281166381656, "overlap_score": 1.0, "semantic_score": 0.422070291595414}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.2668705290038735, "overlap_score": 0.0, "semantic_score": 0.6671763225096836}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.7688281166381656, "overlap": 1.0, "semantic": 0.422070291595414}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2668705290038735, "overlap": 0.0, "semantic": 0.6671763225096836}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2516947537246924, "overlap": 0.0, "semantic": 0.629236884311731}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.24086757178224807, "overlap": 0.0, "semantic": 0.6021689294556202}, {"chunk_id": "p-ae67c9c86886", "combined": 0.20386055230620936, "overlap": 0.0, "semantic": 0.5096513807655234}, {"chunk_id": "p-0d66effb9582", "combined": 0.1994643171369661, "overlap": 0.0, "semantic": 0.4986607928424152}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.17247515646707537, "overlap": 0.0, "semantic": 0.4311878911676884}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.16485979470348686, "overlap": 0.0, "semantic": 0.4121494867587171}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.163178405838977, "overlap": 0.0, "semantic": 0.40794601459744245}]}
{"symbol_id": "105b3a440bb96e4664cc6ef7a6f90e0c3bfdda44", "symbol_name": "_shuffle_bins", "query_text_overlap": "rng _shuffle_bins bin_ bins epoch shuffle int random random_seed randomstate", "query_text_semantic": "def _shuffle_bins(self, epoch: int): rng = np.random.RandomState(epoch + self.random_seed) rng.shuffle(self.bins) for bin_ in self.bins: rng.shuffle(bin_)", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-5c1af97004f2", "score": 0.38909779153299395, "overlap_score": 0.0, "semantic_score": 0.9727444788324848}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.38909779153299395, "overlap": 0.0, "semantic": 0.9727444788324848}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.275848098369898, "overlap": 0.0, "semantic": 0.6896202459247449}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2659902984428168, "overlap": 0.0, "semantic": 0.6649757461070419}, {"chunk_id": "p-ae67c9c86886", "combined": 0.25737595397492297, "overlap": 0.0, "semantic": 0.6434398849373074}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.24849923175092675, "overlap": 0.0, "semantic": 0.6212480793773169}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.24010601161882406, "overlap": 0.0, "semantic": 0.6002650290470601}, {"chunk_id": "p-9158b9f667b9", "combined": 0.23533527199952445, "overlap": 0.0, "semantic": 0.5883381799988111}, {"chunk_id": "p-88308230dda7", "combined": 0.22234204538093008, "overlap": 0.0, "semantic": 0.5558551134523252}]}
{"symbol_id": "93444344ec5dc35ff00f5b1f5775974652c57036", "symbol_name": "_create_bins", "query_text_overlap": "current_bin bins append int list _create_bins batch_size idx indices_with_lengths lengths enumerate key len sorted lambda", "query_text_semantic": "def _create_bins(self, lengths: List[int], batch_size: int) -> List[List[int]]: indices_with_lengths = sorted(enumerate(lengths), key=lambda x: x[1]) bins, current_bin = [], [] for idx, _ in indices_with_lengths: current_bin.append(idx) if len(current_bin) >= batch_size: bins.append(current_bin) current_bin = [] if current_bin: bins.append(current_bin) return bins", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.34644667477595315, "overlap_score": 0.0, "semantic_score": 0.8661166869398829}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.3176588944561636, "overlap_score": 0.0, "semantic_score": 0.7941472361404089}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.34644667477595315, "overlap": 0.0, "semantic": 0.8661166869398829}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3176588944561636, "overlap": 0.0, "semantic": 0.7941472361404089}, {"chunk_id": "p-0d66effb9582", "combined": 0.3087522903601807, "overlap": 0.0, "semantic": 0.7718807259004518}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.2824604852254146, "overlap": 0.0, "semantic": 0.7061512130635366}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2695065299885959, "overlap": 0.0, "semantic": 0.6737663249714898}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.22734660560772557, "overlap": 0.0, "semantic": 0.5683665140193139}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.21365939517094193, "overlap": 0.0, "semantic": 0.5341484879273548}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.211754159442063, "overlap": 0.0, "semantic": 0.5293853986051574}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.1688460823967761, "overlap": 0.0, "semantic": 0.4221152059919402}]}
{"symbol_id": "72522df67f3b8963e465ee2727eeb0d5503241e3", "symbol_name": "__init__", "query_text_overlap": "batch_size int is_infinite random_seed shuffle __init__ bool lengths _create_bins bins list local_step", "query_text_semantic": "def __init__( self, lengths: List[int], batch_size: int, shuffle: bool = True, is_infinite: bool = True, random_seed: int = 42, ): self.shuffle = shuffle self.batch_size = batch_size self.is_infinite = is_infinite self.random_seed = random_seed self.local_step = 0 self.bins = self._create_bins(lengths, batch_size)", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.35973317211172556, "overlap_score": 0.0, "semantic_score": 0.8993329302793138}, {"chunk_id": "p-ae67c9c86886", "score": 0.3528053168931183, "overlap_score": 0.0, "semantic_score": 0.8820132922327957}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.35973317211172556, "overlap": 0.0, "semantic": 0.8993329302793138}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3528053168931183, "overlap": 0.0, "semantic": 0.8820132922327957}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3360924187120661, "overlap": 0.0, "semantic": 0.8402310467801651}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3080665344789131, "overlap": 0.0, "semantic": 0.7701663361972826}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3069475519277607, "overlap": 0.0, "semantic": 0.7673688798194016}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.2889776125472419, "overlap": 0.0, "semantic": 0.7224440313681048}, {"chunk_id": "p-88308230dda7", "combined": 0.2863515271575725, "overlap": 0.0, "semantic": 0.7158788178939313}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.26125120806660934, "overlap": 0.0, "semantic": 0.6531280201665233}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.2582841120444575, "overlap": 0.0, "semantic": 0.6457102801111437}]}
{"symbol_id": "901b341ac7774915b513cdf9e3c64ff971ab853d", "symbol_name": "collate_fn", "query_text_overlap": "item tokens tokens_mask audio_segment_len text_segment_len audio text text_tokens append audio_tokens batch batch_first collate_fn interleave interleave_masks_concat interleave_tokens_concat pad_sequence audio_tokens_flatten dict list", "query_text_semantic": "Collate function for tokenized audio and text.\n    Merges variable-length audio/text into a single padded tensor.", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.9471815183509715, "overlap_score": 1.0, "semantic_score": 0.8679537958774287}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.8931400256192816, "overlap_score": 0.8219000426988027, "semantic_score": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.8780282797044521, "overlap_score": 0.9236949441043178, "semantic_score": 0.8095282831046533}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.9471815183509715, "overlap": 1.0, "semantic": 0.8679537958774287}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.8931400256192816, "overlap": 0.8219000426988027, "semantic": 1.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.8780282797044521, "overlap": 0.9236949441043178, "semantic": 0.8095282831046533}, {"chunk_id": "p-88308230dda7", "combined": 0.8414070865725842, "overlap": 0.880945830186634, "semantic": 0.7820989711515098}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5159419229252455, "overlap": 0.2998884144116772, "semantic": 0.840022185695598}, {"chunk_id": "p-edce760829b6", "combined": 0.4711102072912525, "overlap": 0.3755381966036925, "semantic": 0.6144682233225925}, {"chunk_id": "p-9158b9f667b9", "combined": 0.4249420685981221, "overlap": 0.29458876096619974, "semantic": 0.6204720300460057}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3542166879129103, "overlap": 0.0, "semantic": 0.8855417197822757}, {"chunk_id": "p-0d66effb9582", "combined": 0.3016925678834056, "overlap": 0.0, "semantic": 0.7542314197085139}, {"chunk_id": "p-5c1af97004f2", "combined": 0.25172442010555235, "overlap": 0.0, "semantic": 0.6293110502638809}]}
{"symbol_id": "b9c1892ce9136eaa658e328407372430257627ef", "symbol_name": "interleave", "query_text_overlap": "audio_segment_index start_index end_index text_segment_index _type_ _description_ audio_segment_tokens audio_num_codebooks audio_segment_len audio_tokens_flatten len max_segments text_segment_len text_tokens torch audio_max_len len_recorder random eos_frame interleave", "query_text_semantic": "_summary_\n\n    Args:\n        audio_tokens_flatten (_type_): _description_\n        text_tokens (_type_): _description_\n        audio_segment_len (_type_): _description_\n        text_segment_len (_type_): _description_", "best": {"chunk_id": "p-8f7919ad8ffb", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.3788006883045092, "overlap_score": 0.0, "semantic_score": 0.9470017207612729}], "topk_raw": [{"chunk_id": "p-8f7919ad8ffb", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3788006883045092, "overlap": 0.0, "semantic": 0.9470017207612729}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.371031657155868, "overlap": 0.0, "semantic": 0.9275791428896699}, {"chunk_id": "p-0d66effb9582", "combined": 0.34978110894958864, "overlap": 0.0, "semantic": 0.8744527723739716}, {"chunk_id": "p-88308230dda7", "combined": 0.3247751247253514, "overlap": 0.0, "semantic": 0.8119378118133784}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.32398098447772455, "overlap": 0.0, "semantic": 0.8099524611943113}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.31845057300310775, "overlap": 0.0, "semantic": 0.7961264325077693}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2769998250617129, "overlap": 0.0, "semantic": 0.6924995626542823}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2678722306197449, "overlap": 0.0, "semantic": 0.6696805765493622}]}
{"symbol_id": "9d789270a8b09f3b555e6545e5a201b91c4e2ad1", "symbol_name": "get_index", "query_text_overlap": "audio_segment_len start_audio_segment_index start_text_segment_index text_segment_len audio_segment_index end_audio_segment_index end_text_segment_index text_segment_index _type_ _description_ append get_index len range _summary_ index", "query_text_semantic": "_summary_\n\n    Args:\n        audio_segment_len (_type_): _description_\n        text_segment_len (_type_): _description_", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-88308230dda7", "score": 0.37650149085533435, "overlap_score": 0.0, "semantic_score": 0.9412537271383358}, {"chunk_id": "p-ae67c9c86886", "score": 0.3737838799384583, "overlap_score": 0.0, "semantic_score": 0.9344596998461457}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-88308230dda7", "combined": 0.37650149085533435, "overlap": 0.0, "semantic": 0.9412537271383358}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3737838799384583, "overlap": 0.0, "semantic": 0.9344596998461457}, {"chunk_id": "p-5c1af97004f2", "combined": 0.34004847789694026, "overlap": 0.0, "semantic": 0.8501211947423506}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3351567970704944, "overlap": 0.0, "semantic": 0.8378919926762359}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.32673682136591464, "overlap": 0.0, "semantic": 0.8168420534147866}, {"chunk_id": "p-0d66effb9582", "combined": 0.32671495423274916, "overlap": 0.0, "semantic": 0.8167873855818728}, {"chunk_id": "p-9158b9f667b9", "combined": 0.31066325493375235, "overlap": 0.0, "semantic": 0.7766581373343808}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.30069843058612705, "overlap": 0.0, "semantic": 0.7517460764653175}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2995472217132789, "overlap": 0.0, "semantic": 0.7488680542831972}]}
{"symbol_id": "3d294edf98b3d3769926164b6ed067cf03541fae", "symbol_name": "TokenizedDataset", "query_text_overlap": "hf_dataset text idx device dataset_dir audio audio_segment_len flat_audio text_segment_len torch dataset num_rows print tensor dtype long seq_lengths str tokenizeddataset __getitem__", "query_text_semantic": ".arrow-backed dataset for tokenized audio and text samples.\n    Assumes audio is saved as flat vlen int32 arrays (flattened [n_codebooks, seq_len]).", "best": {"chunk_id": "p-88308230dda7", "score": 0.6900467600072674, "overlap_score": 0.5706428427779358, "semantic_score": 0.8691526358512648}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.6354924330763776, "overlap_score": 0.39248738846062936, "semantic_score": 1.0}, {"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.6900467600072674, "overlap": 0.5706428427779358, "semantic": 0.8691526358512648}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.6354924330763776, "overlap": 0.39248738846062936, "semantic": 1.0}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-9158b9f667b9", "combined": 0.5816560367709055, "overlap": 0.4121395877955731, "semantic": 0.835930710233904}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5765062524921187, "overlap": 0.41955398126840854, "semantic": 0.8119346593276839}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.5551863975879459, "overlap": 0.4364194988243062, "semantic": 0.7333367457334056}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.4726560601015789, "overlap": 0.2569775269570139, "semantic": 0.7961738598184264}, {"chunk_id": "p-ae67c9c86886", "combined": 0.36626218112930253, "overlap": 0.0, "semantic": 0.9156554528232563}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.34205967108572477, "overlap": 0.0, "semantic": 0.8551491777143119}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.32167591326709394, "overlap": 0.5361265221118232, "semantic": 0.0}]}
{"symbol_id": "6bee73f5bfe559a8c86ee3c4baccb6ac7dd49911", "symbol_name": "__getitem__", "query_text_overlap": "idx text audio_segment_len flat_audio hf_dataset text_segment_len torch tensor __getitem__ dtype long int device audio print", "query_text_semantic": "def __getitem__(self, idx: int): # print(\"---device:\", self.device, \"---idx:\", idx) flat_audio = self.hf_dataset[idx][\"audio\"] text = self.hf_dataset[idx][\"text\"] audio_segment_len = self.hf_dataset[idx][\"audio_segment_len\"] text_segment_len = self.hf_dataset[idx][\"text_segment_len\"] # to tensor flat_audio = torch.tensor(flat_audio, dtype=torch.long) text = torch.tensor(text, dtype=torch.long) return { \"audio\": flat_audio, \"text\": text, \"audio_segment_len\": audio_segment_len, \"text_segment_len\": text_segment_len, }", "best": {"chunk_id": "p-88308230dda7", "score": 0.6425866956006703, "overlap_score": 0.5706428427779358, "semantic_score": 0.7505024748347718}, "alternatives": [{"chunk_id": "p-ebeeda9fc683", "score": 0.6362777713339353, "overlap_score": 0.41955398126840854, "semantic_score": 0.9613634564322253}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.6060052385024868, "overlap_score": 0.4364194988243062, "semantic_score": 0.8603838480197576}], "topk_raw": [{"chunk_id": "p-88308230dda7", "combined": 0.6425866956006703, "overlap": 0.5706428427779358, "semantic": 0.7505024748347718}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.6362777713339353, "overlap": 0.41955398126840854, "semantic": 0.9613634564322253}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.6060052385024868, "overlap": 0.4364194988243062, "semantic": 0.8603838480197576}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5811543244699036, "overlap": 0.39248738846062936, "semantic": 0.8641547284838149}, {"chunk_id": "p-edce760829b6", "combined": 0.5746242468009624, "overlap": 0.5253905717316115, "semantic": 0.6484747594049887}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.5235835890112502, "overlap": 0.2569775269570139, "semantic": 0.9234926820926047}, {"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3690309786784264, "overlap": 0.0, "semantic": 0.9225774466960659}, {"chunk_id": "p-0d66effb9582", "combined": 0.36094581546010285, "overlap": 0.0, "semantic": 0.9023645386502571}]}
{"symbol_id": "f8ebd22599ac7b9fd15c00e2b6e70cb7254ea8ce", "symbol_name": "get_seq_len", "query_text_overlap": "get_seq_len seq_lengths hf_dataset len", "query_text_semantic": "def get_seq_len(self): seq_lengths = self.hf_dataset[:][\"len\"] return seq_lengths", "best": {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-3c728ae39fa1", "score": 0.37235561391899785, "overlap_score": 0.0, "semantic_score": 0.9308890347974945}, {"chunk_id": "p-021b4cb4f328", "score": 0.3661021857987496, "overlap_score": 0.0, "semantic_score": 0.9152554644968739}], "topk_raw": [{"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.37235561391899785, "overlap": 0.0, "semantic": 0.9308890347974945}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3661021857987496, "overlap": 0.0, "semantic": 0.9152554644968739}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.24769730356992975, "overlap": 0.0, "semantic": 0.6192432589248243}, {"chunk_id": "p-5c1af97004f2", "combined": 0.21195179355347477, "overlap": 0.0, "semantic": 0.5298794838836869}, {"chunk_id": "p-ae67c9c86886", "combined": 0.12217231318330611, "overlap": 0.0, "semantic": 0.30543078295826526}, {"chunk_id": "p-0d66effb9582", "combined": 0.11132342277189265, "overlap": 0.0, "semantic": 0.2783085569297316}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.08491167161487156, "overlap": 0.0, "semantic": 0.21227917903717888}, {"chunk_id": "p-9158b9f667b9", "combined": 0.037922671366973325, "overlap": 0.0, "semantic": 0.0948066784174333}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.017919266426185864, "overlap": 0.0, "semantic": 0.044798166065464655}]}
{"symbol_id": "93e339cfbbcd3f9652c8a8214506d06894125b90", "symbol_name": "__len__", "query_text_overlap": "__len__ hf_dataset num_rows", "query_text_semantic": "def __len__(self): return self.hf_dataset.num_rows", "best": {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.39077484596908996, "overlap_score": 0.0, "semantic_score": 0.9769371149227248}, {"chunk_id": "p-3c728ae39fa1", "score": 0.38928956097140904, "overlap_score": 0.0, "semantic_score": 0.9732239024285225}], "topk_raw": [{"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.39077484596908996, "overlap": 0.0, "semantic": 0.9769371149227248}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.38928956097140904, "overlap": 0.0, "semantic": 0.9732239024285225}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.23613245247391085, "overlap": 0.0, "semantic": 0.5903311311847771}, {"chunk_id": "p-5c1af97004f2", "combined": 0.21299444617116894, "overlap": 0.0, "semantic": 0.5324861154279223}, {"chunk_id": "p-ae67c9c86886", "combined": 0.14961318003363944, "overlap": 0.0, "semantic": 0.3740329500840986}, {"chunk_id": "p-9158b9f667b9", "combined": 0.10017771792418778, "overlap": 0.0, "semantic": 0.2504442948104694}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.08018969781577827, "overlap": 0.0, "semantic": 0.20047424453944565}, {"chunk_id": "p-0d66effb9582", "combined": 0.07207741018634621, "overlap": 0.0, "semantic": 0.1801935254658655}, {"chunk_id": "p-88308230dda7", "combined": 0.054067080704316886, "overlap": 0.0, "semantic": 0.1351677017607922}]}
{"symbol_id": "49eb46d3a852efecbb2e3d1a1f79925edac4c37a", "symbol_name": "__init__", "query_text_overlap": "dataset_dir device hf_dataset str __init__ num_rows print dataset_path load_from_disk _summary_ _description_ _type_ debug dataset_info", "query_text_semantic": "_summary_\n\n        Args:\n            dataset_dir (str): _description_\n            device (_type_): for debug", "best": {"chunk_id": "p-3c728ae39fa1", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.39043218982271877, "overlap_score": 0.0, "semantic_score": 0.9760804745567969}, {"chunk_id": "p-ae67c9c86886", "score": 0.35760125376157653, "overlap_score": 0.0, "semantic_score": 0.8940031344039413}], "topk_raw": [{"chunk_id": "p-3c728ae39fa1", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.39043218982271877, "overlap": 0.0, "semantic": 0.9760804745567969}, {"chunk_id": "p-ae67c9c86886", "combined": 0.35760125376157653, "overlap": 0.0, "semantic": 0.8940031344039413}, {"chunk_id": "p-edce760829b6", "combined": 0.32466485415036195, "overlap": 0.0, "semantic": 0.8116621353759048}, {"chunk_id": "p-0d66effb9582", "combined": 0.31148664376922125, "overlap": 0.0, "semantic": 0.7787166094230531}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3091330202387568, "overlap": 0.0, "semantic": 0.7728325505968919}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.27624826631929295, "overlap": 0.0, "semantic": 0.6906206657982323}, {"chunk_id": "p-9158b9f667b9", "combined": 0.27560280864379644, "overlap": 0.0, "semantic": 0.6890070216094911}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2604863772735614, "overlap": 0.0, "semantic": 0.6512159431839034}, {"chunk_id": "p-88308230dda7", "combined": 0.2602671505518924, "overlap": 0.0, "semantic": 0.650667876379731}]}
{"symbol_id": "169380d70a23c5963b759515ccddb86fcd935b8e", "symbol_name": "create_meta", "query_text_overlap": "path segment_dict data_dir uttr_id uttrid2path f_out out_jsonl segments text tn_text wav_dir f_in full_path meta_path out_dict _type_ print close create_meta dur", "query_text_semantic": "_summary_\n\n    Args:\n        data_dir (_type_): LJspeech root path\n        out_jsonl (_type_): output meta", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.7432410733720088, "overlap_score": 1.0, "semantic_score": 0.3581026834300222}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.5463464266965148, "overlap_score": 0.33754631861655415, "semantic_score": 0.8595465888164557}, {"chunk_id": "p-ebeeda9fc683", "score": 0.5055619572897244, "overlap_score": 0.3608240825100445, "semantic_score": 0.7226687694592443}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.7432410733720088, "overlap": 1.0, "semantic": 0.3581026834300222}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.5463464266965148, "overlap": 0.33754631861655415, "semantic": 0.8595465888164557}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.5055619572897244, "overlap": 0.3608240825100445, "semantic": 0.7226687694592443}, {"chunk_id": "p-021b4cb4f328", "combined": 0.4484544464007197, "overlap": 0.7474240773345329, "semantic": 0.0}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.4411293723995898, "overlap": 0.46107859557300274, "semantic": 0.4112055376394704}, {"chunk_id": "p-88308230dda7", "combined": 0.44095258624472866, "overlap": 0.4907632614134275, "semantic": 0.36623657349168054}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4184547813224066, "overlap": 0.37532873547452356, "semantic": 0.48314385009423116}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.36715431439874746, "overlap": 0.0, "semantic": 0.9178857859968685}, {"chunk_id": "p-0d66effb9582", "combined": 0.32311331271628646, "overlap": 0.0, "semantic": 0.8077832817907161}]}
{"symbol_id": "fd3bb6096e501193283c236b1300065d265abb2b", "symbol_name": "get_uttrid2path", "query_text_overlap": "wav_dir uttrid2path wav_file full_path get_uttrid2path uttr_id wav_files join listdir path sep split _summary_ _type_ _description_", "query_text_semantic": "_summary_\n\n    Args:\n        wav_dir (_type_): _description_", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.397102392618939, "overlap_score": 0.0, "semantic_score": 0.9927559815473473}, {"chunk_id": "p-ae67c9c86886", "score": 0.3892083020600864, "overlap_score": 0.0, "semantic_score": 0.9730207551502159}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.397102392618939, "overlap": 0.0, "semantic": 0.9927559815473473}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3892083020600864, "overlap": 0.0, "semantic": 0.9730207551502159}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.35039416543313184, "overlap": 0.0, "semantic": 0.8759854135828296}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3191736057728523, "overlap": 0.0, "semantic": 0.7979340144321307}, {"chunk_id": "p-88308230dda7", "combined": 0.30241714139984954, "overlap": 0.0, "semantic": 0.7560428534996239}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.27159309777128765, "overlap": 0.0, "semantic": 0.6789827444282192}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2652166770885613, "overlap": 0.0, "semantic": 0.6630416927214032}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.26462156724118685, "overlap": 0.0, "semantic": 0.6615539181029672}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.26249216088985133, "overlap": 0.0, "semantic": 0.6562304022246283}]}
{"symbol_id": "1e4d335318cc2107a9588ac22bda99063e1e0a40", "symbol_name": "extract_tokens", "query_text_overlap": "jsonl audio_path device path pretrained_dir torch_codec f_out segment token torch audio16k codec_ckpt_path codec_config_path data_dict duration _type_ _description_ audio16k_length data_list desire_len", "query_text_semantic": "_summary_\n\n    Args:\n        jsonl (_type_): _description_\n        pretrained_dir (_type_): _description_", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-ae67c9c86886", "score": 0.39519818135534257, "overlap_score": 0.0, "semantic_score": 0.9879954533883564}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.39519818135534257, "overlap": 0.0, "semantic": 0.9879954533883564}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.35146616186270085, "overlap": 0.0, "semantic": 0.878665404656752}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.3324376637475861, "overlap": 0.0, "semantic": 0.8310941593689652}, {"chunk_id": "p-0d66effb9582", "combined": 0.33036778379615517, "overlap": 0.0, "semantic": 0.8259194594903878}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.3156780777533642, "overlap": 0.0, "semantic": 0.7891951943834105}, {"chunk_id": "p-edce760829b6", "combined": 0.311866753200234, "overlap": 0.0, "semantic": 0.779666883000585}, {"chunk_id": "p-88308230dda7", "combined": 0.31100288209404287, "overlap": 0.0, "semantic": 0.7775072052351071}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.3071314854718059, "overlap": 0.0, "semantic": 0.7678287136795148}]}
{"symbol_id": "42a74278efb83ef9d9d069efcdbfdecf9dba6e3b", "symbol_name": "_load_one_audio", "query_text_overlap": "_load_one_audio audio audio16k audio_path audio_sr torchaudio functional load resample str 16000", "query_text_semantic": "def _load_one_audio(audio_path: str): audio, audio_sr = torchaudio.load(audio_path) audio16k = torchaudio.functional.resample(audio, audio_sr, 16000) return audio16k", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-0d66effb9582", "score": 0.3798555283474304, "overlap_score": 0.0, "semantic_score": 0.949638820868576}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.3362675686089026, "overlap_score": 0.0, "semantic_score": 0.8406689215222565}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-0d66effb9582", "combined": 0.3798555283474304, "overlap": 0.0, "semantic": 0.949638820868576}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.3362675686089026, "overlap": 0.0, "semantic": 0.8406689215222565}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.33354971359040037, "overlap": 0.0, "semantic": 0.8338742839760008}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.32158278601285945, "overlap": 0.0, "semantic": 0.8039569650321485}, {"chunk_id": "p-021b4cb4f328", "combined": 0.3031538812836769, "overlap": 0.0, "semantic": 0.7578847032091921}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.29924590251713745, "overlap": 0.0, "semantic": 0.7481147562928436}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.26505329511693265, "overlap": 0.0, "semantic": 0.6626332377923316}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.2501598989311488, "overlap": 0.0, "semantic": 0.625399747327872}, {"chunk_id": "p-88308230dda7", "combined": 0.24988743829185572, "overlap": 0.0, "semantic": 0.6247185957296393}]}
{"symbol_id": "13c12eeb8a238ba71aa32bd73a50bbe386413667", "symbol_name": "split_list_into_chunks", "query_text_overlap": "chunk_size lst split_list_into_chunks len range", "query_text_semantic": "def split_list_into_chunks(lst, chunk_size): return [lst[i : i + chunk_size] for i in range(0, len(lst), chunk_size)]", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.3505493209072796, "overlap_score": 0.0, "semantic_score": 0.8763733022681989}, {"chunk_id": "p-62dccf79cb8d", "score": 0.3081710968003695, "overlap_score": 0.0, "semantic_score": 0.7704277420009238}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3505493209072796, "overlap": 0.0, "semantic": 0.8763733022681989}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3081710968003695, "overlap": 0.0, "semantic": 0.7704277420009238}, {"chunk_id": "p-88308230dda7", "combined": 0.2999850899543731, "overlap": 0.0, "semantic": 0.7499627248859327}, {"chunk_id": "p-5c1af97004f2", "combined": 0.28629856049495256, "overlap": 0.0, "semantic": 0.7157464012373814}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.26304740001454, "overlap": 0.0, "semantic": 0.65761850003635}, {"chunk_id": "p-021b4cb4f328", "combined": 0.23755855729963185, "overlap": 0.0, "semantic": 0.5938963932490796}, {"chunk_id": "p-0d66effb9582", "combined": 0.19159404277289413, "overlap": 0.0, "semantic": 0.4789851069322353}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.1881732429762802, "overlap": 0.0, "semantic": 0.47043310744070044}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.17635162284419242, "overlap": 0.0, "semantic": 0.44087905711048103}]}
{"symbol_id": "a17cd394768d4a5eabddbbdb5d28b3a82d5447b2", "symbol_name": "read_jsonl", "query_text_overlap": "path data_list data json_str line read_jsonl append expanduser json loads open read splitlines", "query_text_semantic": "def read_jsonl(path): path = os.path.expanduser(path) with open(path, \"r\") as f: json_str = f.read() data_list = [] for line in json_str.splitlines(): data = json.loads(line) data_list.append(data) return data_list", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8581024928722278, "overlap_score": 1.0, "semantic_score": 0.6452562321805695}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.47300514274069055, "overlap_score": 0.7191476864843699, "semantic_score": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8581024928722278, "overlap": 1.0, "semantic": 0.6452562321805695}, {"chunk_id": "p-021b4cb4f328", "combined": 0.47300514274069055, "overlap": 0.7191476864843699, "semantic": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.27378057714036874, "overlap": 0.0, "semantic": 0.6844514428509219}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25385857994541333, "overlap": 0.0, "semantic": 0.6346464498635334}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.13749994055422562, "overlap": 0.0, "semantic": 0.3437498513855641}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11499095877030124, "overlap": 0.0, "semantic": 0.2874773969257531}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.0927525124669479, "overlap": 0.0, "semantic": 0.23188128116736975}, {"chunk_id": "p-88308230dda7", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}, {"chunk_id": "p-9158b9f667b9", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}]}
{"symbol_id": "d3354e00f74c921adfe89b473f1e3df16e396314", "symbol_name": "read_test", "query_text_overlap": "idx audio_segment_len dataset_dir print text_segment_len torch all_len audio_tokens_flatten num_rows text_tokens dtype long read_test tensor dataset_path hf_dataset load_from_disk range recovery_debug total_len", "query_text_semantic": "_summary_\n\n    Args:\n        dataset_dir (_type_): _description_", "best": {"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, "alternatives": [{"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, {"chunk_id": "p-62dccf79cb8d", "score": 0.3937644300692427, "overlap_score": 0.0, "semantic_score": 0.9844110751731068}], "topk_raw": [{"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.3937644300692427, "overlap": 0.0, "semantic": 0.9844110751731068}, {"chunk_id": "p-88308230dda7", "combined": 0.330471359560963, "overlap": 0.0, "semantic": 0.8261783989024075}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3299672112833074, "overlap": 0.0, "semantic": 0.8249180282082684}, {"chunk_id": "p-edce760829b6", "combined": 0.3277494466455366, "overlap": 0.0, "semantic": 0.8193736166138414}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.3237518607825372, "overlap": 0.0, "semantic": 0.809379651956343}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.31842392296869226, "overlap": 0.0, "semantic": 0.7960598074217305}, {"chunk_id": "p-5c1af97004f2", "combined": 0.29262467771595574, "overlap": 0.0, "semantic": 0.7315616942898894}, {"chunk_id": "p-0d66effb9582", "combined": 0.2720679490859805, "overlap": 0.0, "semantic": 0.6801698727149512}]}
{"symbol_id": "fe8a0baddb5139e98a1e5e45d702a300c71a7c17", "symbol_name": "recovery_debug", "query_text_overlap": "audio_segment_index _type_ _description_ text_segment_index audio_segment_len print audio_segment_tokens audio_tokens_flatten start_audio_segment_index start_text_segment_index text_segment_len text_segment_tokens text_tokens end_audio_segment_index end_text_segment_index append len range recovery_debug shape", "query_text_semantic": "_summary_\n\n    Args:\n        audio_tokens_flatten (_type_): _description_\n        text_tokens (_type_): _description_\n        audio_segment_len (_type_): _description_\n        text_segment_len (_type_): _description_", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-ae67c9c86886", "score": 0.3788006883045092, "overlap_score": 0.0, "semantic_score": 0.9470017207612729}, {"chunk_id": "p-72ce3a56a2ca", "score": 0.371031657155868, "overlap_score": 0.0, "semantic_score": 0.9275791428896699}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-ae67c9c86886", "combined": 0.3788006883045092, "overlap": 0.0, "semantic": 0.9470017207612729}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.371031657155868, "overlap": 0.0, "semantic": 0.9275791428896699}, {"chunk_id": "p-0d66effb9582", "combined": 0.34978110894958864, "overlap": 0.0, "semantic": 0.8744527723739716}, {"chunk_id": "p-88308230dda7", "combined": 0.3247751247253514, "overlap": 0.0, "semantic": 0.8119378118133784}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.32398098447772455, "overlap": 0.0, "semantic": 0.8099524611943113}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.31845057300310775, "overlap": 0.0, "semantic": 0.7961264325077693}, {"chunk_id": "p-5c1af97004f2", "combined": 0.2769998250617129, "overlap": 0.0, "semantic": 0.6924995626542823}, {"chunk_id": "p-9158b9f667b9", "combined": 0.2678722306197449, "overlap": 0.0, "semantic": 0.6696805765493622}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.2663350326177121, "overlap": 0.0, "semantic": 0.6658375815442802}]}
{"symbol_id": "390fc1b77192789c78eb52f328bf84b94d1ba38d", "symbol_name": "pack", "query_text_overlap": "text len _type_ _description_ audio_tokens text_tokens path print seg segments value dataset_dir feature jsonl pack prefix pretrained_dir sequence int64 skipping", "query_text_semantic": "pack .arrow\n\n    Args:\n        jsonl (_type_): _description_\n        pretrained_dir (_type_): _description_\n        dataset_dir (_type_): _description_\n        prefix (_type_): _description_", "best": {"chunk_id": "p-62dccf79cb8d", "score": 0.9151185301646143, "overlap_score": 0.8585308836076906, "semantic_score": 1.0}, "alternatives": [{"chunk_id": "p-72ce3a56a2ca", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-7b0c753f4b1a", "score": 0.4483180446573374, "overlap_score": 0.2109780029127022, "semantic_score": 0.80432810727429}], "topk_raw": [{"chunk_id": "p-62dccf79cb8d", "combined": 0.9151185301646143, "overlap": 0.8585308836076906, "semantic": 1.0}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.4483180446573374, "overlap": 0.2109780029127022, "semantic": 0.80432810727429}, {"chunk_id": "p-9158b9f667b9", "combined": 0.44414546188330883, "overlap": 0.19924038084599788, "semantic": 0.8115030834392752}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.44151258211824157, "overlap": 0.20282471640369382, "semantic": 0.7995443806900632}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.43970804520565665, "overlap": 0.25917930626014796, "semantic": 0.7105011536239195}, {"chunk_id": "p-edce760829b6", "combined": 0.43412761778185505, "overlap": 0.2539892325427983, "semantic": 0.70433519564044}, {"chunk_id": "p-88308230dda7", "combined": 0.4226278628804714, "overlap": 0.27586550937813126, "semantic": 0.6427713931339815}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.3316161996476683, "overlap": 0.0, "semantic": 0.8290404991191708}, {"chunk_id": "p-3c728ae39fa1", "combined": 0.32853282174354786, "overlap": 0.0, "semantic": 0.8213320543588696}]}
{"symbol_id": "49826eaedc5d2ae5a1b32dd8431a1712591514e6", "symbol_name": "get_speaker_dict", "query_text_overlap": "speaker speaker_dict num get_speaker_dict seg segments str _summary_ segment _type_ _description_ not", "query_text_semantic": "_summary_\n\n    Args:\n        segment (_type_): _description_", "best": {"chunk_id": "p-72ce3a56a2ca", "score": 0.7340454618671207, "overlap_score": 0.8694857753242448, "semantic_score": 0.5308849916814349}, "alternatives": [{"chunk_id": "p-0212d69b9ec4", "score": 0.6, "overlap_score": 1.0, "semantic_score": 0.0}, {"chunk_id": "p-021b4cb4f328", "score": 0.46596516153229905, "overlap_score": 0.7766086025538318, "semantic_score": 0.0}], "topk_raw": [{"chunk_id": "p-72ce3a56a2ca", "combined": 0.7340454618671207, "overlap": 0.8694857753242448, "semantic": 0.5308849916814349}, {"chunk_id": "p-0212d69b9ec4", "combined": 0.6, "overlap": 1.0, "semantic": 0.0}, {"chunk_id": "p-021b4cb4f328", "combined": 0.46596516153229905, "overlap": 0.7766086025538318, "semantic": 0.0}, {"chunk_id": "p-88308230dda7", "combined": 0.41625379685617714, "overlap": 0.07889292111520135, "semantic": 0.9222951104676408}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-5c1af97004f2", "combined": 0.3143897884722963, "overlap": 0.07651444614785405, "semantic": 0.6712028019589596}, {"chunk_id": "p-ae67c9c86886", "combined": 0.2867821430658309, "overlap": 0.0, "semantic": 0.7169553576645772}, {"chunk_id": "p-0d66effb9582", "combined": 0.28479014572137484, "overlap": 0.10928065477414986, "semantic": 0.5480543821422124}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.270333924290682, "overlap": 0.10202220767987516, "semantic": 0.5228014992068921}, {"chunk_id": "p-9158b9f667b9", "combined": 0.22610488460447054, "overlap": 0.0, "semantic": 0.5652622115111763}]}
{"symbol_id": "f8af3832d1a504bb01fb6ad947701544828cccc9", "symbol_name": "read_jsonl", "query_text_overlap": "path data_list data json_str line read_jsonl append expanduser json loads open read splitlines", "query_text_semantic": "def read_jsonl(path): path = os.path.expanduser(path) with open(path, \"r\") as f: json_str = f.read() data_list = [] for line in json_str.splitlines(): data = json.loads(line) data_list.append(data) return data_list", "best": {"chunk_id": "p-ae67c9c86886", "score": 0.8581024928722278, "overlap_score": 1.0, "semantic_score": 0.6452562321805695}, "alternatives": [{"chunk_id": "p-021b4cb4f328", "score": 0.47300514274069055, "overlap_score": 0.7191476864843699, "semantic_score": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "score": 0.4, "overlap_score": 0.0, "semantic_score": 1.0}], "topk_raw": [{"chunk_id": "p-ae67c9c86886", "combined": 0.8581024928722278, "overlap": 1.0, "semantic": 0.6452562321805695}, {"chunk_id": "p-021b4cb4f328", "combined": 0.47300514274069055, "overlap": 0.7191476864843699, "semantic": 0.10379132712517151}, {"chunk_id": "p-d6e2f5a6744b", "combined": 0.4, "overlap": 0.0, "semantic": 1.0}, {"chunk_id": "p-62dccf79cb8d", "combined": 0.27378057714036874, "overlap": 0.0, "semantic": 0.6844514428509219}, {"chunk_id": "p-72ce3a56a2ca", "combined": 0.25385857994541333, "overlap": 0.0, "semantic": 0.6346464498635334}, {"chunk_id": "p-ebeeda9fc683", "combined": 0.13749994055422562, "overlap": 0.0, "semantic": 0.3437498513855641}, {"chunk_id": "p-7b0c753f4b1a", "combined": 0.11499095877030124, "overlap": 0.0, "semantic": 0.2874773969257531}, {"chunk_id": "p-8f7919ad8ffb", "combined": 0.0927525124669479, "overlap": 0.0, "semantic": 0.23188128116736975}, {"chunk_id": "p-88308230dda7", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}, {"chunk_id": "p-9158b9f667b9", "combined": 0.04151653085006861, "overlap": 0.0, "semantic": 0.10379132712517151}]}
